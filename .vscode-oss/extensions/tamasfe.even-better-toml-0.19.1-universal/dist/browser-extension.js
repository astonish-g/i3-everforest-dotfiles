"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var es=require("vscode");function Pa(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function ka(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if(n!=="default"){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,Object.freeze(t)}var ge=ka(es),ie=Pa(es);let Zi;function gn(){return Zi||(Zi=ge.window.createOutputChannel("Even Better TOML")),Zi}async function Fa(e,t){let n;switch(e.kind){case"info":n=await ge.window.showInformationMessage(e.message,"Show Details");case"warn":n=await ge.window.showWarningMessage(e.message,"Show Details");case"error":n=await ge.window.showErrorMessage(e.message,"Show Details")}n&&t.outputChannel.show()}function Ea(e,t){e.subscriptions.push(ge.commands.registerTextEditorCommand("evenBetterToml.copyAsJson",async n=>{var i,r;const o=n?.document;if(!o||n.selection.isEmpty)return;const s=o.getText(n.selection);if(s.trim().length===0)return;const a=await t.sendRequest("taplo/convertToJson",{text:s}),c=gn();if((r=(i=a.error)==null?void 0:i.length)!=null&&r){c.appendLine(`Failed to convert TOML to JSON: ${a.error}`),await ge.window.showErrorMessage("Copying has failed!","Show Details")&&c.show();return}try{if(!a.text){c.appendLine("The response shouldn't be empty, but it is."),await ge.window.showErrorMessage("Copying has failed!","Show Details")&&c.show();return}await ge.env.clipboard.writeText(a.text)}catch(d){c.appendLine(`Couldn't write to clipboard: ${d}`),await ge.window.showErrorMessage("Copying has failed!","Show Details")&&c.show();return}await ge.window.showInformationMessage("JSON copied!")}),ge.commands.registerTextEditorCommand("evenBetterToml.copyAsToml",async n=>{var i,r;const o=n?.document;if(!o||n.selection.isEmpty)return;const s=o.getText(n.selection);if(s.trim().length===0)return;const a=await t.sendRequest("taplo/convertToToml",{text:s}),c=gn();if((r=(i=a.error)==null?void 0:i.length)!=null&&r){c.appendLine(`Failed to convert JSON to TOML: ${a.error}`),await ge.window.showErrorMessage("Copying has failed!","Show Details")&&c.show();return}try{if(!a.text){c.appendLine("The response shouldn't be empty, but it is."),await ge.window.showErrorMessage("Copying has failed!","Show Details")&&c.show();return}await ge.env.clipboard.writeText(a.text)}catch(d){c.appendLine(`Couldn't write to clipboard: ${d}`),await ge.window.showErrorMessage("Copying has failed!","Show Details")&&c.show();return}await ge.window.showInformationMessage("TOML copied!")}),ge.commands.registerTextEditorCommand("evenBetterToml.pasteAsJson",async n=>{var i,r;const o=gn();let s;try{s=await ge.env.clipboard.readText()}catch(c){o.appendLine(`Failed to read from clipboard:${c}`),await ge.window.showErrorMessage("Paste from clipboard has failed!","Show Details")&&o.show();return}const a=await t.sendRequest("taplo/convertToJson",{text:s});if((r=(i=a.error)==null?void 0:i.length)!=null&&r){o.appendLine(`Failed to convert to JSON: ${a.error}`),await ge.window.showErrorMessage("Pasting JSON has failed!","Show Details")&&o.show();return}n.edit(c=>{c.replace(n.selection,a.text)})}),ge.commands.registerTextEditorCommand("evenBetterToml.pasteAsToml",async n=>{var i,r;const o=gn();let s;try{s=await ge.env.clipboard.readText()}catch(c){o.appendLine(`Failed to read from clipboard:${c}`),await ge.window.showErrorMessage("Paste from clipboard has failed!","Show Details")&&o.show();return}const a=await t.sendRequest("taplo/convertToToml",{text:s});if((r=(i=a.error)==null?void 0:i.length)!=null&&r){o.appendLine(`Failed to convert to TOML: ${a.error}`),await ge.window.showErrorMessage("Paste from clipboard has failed!","Show Details")&&o.show();return}n.edit(c=>{c.replace(n.selection,a.text)})}))}function Oa(e,t){e.subscriptions.push(ge.commands.registerTextEditorCommand("evenBetterToml.selectSchema",async n=>{if(!n)return;const i=await t.sendRequest("taplo/listSchemas",{documentUri:n.document.uri.toString()}),r=await t.sendRequest("taplo/associatedSchema",{documentUri:n.document.uri.toString()}),o=await ge.window.showQuickPick(i.schemas.map(s=>{var a,c,d;return{label:(c=(a=s.meta)==null?void 0:a.name)!=null?c:s.url,description:qa(s.meta),detail:Ma(s.url),picked:((d=r.schema)==null?void 0:d.url)===s.url,url:s.url,meta:s.meta}}));!o||t.sendNotification("taplo/associateSchema",{documentUri:n.document.uri.toString(),schemaUri:o.url,rule:{url:n.document.uri.toString()},meta:o.meta})}))}function qa(e){if(typeof e?.description=="string")return e.description}function Ma(e,t){return`${e}`}function Ia(e,t){Ea(e,t),Oa(e,t)}var Ie=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Na(e){var t=e.default;if(typeof t=="function"){var n=function(){return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var r=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return e[i]}})}),n}var ve={};Object.defineProperty(ve,"__esModule",{value:!0}),ve.asPromise=ve.thenable=ve.typedArray=ve.stringArray=ve.array=ve.func=ve.error=ve.number=ve.string=ve.boolean=void 0;function La(e){return e===!0||e===!1}ve.boolean=La;function ts(e){return typeof e=="string"||e instanceof String}ve.string=ts;function ja(e){return typeof e=="number"||e instanceof Number}ve.number=ja;function Aa(e){return e instanceof Error}ve.error=Aa;function ns(e){return typeof e=="function"}ve.func=ns;function is(e){return Array.isArray(e)}ve.array=is;function Ha(e){return is(e)&&e.every(t=>ts(t))}ve.stringArray=Ha;function $a(e,t){return Array.isArray(e)&&e.every(t)}ve.typedArray=$a;function rs(e){return e&&ns(e.then)}ve.thenable=rs;function Wa(e){return e instanceof Promise?e:rs(e)?new Promise((t,n)=>{e.then(i=>t(i),i=>n(i))}):Promise.resolve(e)}ve.asPromise=Wa;var os={},oe={},er={exports:{}},qt={},tr={},Kn={},nr={},Ne={};Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.stringArray=Ne.array=Ne.func=Ne.error=Ne.number=Ne.string=Ne.boolean=void 0;function Ka(e){return e===!0||e===!1}Ne.boolean=Ka;function ss(e){return typeof e=="string"||e instanceof String}Ne.string=ss;function Ua(e){return typeof e=="number"||e instanceof Number}Ne.number=Ua;function za(e){return e instanceof Error}Ne.error=za;function xa(e){return typeof e=="function"}Ne.func=xa;function as(e){return Array.isArray(e)}Ne.array=as;function Ba(e){return as(e)&&e.every(t=>ss(t))}Ne.stringArray=Ba,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Message=e.NotificationType9=e.NotificationType8=e.NotificationType7=e.NotificationType6=e.NotificationType5=e.NotificationType4=e.NotificationType3=e.NotificationType2=e.NotificationType1=e.NotificationType0=e.NotificationType=e.RequestType9=e.RequestType8=e.RequestType7=e.RequestType6=e.RequestType5=e.RequestType4=e.RequestType3=e.RequestType2=e.RequestType1=e.RequestType=e.RequestType0=e.AbstractMessageSignature=e.ParameterStructures=e.ResponseError=e.ErrorCodes=void 0;const t=Ne;var n;(function(l){l.ParseError=-32700,l.InvalidRequest=-32600,l.MethodNotFound=-32601,l.InvalidParams=-32602,l.InternalError=-32603,l.jsonrpcReservedErrorRangeStart=-32099,l.serverErrorStart=-32099,l.MessageWriteError=-32099,l.MessageReadError=-32098,l.PendingResponseRejected=-32097,l.ConnectionInactive=-32096,l.ServerNotInitialized=-32002,l.UnknownErrorCode=-32001,l.jsonrpcReservedErrorRangeEnd=-32e3,l.serverErrorEnd=-32e3})(n=e.ErrorCodes||(e.ErrorCodes={}));class i extends Error{constructor(T,j,K){super(j),this.code=t.number(T)?T:n.UnknownErrorCode,this.data=K,Object.setPrototypeOf(this,i.prototype)}toJson(){const T={code:this.code,message:this.message};return this.data!==void 0&&(T.data=this.data),T}}e.ResponseError=i;class r{constructor(T){this.kind=T}static is(T){return T===r.auto||T===r.byName||T===r.byPosition}toString(){return this.kind}}e.ParameterStructures=r,r.auto=new r("auto"),r.byPosition=new r("byPosition"),r.byName=new r("byName");class o{constructor(T,j){this.method=T,this.numberOfParams=j}get parameterStructures(){return r.auto}}e.AbstractMessageSignature=o;class s extends o{constructor(T){super(T,0)}}e.RequestType0=s;class a extends o{constructor(T,j=r.auto){super(T,1),this._parameterStructures=j}get parameterStructures(){return this._parameterStructures}}e.RequestType=a;class c extends o{constructor(T,j=r.auto){super(T,1),this._parameterStructures=j}get parameterStructures(){return this._parameterStructures}}e.RequestType1=c;class d extends o{constructor(T){super(T,2)}}e.RequestType2=d;class p extends o{constructor(T){super(T,3)}}e.RequestType3=p;class m extends o{constructor(T){super(T,4)}}e.RequestType4=m;class f extends o{constructor(T){super(T,5)}}e.RequestType5=f;class h extends o{constructor(T){super(T,6)}}e.RequestType6=h;class y extends o{constructor(T){super(T,7)}}e.RequestType7=y;class E extends o{constructor(T){super(T,8)}}e.RequestType8=E;class I extends o{constructor(T){super(T,9)}}e.RequestType9=I;class J extends o{constructor(T,j=r.auto){super(T,1),this._parameterStructures=j}get parameterStructures(){return this._parameterStructures}}e.NotificationType=J;class B extends o{constructor(T){super(T,0)}}e.NotificationType0=B;class w extends o{constructor(T,j=r.auto){super(T,1),this._parameterStructures=j}get parameterStructures(){return this._parameterStructures}}e.NotificationType1=w;class k extends o{constructor(T){super(T,2)}}e.NotificationType2=k;class L extends o{constructor(T){super(T,3)}}e.NotificationType3=L;class z extends o{constructor(T){super(T,4)}}e.NotificationType4=z;class A extends o{constructor(T){super(T,5)}}e.NotificationType5=A;class U extends o{constructor(T){super(T,6)}}e.NotificationType6=U;class W extends o{constructor(T){super(T,7)}}e.NotificationType7=W;class ee extends o{constructor(T){super(T,8)}}e.NotificationType8=ee;class R extends o{constructor(T){super(T,9)}}e.NotificationType9=R,function(l){function T(H){const X=H;return X&&t.string(X.method)&&(t.string(X.id)||t.number(X.id))}l.isRequest=T;function j(H){const X=H;return X&&t.string(X.method)&&H.id===void 0}l.isNotification=j;function K(H){const X=H;return X&&(X.result!==void 0||!!X.error)&&(t.string(X.id)||t.number(X.id)||X.id===null)}l.isResponse=K}(e.Message||(e.Message={}))}(nr);var ir={};(function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.LRUCache=e.LinkedMap=e.Touch=void 0;var n;(function(o){o.None=0,o.First=1,o.AsOld=o.First,o.Last=2,o.AsNew=o.Last})(n=e.Touch||(e.Touch={}));class i{constructor(){this[t]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(s){return this._map.has(s)}get(s,a=n.None){const c=this._map.get(s);if(!!c)return a!==n.None&&this.touch(c,a),c.value}set(s,a,c=n.None){let d=this._map.get(s);if(d)d.value=a,c!==n.None&&this.touch(d,c);else{switch(d={key:s,value:a,next:void 0,previous:void 0},c){case n.None:this.addItemLast(d);break;case n.First:this.addItemFirst(d);break;case n.Last:this.addItemLast(d);break;default:this.addItemLast(d);break}this._map.set(s,d),this._size++}return this}delete(s){return!!this.remove(s)}remove(s){const a=this._map.get(s);if(!!a)return this._map.delete(s),this.removeItem(a),this._size--,a.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const s=this._head;return this._map.delete(s.key),this.removeItem(s),this._size--,s.value}forEach(s,a){const c=this._state;let d=this._head;for(;d;){if(a?s.bind(a)(d.value,d.key,this):s(d.value,d.key,this),this._state!==c)throw new Error("LinkedMap got modified during iteration.");d=d.next}}keys(){const s=this._state;let a=this._head;const c={[Symbol.iterator]:()=>c,next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(a){const d={value:a.key,done:!1};return a=a.next,d}else return{value:void 0,done:!0}}};return c}values(){const s=this._state;let a=this._head;const c={[Symbol.iterator]:()=>c,next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(a){const d={value:a.value,done:!1};return a=a.next,d}else return{value:void 0,done:!0}}};return c}entries(){const s=this._state;let a=this._head;const c={[Symbol.iterator]:()=>c,next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(a){const d={value:[a.key,a.value],done:!1};return a=a.next,d}else return{value:void 0,done:!0}}};return c}[(t=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(s){if(s>=this.size)return;if(s===0){this.clear();return}let a=this._head,c=this.size;for(;a&&c>s;)this._map.delete(a.key),a=a.next,c--;this._head=a,this._size=c,a&&(a.previous=void 0),this._state++}addItemFirst(s){if(!this._head&&!this._tail)this._tail=s;else if(this._head)s.next=this._head,this._head.previous=s;else throw new Error("Invalid list");this._head=s,this._state++}addItemLast(s){if(!this._head&&!this._tail)this._head=s;else if(this._tail)s.previous=this._tail,this._tail.next=s;else throw new Error("Invalid list");this._tail=s,this._state++}removeItem(s){if(s===this._head&&s===this._tail)this._head=void 0,this._tail=void 0;else if(s===this._head){if(!s.next)throw new Error("Invalid list");s.next.previous=void 0,this._head=s.next}else if(s===this._tail){if(!s.previous)throw new Error("Invalid list");s.previous.next=void 0,this._tail=s.previous}else{const a=s.next,c=s.previous;if(!a||!c)throw new Error("Invalid list");a.previous=c,c.next=a}s.next=void 0,s.previous=void 0,this._state++}touch(s,a){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(a!==n.First&&a!==n.Last)){if(a===n.First){if(s===this._head)return;const c=s.next,d=s.previous;s===this._tail?(d.next=void 0,this._tail=d):(c.previous=d,d.next=c),s.previous=void 0,s.next=this._head,this._head.previous=s,this._head=s,this._state++}else if(a===n.Last){if(s===this._tail)return;const c=s.next,d=s.previous;s===this._head?(c.previous=void 0,this._head=c):(c.previous=d,d.next=c),s.next=void 0,s.previous=this._tail,this._tail.next=s,this._tail=s,this._state++}}}toJSON(){const s=[];return this.forEach((a,c)=>{s.push([c,a])}),s}fromJSON(s){this.clear();for(const[a,c]of s)this.set(a,c)}}e.LinkedMap=i;class r extends i{constructor(s,a=1){super(),this._limit=s,this._ratio=Math.min(Math.max(0,a),1)}get limit(){return this._limit}set limit(s){this._limit=s,this.checkTrim()}get ratio(){return this._ratio}set ratio(s){this._ratio=Math.min(Math.max(0,s),1),this.checkTrim()}get(s,a=n.AsNew){return super.get(s,a)}peek(s){return super.get(s,n.None)}set(s,a){return super.set(s,a,n.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}e.LRUCache=r})(ir);var cs={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Disposable=void 0,function(t){function n(i){return{dispose:i}}t.create=n}(e.Disposable||(e.Disposable={}))})(cs);var Jt={},vt={};Object.defineProperty(vt,"__esModule",{value:!0});let rr;function or(){if(rr===void 0)throw new Error("No runtime abstraction layer installed");return rr}(function(e){function t(n){if(n===void 0)throw new Error("No runtime abstraction layer provided");rr=n}e.install=t})(or||(or={})),vt.default=or,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Emitter=e.Event=void 0;const t=vt;(function(r){const o={dispose(){}};r.None=function(){return o}})(e.Event||(e.Event={}));class n{add(o,s=null,a){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(o),this._contexts.push(s),Array.isArray(a)&&a.push({dispose:()=>this.remove(o,s)})}remove(o,s=null){if(!this._callbacks)return;let a=!1;for(let c=0,d=this._callbacks.length;c<d;c++)if(this._callbacks[c]===o)if(this._contexts[c]===s){this._callbacks.splice(c,1),this._contexts.splice(c,1);return}else a=!0;if(a)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...o){if(!this._callbacks)return[];const s=[],a=this._callbacks.slice(0),c=this._contexts.slice(0);for(let d=0,p=a.length;d<p;d++)try{s.push(a[d].apply(c[d],o))}catch(m){(0,t.default)().console.error(m)}return s}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}}class i{constructor(o){this._options=o}get event(){return this._event||(this._event=(o,s,a)=>{this._callbacks||(this._callbacks=new n),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(o,s);const c={dispose:()=>{!this._callbacks||(this._callbacks.remove(o,s),c.dispose=i._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(a)&&a.push(c),c}),this._event}fire(o){this._callbacks&&this._callbacks.invoke.call(this._callbacks,o)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}e.Emitter=i,i._noop=function(){}}(Jt);var Un={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CancellationTokenSource=e.CancellationToken=void 0;const t=vt,n=Ne,i=Jt;var r;(function(c){c.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:i.Event.None}),c.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:i.Event.None});function d(p){const m=p;return m&&(m===c.None||m===c.Cancelled||n.boolean(m.isCancellationRequested)&&!!m.onCancellationRequested)}c.is=d})(r=e.CancellationToken||(e.CancellationToken={}));const o=Object.freeze(function(c,d){const p=(0,t.default)().timer.setTimeout(c.bind(d),0);return{dispose(){p.dispose()}}});class s{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?o:(this._emitter||(this._emitter=new i.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}class a{get token(){return this._token||(this._token=new s),this._token}cancel(){this._token?this._token.cancel():this._token=r.Cancelled}dispose(){this._token?this._token instanceof s&&this._token.dispose():this._token=r.None}}e.CancellationTokenSource=a})(Un);var Qt={};Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.SharedArrayReceiverStrategy=Qt.SharedArraySenderStrategy=void 0;const Va=Un;var hn;(function(e){e.Continue=0,e.Cancelled=1})(hn||(hn={}));class Ja{constructor(){this.buffers=new Map}enableCancellation(t){if(t.id===null)return;const n=new SharedArrayBuffer(4),i=new Int32Array(n,0,1);i[0]=hn.Continue,this.buffers.set(t.id,n),t.$cancellationData=n}async sendCancellation(t,n){const i=this.buffers.get(n);if(i===void 0)return;const r=new Int32Array(i,0,1);Atomics.store(r,0,hn.Cancelled)}cleanup(t){this.buffers.delete(t)}dispose(){this.buffers.clear()}}Qt.SharedArraySenderStrategy=Ja;class Qa{constructor(t){this.data=new Int32Array(t,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===hn.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class Ga{constructor(t){this.token=new Qa(t)}cancel(){}dispose(){}}class Xa{constructor(){this.kind="request"}createCancellationTokenSource(t){const n=t.$cancellationData;return n===void 0?new Va.CancellationTokenSource:new Ga(n)}}Qt.SharedArrayReceiverStrategy=Xa;var us={},mn={};Object.defineProperty(mn,"__esModule",{value:!0}),mn.Semaphore=void 0;const Ya=vt;class Za{constructor(t=1){if(t<=0)throw new Error("Capacity must be greater than 0");this._capacity=t,this._active=0,this._waiting=[]}lock(t){return new Promise((n,i)=>{this._waiting.push({thunk:t,resolve:n,reject:i}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,Ya.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const t=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const n=t.thunk();n instanceof Promise?n.then(i=>{this._active--,t.resolve(i),this.runNext()},i=>{this._active--,t.reject(i),this.runNext()}):(this._active--,t.resolve(n),this.runNext())}catch(n){this._active--,t.reject(n),this.runNext()}}}mn.Semaphore=Za,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ReadableStreamMessageReader=e.AbstractMessageReader=e.MessageReader=void 0;const t=vt,n=Ne,i=Jt,r=mn;(function(c){function d(p){let m=p;return m&&n.func(m.listen)&&n.func(m.dispose)&&n.func(m.onError)&&n.func(m.onClose)&&n.func(m.onPartialMessage)}c.is=d})(e.MessageReader||(e.MessageReader={}));class o{constructor(){this.errorEmitter=new i.Emitter,this.closeEmitter=new i.Emitter,this.partialMessageEmitter=new i.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(d){this.errorEmitter.fire(this.asError(d))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(d){this.partialMessageEmitter.fire(d)}asError(d){return d instanceof Error?d:new Error(`Reader received error. Reason: ${n.string(d.message)?d.message:"unknown"}`)}}e.AbstractMessageReader=o;var s;(function(c){function d(p){let m,f;const h=new Map;let y;const E=new Map;if(p===void 0||typeof p=="string")m=p??"utf-8";else{if(m=p.charset??"utf-8",p.contentDecoder!==void 0&&(f=p.contentDecoder,h.set(f.name,f)),p.contentDecoders!==void 0)for(const I of p.contentDecoders)h.set(I.name,I);if(p.contentTypeDecoder!==void 0&&(y=p.contentTypeDecoder,E.set(y.name,y)),p.contentTypeDecoders!==void 0)for(const I of p.contentTypeDecoders)E.set(I.name,I)}return y===void 0&&(y=(0,t.default)().applicationJson.decoder,E.set(y.name,y)),{charset:m,contentDecoder:f,contentDecoders:h,contentTypeDecoder:y,contentTypeDecoders:E}}c.fromOptions=d})(s||(s={}));class a extends o{constructor(d,p){super(),this.readable=d,this.options=s.fromOptions(p),this.buffer=(0,t.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new r.Semaphore(1)}set partialMessageTimeout(d){this._partialMessageTimeout=d}get partialMessageTimeout(){return this._partialMessageTimeout}listen(d){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=d;const p=this.readable.onData(m=>{this.onData(m)});return this.readable.onError(m=>this.fireError(m)),this.readable.onClose(()=>this.fireClose()),p}onData(d){for(this.buffer.append(d);;){if(this.nextMessageLength===-1){const m=this.buffer.tryReadHeaders(!0);if(!m)return;const f=m.get("content-length");if(!f){this.fireError(new Error("Header must provide a Content-Length property."));return}const h=parseInt(f);if(isNaN(h)){this.fireError(new Error("Content-Length value must be a number."));return}this.nextMessageLength=h}const p=this.buffer.tryReadBody(this.nextMessageLength);if(p===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{const m=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(p):p,f=await this.options.contentTypeDecoder.decode(m,this.options);this.callback(f)}).catch(m=>{this.fireError(m)})}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,t.default)().timer.setTimeout((d,p)=>{this.partialMessageTimer=void 0,d===this.messageToken&&(this.firePartialMessage({messageToken:d,waitingTime:p}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}e.ReadableStreamMessageReader=a}(us);var ds={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WriteableStreamMessageWriter=e.AbstractMessageWriter=e.MessageWriter=void 0;const t=vt,n=Ne,i=mn,r=Jt,o="Content-Length: ",s=`\r
`;(function(p){function m(f){let h=f;return h&&n.func(h.dispose)&&n.func(h.onClose)&&n.func(h.onError)&&n.func(h.write)}p.is=m})(e.MessageWriter||(e.MessageWriter={}));class a{constructor(){this.errorEmitter=new r.Emitter,this.closeEmitter=new r.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(m,f,h){this.errorEmitter.fire([this.asError(m),f,h])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(m){return m instanceof Error?m:new Error(`Writer received error. Reason: ${n.string(m.message)?m.message:"unknown"}`)}}e.AbstractMessageWriter=a;var c;(function(p){function m(f){return f===void 0||typeof f=="string"?{charset:f??"utf-8",contentTypeEncoder:(0,t.default)().applicationJson.encoder}:{charset:f.charset??"utf-8",contentEncoder:f.contentEncoder,contentTypeEncoder:f.contentTypeEncoder??(0,t.default)().applicationJson.encoder}}p.fromOptions=m})(c||(c={}));class d extends a{constructor(m,f){super(),this.writable=m,this.options=c.fromOptions(f),this.errorCount=0,this.writeSemaphore=new i.Semaphore(1),this.writable.onError(h=>this.fireError(h)),this.writable.onClose(()=>this.fireClose())}async write(m){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(m,this.options).then(h=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(h):h).then(h=>{const y=[];return y.push(o,h.byteLength.toString(),s),y.push(s),this.doWrite(m,y,h)},h=>{throw this.fireError(h),h}))}async doWrite(m,f,h){try{return await this.writable.write(f.join(""),"ascii"),this.writable.write(h)}catch(y){return this.handleError(y,m),Promise.reject(y)}}handleError(m,f){this.errorCount++,this.fireError(m,f,this.errorCount)}end(){this.writable.end()}}e.WriteableStreamMessageWriter=d})(ds);var zn={};Object.defineProperty(zn,"__esModule",{value:!0}),zn.AbstractMessageBuffer=void 0;const ec=13,tc=10,nc=`\r
`;class ic{constructor(t="utf-8"){this._encoding=t,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(t){const n=typeof t=="string"?this.fromString(t,this._encoding):t;this._chunks.push(n),this._totalLength+=n.byteLength}tryReadHeaders(t=!1){if(this._chunks.length===0)return;let n=0,i=0,r=0,o=0;e:for(;i<this._chunks.length;){const d=this._chunks[i];for(r=0;r<d.length;){switch(d[r]){case ec:switch(n){case 0:n=1;break;case 2:n=3;break;default:n=0}break;case tc:switch(n){case 1:n=2;break;case 3:n=4,r++;break e;default:n=0}break;default:n=0}r++}o+=d.byteLength,i++}if(n!==4)return;const s=this._read(o+r),a=new Map,c=this.toString(s,"ascii").split(nc);if(c.length<2)return a;for(let d=0;d<c.length-2;d++){const p=c[d],m=p.indexOf(":");if(m===-1)throw new Error("Message header must separate key and value using :");const f=p.substr(0,m),h=p.substr(m+1).trim();a.set(t?f.toLowerCase():f,h)}return a}tryReadBody(t){if(!(this._totalLength<t))return this._read(t)}get numberOfBytes(){return this._totalLength}_read(t){if(t===0)return this.emptyBuffer();if(t>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===t){const o=this._chunks[0];return this._chunks.shift(),this._totalLength-=t,this.asNative(o)}if(this._chunks[0].byteLength>t){const o=this._chunks[0],s=this.asNative(o,t);return this._chunks[0]=o.slice(t),this._totalLength-=t,s}const n=this.allocNative(t);let i=0,r=0;for(;t>0;){const o=this._chunks[r];if(o.byteLength>t){const s=o.slice(0,t);n.set(s,i),i+=t,this._chunks[r]=o.slice(t),this._totalLength-=t,t-=t}else n.set(o,i),i+=o.byteLength,this._chunks.shift(),this._totalLength-=o.byteLength,t-=o.byteLength}return n}}zn.AbstractMessageBuffer=ic;var ls={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.ConnectionOptions=e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.RequestCancellationReceiverStrategy=e.IdCancellationReceiverStrategy=e.ConnectionStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=e.NullLogger=e.ProgressType=e.ProgressToken=void 0;const t=vt,n=Ne,i=nr,r=ir,o=Jt,s=Un;var a;(function(R){R.type=new i.NotificationType("$/cancelRequest")})(a||(a={}));var c;(function(R){function l(T){return typeof T=="string"||typeof T=="number"}R.is=l})(c=e.ProgressToken||(e.ProgressToken={}));var d;(function(R){R.type=new i.NotificationType("$/progress")})(d||(d={}));class p{constructor(){}}e.ProgressType=p;var m;(function(R){function l(T){return n.func(T)}R.is=l})(m||(m={})),e.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var f;(function(R){R[R.Off=0]="Off",R[R.Messages=1]="Messages",R[R.Compact=2]="Compact",R[R.Verbose=3]="Verbose"})(f=e.Trace||(e.Trace={})),function(R){R.Off="off",R.Messages="messages",R.Compact="compact",R.Verbose="verbose"}(e.TraceValues||(e.TraceValues={})),function(R){function l(j){if(!n.string(j))return R.Off;switch(j=j.toLowerCase(),j){case"off":return R.Off;case"messages":return R.Messages;case"compact":return R.Compact;case"verbose":return R.Verbose;default:return R.Off}}R.fromString=l;function T(j){switch(j){case R.Off:return"off";case R.Messages:return"messages";case R.Compact:return"compact";case R.Verbose:return"verbose";default:return"off"}}R.toString=T}(f=e.Trace||(e.Trace={}));var h;(function(R){R.Text="text",R.JSON="json"})(h=e.TraceFormat||(e.TraceFormat={})),function(R){function l(T){return n.string(T)?(T=T.toLowerCase(),T==="json"?R.JSON:R.Text):R.Text}R.fromString=l}(h=e.TraceFormat||(e.TraceFormat={}));var y;(function(R){R.type=new i.NotificationType("$/setTrace")})(y=e.SetTraceNotification||(e.SetTraceNotification={}));var E;(function(R){R.type=new i.NotificationType("$/logTrace")})(E=e.LogTraceNotification||(e.LogTraceNotification={}));var I;(function(R){R[R.Closed=1]="Closed",R[R.Disposed=2]="Disposed",R[R.AlreadyListening=3]="AlreadyListening"})(I=e.ConnectionErrors||(e.ConnectionErrors={}));class J extends Error{constructor(l,T){super(T),this.code=l,Object.setPrototypeOf(this,J.prototype)}}e.ConnectionError=J;var B;(function(R){function l(T){const j=T;return j&&n.func(j.cancelUndispatched)}R.is=l})(B=e.ConnectionStrategy||(e.ConnectionStrategy={}));var w;(function(R){function l(T){const j=T;return j&&(j.kind===void 0||j.kind==="id")&&n.func(j.createCancellationTokenSource)&&(j.dispose===void 0||n.func(j.dispose))}R.is=l})(w=e.IdCancellationReceiverStrategy||(e.IdCancellationReceiverStrategy={}));var k;(function(R){function l(T){const j=T;return j&&j.kind==="request"&&n.func(j.createCancellationTokenSource)&&(j.dispose===void 0||n.func(j.dispose))}R.is=l})(k=e.RequestCancellationReceiverStrategy||(e.RequestCancellationReceiverStrategy={}));var L;(function(R){R.Message=Object.freeze({createCancellationTokenSource(T){return new s.CancellationTokenSource}});function l(T){return w.is(T)||k.is(T)}R.is=l})(L=e.CancellationReceiverStrategy||(e.CancellationReceiverStrategy={}));var z;(function(R){R.Message=Object.freeze({sendCancellation(T,j){return T.sendNotification(a.type,{id:j})},cleanup(T){}});function l(T){const j=T;return j&&n.func(j.sendCancellation)&&n.func(j.cleanup)}R.is=l})(z=e.CancellationSenderStrategy||(e.CancellationSenderStrategy={}));var A;(function(R){R.Message=Object.freeze({receiver:L.Message,sender:z.Message});function l(T){const j=T;return j&&L.is(j.receiver)&&z.is(j.sender)}R.is=l})(A=e.CancellationStrategy||(e.CancellationStrategy={}));var U;(function(R){function l(T){const j=T;return j&&n.func(j.handleMessage)}R.is=l})(U=e.MessageStrategy||(e.MessageStrategy={})),function(R){function l(T){const j=T;return j&&(A.is(j.cancellationStrategy)||B.is(j.connectionStrategy)||U.is(j.messageStrategy))}R.is=l}(e.ConnectionOptions||(e.ConnectionOptions={}));var W;(function(R){R[R.New=1]="New",R[R.Listening=2]="Listening",R[R.Closed=3]="Closed",R[R.Disposed=4]="Disposed"})(W||(W={}));function ee(R,l,T,j){const K=T!==void 0?T:e.NullLogger;let H=0,X=0,re=0;const Te="2.0";let xe;const ut=new Map;let Ke;const Je=new Map,lt=new Map;let ft,Qe=new r.LinkedMap,Ge=new Map,Ze=new Set,je=new Map,ue=f.Off,Be=h.Text,_e,Y=W.New;const $e=new o.Emitter,gt=new o.Emitter,pt=new o.Emitter,Xe=new o.Emitter,Z=new o.Emitter,_=j&&j.cancellationStrategy?j.cancellationStrategy:A.Message;function b(C){if(C===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+C.toString()}function D(C){return C===null?"res-unknown-"+(++re).toString():"res-"+C.toString()}function M(){return"not-"+(++X).toString()}function q(C,O){i.Message.isRequest(O)?C.set(b(O.id),O):i.Message.isResponse(O)?C.set(D(O.id),O):C.set(M(),O)}function N(C){}function De(){return Y===W.Listening}function te(){return Y===W.Closed}function Ae(){return Y===W.Disposed}function He(){(Y===W.New||Y===W.Listening)&&(Y=W.Closed,gt.fire(void 0))}function kt(C){$e.fire([C,void 0,void 0])}function Kt(C){$e.fire(C)}R.onClose(He),R.onError(kt),l.onClose(He),l.onError(Kt);function Ut(){ft||Qe.size===0||(ft=(0,t.default)().timer.setImmediate(()=>{ft=void 0,zt()}))}function Ft(C){i.Message.isRequest(C)?xt(C):i.Message.isNotification(C)?Bt(C):i.Message.isResponse(C)?dn(C):Et(C)}function zt(){if(Qe.size===0)return;const C=Qe.shift();try{const O=j?.messageStrategy;U.is(O)?O.handleMessage(C,Ft):Ft(C)}finally{Ut()}}const un=C=>{try{if(i.Message.isNotification(C)&&C.method===a.type.method){const O=C.params.id,x=b(O),G=Qe.get(x);if(i.Message.isRequest(G)){const we=j?.connectionStrategy,ke=we&&we.cancelUndispatched?we.cancelUndispatched(G,N):void 0;if(ke&&(ke.error!==void 0||ke.result!==void 0)){Qe.delete(x),je.delete(O),ke.id=G.id,he(ke,C.method,Date.now()),l.write(ke).catch(()=>K.error("Sending response for canceled message failed."));return}}const Se=je.get(O);if(Se!==void 0){Se.cancel(),Oe(C);return}else Ze.add(O)}q(Qe,C)}finally{Ut()}};function xt(C){if(Ae())return;function O(v,P,$){const fe={jsonrpc:Te,id:C.id};v instanceof i.ResponseError?fe.error=v.toJson():fe.result=v===void 0?null:v,he(fe,P,$),l.write(fe).catch(()=>K.error("Sending response failed."))}function x(v,P,$){const fe={jsonrpc:Te,id:C.id,error:v.toJson()};he(fe,P,$),l.write(fe).catch(()=>K.error("Sending response failed."))}function G(v,P,$){v===void 0&&(v=null);const fe={jsonrpc:Te,id:C.id,result:v};he(fe,P,$),l.write(fe).catch(()=>K.error("Sending response failed."))}be(C);const Se=ut.get(C.method);let we,ke;Se&&(we=Se.type,ke=Se.handler);const u=Date.now();if(ke||xe){const v=C.id??String(Date.now()),P=w.is(_.receiver)?_.receiver.createCancellationTokenSource(v):_.receiver.createCancellationTokenSource(C);C.id!==null&&Ze.has(C.id)&&P.cancel(),C.id!==null&&je.set(v,P);try{let $;if(ke)if(C.params===void 0){if(we!==void 0&&we.numberOfParams!==0){x(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${C.method} defines ${we.numberOfParams} params but received none.`),C.method,u);return}$=ke(P.token)}else if(Array.isArray(C.params)){if(we!==void 0&&we.parameterStructures===i.ParameterStructures.byName){x(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${C.method} defines parameters by name but received parameters by position`),C.method,u);return}$=ke(...C.params,P.token)}else{if(we!==void 0&&we.parameterStructures===i.ParameterStructures.byPosition){x(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${C.method} defines parameters by position but received parameters by name`),C.method,u);return}$=ke(C.params,P.token)}else xe&&($=xe(C.method,C.params,P.token));const fe=$;$?fe.then?fe.then(me=>{je.delete(v),O(me,C.method,u)},me=>{je.delete(v),me instanceof i.ResponseError?x(me,C.method,u):me&&n.string(me.message)?x(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${C.method} failed with message: ${me.message}`),C.method,u):x(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${C.method} failed unexpectedly without providing any details.`),C.method,u)}):(je.delete(v),O($,C.method,u)):(je.delete(v),G($,C.method,u))}catch($){je.delete(v),$ instanceof i.ResponseError?O($,C.method,u):$&&n.string($.message)?x(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${C.method} failed with message: ${$.message}`),C.method,u):x(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${C.method} failed unexpectedly without providing any details.`),C.method,u)}}else x(new i.ResponseError(i.ErrorCodes.MethodNotFound,`Unhandled method ${C.method}`),C.method,u)}function dn(C){if(!Ae())if(C.id===null)C.error?K.error(`Received response message without id: Error is: 
${JSON.stringify(C.error,void 0,4)}`):K.error("Received response message without id. No further error information provided.");else{const O=C.id,x=Ge.get(O);if(Ye(C,x),x!==void 0){Ge.delete(O);try{if(C.error){const G=C.error;x.reject(new i.ResponseError(G.code,G.message,G.data))}else if(C.result!==void 0)x.resolve(C.result);else throw new Error("Should never happen.")}catch(G){G.message?K.error(`Response handler '${x.method}' failed with message: ${G.message}`):K.error(`Response handler '${x.method}' failed unexpectedly.`)}}}}function Bt(C){if(Ae())return;let O,x;if(C.method===a.type.method){const G=C.params.id;Ze.delete(G),Oe(C);return}else{const G=Je.get(C.method);G&&(x=G.handler,O=G.type)}if(x||Ke)try{if(Oe(C),x)if(C.params===void 0)O!==void 0&&O.numberOfParams!==0&&O.parameterStructures!==i.ParameterStructures.byName&&K.error(`Notification ${C.method} defines ${O.numberOfParams} params but received none.`),x();else if(Array.isArray(C.params)){const G=C.params;C.method===d.type.method&&G.length===2&&c.is(G[0])?x({token:G[0],value:G[1]}):(O!==void 0&&(O.parameterStructures===i.ParameterStructures.byName&&K.error(`Notification ${C.method} defines parameters by name but received parameters by position`),O.numberOfParams!==C.params.length&&K.error(`Notification ${C.method} defines ${O.numberOfParams} params but received ${G.length} arguments`)),x(...G))}else O!==void 0&&O.parameterStructures===i.ParameterStructures.byPosition&&K.error(`Notification ${C.method} defines parameters by position but received parameters by name`),x(C.params);else Ke&&Ke(C.method,C.params)}catch(G){G.message?K.error(`Notification handler '${C.method}' failed with message: ${G.message}`):K.error(`Notification handler '${C.method}' failed unexpectedly.`)}else pt.fire(C)}function Et(C){if(!C){K.error("Received empty message.");return}K.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(C,null,4)}`);const O=C;if(n.string(O.id)||n.number(O.id)){const x=O.id,G=Ge.get(x);G&&G.reject(new Error("The received response has neither a result nor an error property."))}}function g(C){if(C!=null)switch(ue){case f.Verbose:return JSON.stringify(C,null,4);case f.Compact:return JSON.stringify(C);default:return}}function F(C){if(!(ue===f.Off||!_e))if(Be===h.Text){let O;(ue===f.Verbose||ue===f.Compact)&&C.params&&(O=`Params: ${g(C.params)}

`),_e.log(`Sending request '${C.method} - (${C.id})'.`,O)}else Ue("send-request",C)}function Q(C){if(!(ue===f.Off||!_e))if(Be===h.Text){let O;(ue===f.Verbose||ue===f.Compact)&&(C.params?O=`Params: ${g(C.params)}

`:O=`No parameters provided.

`),_e.log(`Sending notification '${C.method}'.`,O)}else Ue("send-notification",C)}function he(C,O,x){if(!(ue===f.Off||!_e))if(Be===h.Text){let G;(ue===f.Verbose||ue===f.Compact)&&(C.error&&C.error.data?G=`Error data: ${g(C.error.data)}

`:C.result?G=`Result: ${g(C.result)}

`:C.error===void 0&&(G=`No result returned.

`)),_e.log(`Sending response '${O} - (${C.id})'. Processing request took ${Date.now()-x}ms`,G)}else Ue("send-response",C)}function be(C){if(!(ue===f.Off||!_e))if(Be===h.Text){let O;(ue===f.Verbose||ue===f.Compact)&&C.params&&(O=`Params: ${g(C.params)}

`),_e.log(`Received request '${C.method} - (${C.id})'.`,O)}else Ue("receive-request",C)}function Oe(C){if(!(ue===f.Off||!_e||C.method===E.type.method))if(Be===h.Text){let O;(ue===f.Verbose||ue===f.Compact)&&(C.params?O=`Params: ${g(C.params)}

`:O=`No parameters provided.

`),_e.log(`Received notification '${C.method}'.`,O)}else Ue("receive-notification",C)}function Ye(C,O){if(!(ue===f.Off||!_e))if(Be===h.Text){let x;if((ue===f.Verbose||ue===f.Compact)&&(C.error&&C.error.data?x=`Error data: ${g(C.error.data)}

`:C.result?x=`Result: ${g(C.result)}

`:C.error===void 0&&(x=`No result returned.

`)),O){const G=C.error?` Request failed: ${C.error.message} (${C.error.code}).`:"";_e.log(`Received response '${O.method} - (${C.id})' in ${Date.now()-O.timerStart}ms.${G}`,x)}else _e.log(`Received response ${C.id} without active response promise.`,x)}else Ue("receive-response",C)}function Ue(C,O){if(!_e||ue===f.Off)return;const x={isLSPMessage:!0,type:C,message:O,timestamp:Date.now()};_e.log(x)}function Ot(){if(te())throw new J(I.Closed,"Connection is closed.");if(Ae())throw new J(I.Disposed,"Connection is disposed.")}function Vt(){if(De())throw new J(I.AlreadyListening,"Connection is already listening")}function Xi(){if(!De())throw new Error("Call listen() first.")}function St(C){return C===void 0?null:C}function Hn(C){if(C!==null)return C}function ln(C){return C!=null&&!Array.isArray(C)&&typeof C=="object"}function fn(C,O){switch(C){case i.ParameterStructures.auto:return ln(O)?Hn(O):[St(O)];case i.ParameterStructures.byName:if(!ln(O))throw new Error("Received parameters by name but param is not an object literal.");return Hn(O);case i.ParameterStructures.byPosition:return[St(O)];default:throw new Error(`Unknown parameter structure ${C.toString()}`)}}function $n(C,O){let x;const G=C.numberOfParams;switch(G){case 0:x=void 0;break;case 1:x=fn(C.parameterStructures,O[0]);break;default:x=[];for(let Se=0;Se<O.length&&Se<G;Se++)x.push(St(O[Se]));if(O.length<G)for(let Se=O.length;Se<G;Se++)x.push(null);break}return x}const yt={sendNotification:(C,...O)=>{Ot();let x,G;if(n.string(C)){x=C;const we=O[0];let ke=0,u=i.ParameterStructures.auto;i.ParameterStructures.is(we)&&(ke=1,u=we);let v=O.length;const P=v-ke;switch(P){case 0:G=void 0;break;case 1:G=fn(u,O[ke]);break;default:if(u===i.ParameterStructures.byName)throw new Error(`Received ${P} parameters for 'by Name' notification parameter structure.`);G=O.slice(ke,v).map($=>St($));break}}else{const we=O;x=C.method,G=$n(C,we)}const Se={jsonrpc:Te,method:x,params:G};return Q(Se),l.write(Se).catch(we=>{throw K.error("Sending notification failed."),we})},onNotification:(C,O)=>{Ot();let x;return n.func(C)?Ke=C:O&&(n.string(C)?(x=C,Je.set(C,{type:void 0,handler:O})):(x=C.method,Je.set(C.method,{type:C,handler:O}))),{dispose:()=>{x!==void 0?Je.delete(x):Ke=void 0}}},onProgress:(C,O,x)=>{if(lt.has(O))throw new Error(`Progress handler for token ${O} already registered`);return lt.set(O,x),{dispose:()=>{lt.delete(O)}}},sendProgress:(C,O,x)=>yt.sendNotification(d.type,{token:O,value:x}),onUnhandledProgress:Xe.event,sendRequest:(C,...O)=>{Ot(),Xi();let x,G,Se;if(n.string(C)){x=C;const v=O[0],P=O[O.length-1];let $=0,fe=i.ParameterStructures.auto;i.ParameterStructures.is(v)&&($=1,fe=v);let me=O.length;s.CancellationToken.is(P)&&(me=me-1,Se=P);const ce=me-$;switch(ce){case 0:G=void 0;break;case 1:G=fn(fe,O[$]);break;default:if(fe===i.ParameterStructures.byName)throw new Error(`Received ${ce} parameters for 'by Name' request parameter structure.`);G=O.slice($,me).map(ot=>St(ot));break}}else{const v=O;x=C.method,G=$n(C,v);const P=C.numberOfParams;Se=s.CancellationToken.is(v[P])?v[P]:void 0}const we=H++;let ke;Se&&(ke=Se.onCancellationRequested(()=>{const v=_.sender.sendCancellation(yt,we);return v===void 0?(K.log(`Received no promise from cancellation strategy when cancelling id ${we}`),Promise.resolve()):v.catch(()=>{K.log(`Sending cancellation messages for id ${we} failed`)})}));const u={jsonrpc:Te,id:we,method:x,params:G};return F(u),typeof _.sender.enableCancellation=="function"&&_.sender.enableCancellation(u),new Promise(async(v,P)=>{const $=ce=>{v(ce),_.sender.cleanup(we),ke?.dispose()},fe=ce=>{P(ce),_.sender.cleanup(we),ke?.dispose()},me={method:x,timerStart:Date.now(),resolve:$,reject:fe};try{await l.write(u),Ge.set(we,me)}catch(ce){throw K.error("Sending request failed."),me.reject(new i.ResponseError(i.ErrorCodes.MessageWriteError,ce.message?ce.message:"Unknown reason")),ce}})},onRequest:(C,O)=>{Ot();let x=null;return m.is(C)?(x=void 0,xe=C):n.string(C)?(x=null,O!==void 0&&(x=C,ut.set(C,{handler:O,type:void 0}))):O!==void 0&&(x=C.method,ut.set(C.method,{type:C,handler:O})),{dispose:()=>{x!==null&&(x!==void 0?ut.delete(x):xe=void 0)}}},hasPendingResponse:()=>Ge.size>0,trace:async(C,O,x)=>{let G=!1,Se=h.Text;x!==void 0&&(n.boolean(x)?G=x:(G=x.sendNotification||!1,Se=x.traceFormat||h.Text)),ue=C,Be=Se,ue===f.Off?_e=void 0:_e=O,G&&!te()&&!Ae()&&await yt.sendNotification(y.type,{value:f.toString(C)})},onError:$e.event,onClose:gt.event,onUnhandledNotification:pt.event,onDispose:Z.event,end:()=>{l.end()},dispose:()=>{if(Ae())return;Y=W.Disposed,Z.fire(void 0);const C=new i.ResponseError(i.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const O of Ge.values())O.reject(C);Ge=new Map,je=new Map,Ze=new Set,Qe=new r.LinkedMap,n.func(l.dispose)&&l.dispose(),n.func(R.dispose)&&R.dispose()},listen:()=>{Ot(),Vt(),Y=W.Listening,R.listen(un)},inspect:()=>{(0,t.default)().console.log("inspect")}};return yt.onNotification(E.type,C=>{if(ue===f.Off||!_e)return;const O=ue===f.Verbose||ue===f.Compact;_e.log(C.message,O?C.verbose:void 0)}),yt.onNotification(d.type,C=>{const O=lt.get(C.token);O?O(C.value):Xe.fire(C)}),yt}e.createMessageConnection=ee})(ls),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProgressType=e.ProgressToken=e.createMessageConnection=e.NullLogger=e.ConnectionOptions=e.ConnectionStrategy=e.AbstractMessageBuffer=e.WriteableStreamMessageWriter=e.AbstractMessageWriter=e.MessageWriter=e.ReadableStreamMessageReader=e.AbstractMessageReader=e.MessageReader=e.SharedArrayReceiverStrategy=e.SharedArraySenderStrategy=e.CancellationToken=e.CancellationTokenSource=e.Emitter=e.Event=e.Disposable=e.LRUCache=e.Touch=e.LinkedMap=e.ParameterStructures=e.NotificationType9=e.NotificationType8=e.NotificationType7=e.NotificationType6=e.NotificationType5=e.NotificationType4=e.NotificationType3=e.NotificationType2=e.NotificationType1=e.NotificationType0=e.NotificationType=e.ErrorCodes=e.ResponseError=e.RequestType9=e.RequestType8=e.RequestType7=e.RequestType6=e.RequestType5=e.RequestType4=e.RequestType3=e.RequestType2=e.RequestType1=e.RequestType0=e.RequestType=e.Message=e.RAL=void 0,e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=void 0;const t=nr;Object.defineProperty(e,"Message",{enumerable:!0,get:function(){return t.Message}}),Object.defineProperty(e,"RequestType",{enumerable:!0,get:function(){return t.RequestType}}),Object.defineProperty(e,"RequestType0",{enumerable:!0,get:function(){return t.RequestType0}}),Object.defineProperty(e,"RequestType1",{enumerable:!0,get:function(){return t.RequestType1}}),Object.defineProperty(e,"RequestType2",{enumerable:!0,get:function(){return t.RequestType2}}),Object.defineProperty(e,"RequestType3",{enumerable:!0,get:function(){return t.RequestType3}}),Object.defineProperty(e,"RequestType4",{enumerable:!0,get:function(){return t.RequestType4}}),Object.defineProperty(e,"RequestType5",{enumerable:!0,get:function(){return t.RequestType5}}),Object.defineProperty(e,"RequestType6",{enumerable:!0,get:function(){return t.RequestType6}}),Object.defineProperty(e,"RequestType7",{enumerable:!0,get:function(){return t.RequestType7}}),Object.defineProperty(e,"RequestType8",{enumerable:!0,get:function(){return t.RequestType8}}),Object.defineProperty(e,"RequestType9",{enumerable:!0,get:function(){return t.RequestType9}}),Object.defineProperty(e,"ResponseError",{enumerable:!0,get:function(){return t.ResponseError}}),Object.defineProperty(e,"ErrorCodes",{enumerable:!0,get:function(){return t.ErrorCodes}}),Object.defineProperty(e,"NotificationType",{enumerable:!0,get:function(){return t.NotificationType}}),Object.defineProperty(e,"NotificationType0",{enumerable:!0,get:function(){return t.NotificationType0}}),Object.defineProperty(e,"NotificationType1",{enumerable:!0,get:function(){return t.NotificationType1}}),Object.defineProperty(e,"NotificationType2",{enumerable:!0,get:function(){return t.NotificationType2}}),Object.defineProperty(e,"NotificationType3",{enumerable:!0,get:function(){return t.NotificationType3}}),Object.defineProperty(e,"NotificationType4",{enumerable:!0,get:function(){return t.NotificationType4}}),Object.defineProperty(e,"NotificationType5",{enumerable:!0,get:function(){return t.NotificationType5}}),Object.defineProperty(e,"NotificationType6",{enumerable:!0,get:function(){return t.NotificationType6}}),Object.defineProperty(e,"NotificationType7",{enumerable:!0,get:function(){return t.NotificationType7}}),Object.defineProperty(e,"NotificationType8",{enumerable:!0,get:function(){return t.NotificationType8}}),Object.defineProperty(e,"NotificationType9",{enumerable:!0,get:function(){return t.NotificationType9}}),Object.defineProperty(e,"ParameterStructures",{enumerable:!0,get:function(){return t.ParameterStructures}});const n=ir;Object.defineProperty(e,"LinkedMap",{enumerable:!0,get:function(){return n.LinkedMap}}),Object.defineProperty(e,"LRUCache",{enumerable:!0,get:function(){return n.LRUCache}}),Object.defineProperty(e,"Touch",{enumerable:!0,get:function(){return n.Touch}});const i=cs;Object.defineProperty(e,"Disposable",{enumerable:!0,get:function(){return i.Disposable}});const r=Jt;Object.defineProperty(e,"Event",{enumerable:!0,get:function(){return r.Event}}),Object.defineProperty(e,"Emitter",{enumerable:!0,get:function(){return r.Emitter}});const o=Un;Object.defineProperty(e,"CancellationTokenSource",{enumerable:!0,get:function(){return o.CancellationTokenSource}}),Object.defineProperty(e,"CancellationToken",{enumerable:!0,get:function(){return o.CancellationToken}});const s=Qt;Object.defineProperty(e,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return s.SharedArraySenderStrategy}}),Object.defineProperty(e,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return s.SharedArrayReceiverStrategy}});const a=us;Object.defineProperty(e,"MessageReader",{enumerable:!0,get:function(){return a.MessageReader}}),Object.defineProperty(e,"AbstractMessageReader",{enumerable:!0,get:function(){return a.AbstractMessageReader}}),Object.defineProperty(e,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return a.ReadableStreamMessageReader}});const c=ds;Object.defineProperty(e,"MessageWriter",{enumerable:!0,get:function(){return c.MessageWriter}}),Object.defineProperty(e,"AbstractMessageWriter",{enumerable:!0,get:function(){return c.AbstractMessageWriter}}),Object.defineProperty(e,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return c.WriteableStreamMessageWriter}});const d=zn;Object.defineProperty(e,"AbstractMessageBuffer",{enumerable:!0,get:function(){return d.AbstractMessageBuffer}});const p=ls;Object.defineProperty(e,"ConnectionStrategy",{enumerable:!0,get:function(){return p.ConnectionStrategy}}),Object.defineProperty(e,"ConnectionOptions",{enumerable:!0,get:function(){return p.ConnectionOptions}}),Object.defineProperty(e,"NullLogger",{enumerable:!0,get:function(){return p.NullLogger}}),Object.defineProperty(e,"createMessageConnection",{enumerable:!0,get:function(){return p.createMessageConnection}}),Object.defineProperty(e,"ProgressToken",{enumerable:!0,get:function(){return p.ProgressToken}}),Object.defineProperty(e,"ProgressType",{enumerable:!0,get:function(){return p.ProgressType}}),Object.defineProperty(e,"Trace",{enumerable:!0,get:function(){return p.Trace}}),Object.defineProperty(e,"TraceValues",{enumerable:!0,get:function(){return p.TraceValues}}),Object.defineProperty(e,"TraceFormat",{enumerable:!0,get:function(){return p.TraceFormat}}),Object.defineProperty(e,"SetTraceNotification",{enumerable:!0,get:function(){return p.SetTraceNotification}}),Object.defineProperty(e,"LogTraceNotification",{enumerable:!0,get:function(){return p.LogTraceNotification}}),Object.defineProperty(e,"ConnectionErrors",{enumerable:!0,get:function(){return p.ConnectionErrors}}),Object.defineProperty(e,"ConnectionError",{enumerable:!0,get:function(){return p.ConnectionError}}),Object.defineProperty(e,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return p.CancellationReceiverStrategy}}),Object.defineProperty(e,"CancellationSenderStrategy",{enumerable:!0,get:function(){return p.CancellationSenderStrategy}}),Object.defineProperty(e,"CancellationStrategy",{enumerable:!0,get:function(){return p.CancellationStrategy}}),Object.defineProperty(e,"MessageStrategy",{enumerable:!0,get:function(){return p.MessageStrategy}});const m=vt;e.RAL=m.default}(Kn),Object.defineProperty(tr,"__esModule",{value:!0});const ht=Kn;class Gi extends ht.AbstractMessageBuffer{constructor(t="utf-8"){super(t),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return Gi.emptyBuffer}fromString(t,n){return new TextEncoder().encode(t)}toString(t,n){return n==="ascii"?this.asciiDecoder.decode(t):new TextDecoder(n).decode(t)}asNative(t,n){return n===void 0?t:t.slice(0,n)}allocNative(t){return new Uint8Array(t)}}Gi.emptyBuffer=new Uint8Array(0);class rc{constructor(t){this.socket=t,this._onData=new ht.Emitter,this._messageListener=n=>{n.data.arrayBuffer().then(r=>{this._onData.fire(new Uint8Array(r))},()=>{(0,ht.RAL)().console.error("Converting blob to array buffer failed.")})},this.socket.addEventListener("message",this._messageListener)}onClose(t){return this.socket.addEventListener("close",t),ht.Disposable.create(()=>this.socket.removeEventListener("close",t))}onError(t){return this.socket.addEventListener("error",t),ht.Disposable.create(()=>this.socket.removeEventListener("error",t))}onEnd(t){return this.socket.addEventListener("end",t),ht.Disposable.create(()=>this.socket.removeEventListener("end",t))}onData(t){return this._onData.event(t)}}class oc{constructor(t){this.socket=t}onClose(t){return this.socket.addEventListener("close",t),ht.Disposable.create(()=>this.socket.removeEventListener("close",t))}onError(t){return this.socket.addEventListener("error",t),ht.Disposable.create(()=>this.socket.removeEventListener("error",t))}onEnd(t){return this.socket.addEventListener("end",t),ht.Disposable.create(()=>this.socket.removeEventListener("end",t))}write(t,n){if(typeof t=="string"){if(n!==void 0&&n!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${n}`);this.socket.send(t)}else this.socket.send(t);return Promise.resolve()}end(){this.socket.close()}}const sc=new TextEncoder,fs=Object.freeze({messageBuffer:Object.freeze({create:e=>new Gi(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{if(t.charset!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t.charset}`);return Promise.resolve(sc.encode(JSON.stringify(e,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{if(!(e instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(t.charset).decode(e)))}})}),stream:Object.freeze({asReadableStream:e=>new rc(e),asWritableStream:e=>new oc(e)}),console,timer:Object.freeze({setTimeout(e,t,...n){const i=setTimeout(e,t,...n);return{dispose:()=>clearTimeout(i)}},setImmediate(e,...t){const n=setTimeout(e,0,...t);return{dispose:()=>clearTimeout(n)}},setInterval(e,t,...n){const i=setInterval(e,t,...n);return{dispose:()=>clearInterval(i)}}})});function sr(){return fs}(function(e){function t(){ht.RAL.install(fs)}e.install=t})(sr||(sr={})),tr.default=sr,function(e){var t=Ie&&Ie.__createBinding||(Object.create?function(c,d,p,m){m===void 0&&(m=p);var f=Object.getOwnPropertyDescriptor(d,p);(!f||("get"in f?!d.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return d[p]}}),Object.defineProperty(c,m,f)}:function(c,d,p,m){m===void 0&&(m=p),c[m]=d[p]}),n=Ie&&Ie.__exportStar||function(c,d){for(var p in c)p!=="default"&&!Object.prototype.hasOwnProperty.call(d,p)&&t(d,c,p)};Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.BrowserMessageWriter=e.BrowserMessageReader=void 0,tr.default.install();const r=Kn;n(Kn,e);class o extends r.AbstractMessageReader{constructor(d){super(),this._onData=new r.Emitter,this._messageListener=p=>{this._onData.fire(p.data)},d.addEventListener("error",p=>this.fireError(p)),d.onmessage=this._messageListener}listen(d){return this._onData.event(d)}}e.BrowserMessageReader=o;class s extends r.AbstractMessageWriter{constructor(d){super(),this.port=d,this.errorCount=0,d.addEventListener("error",p=>this.fireError(p))}write(d){try{return this.port.postMessage(d),Promise.resolve()}catch(p){return this.handleError(p,d),Promise.reject(p)}}handleError(d,p){this.errorCount++,this.fireError(d,p,this.errorCount)}end(){}}e.BrowserMessageWriter=s;function a(c,d,p,m){return p===void 0&&(p=r.NullLogger),r.ConnectionStrategy.is(m)&&(m={connectionStrategy:m}),(0,r.createMessageConnection)(c,d,p,m)}e.createMessageConnection=a}(qt),function(e){e.exports=qt}(er);var gs={},ar;(function(e){function t(n){return typeof n=="string"}e.is=t})(ar||(ar={}));var xn;(function(e){function t(n){return typeof n=="string"}e.is=t})(xn||(xn={}));var cr;(function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647;function t(n){return typeof n=="number"&&e.MIN_VALUE<=n&&n<=e.MAX_VALUE}e.is=t})(cr||(cr={}));var pn;(function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647;function t(n){return typeof n=="number"&&e.MIN_VALUE<=n&&n<=e.MAX_VALUE}e.is=t})(pn||(pn={}));var st;(function(e){function t(i,r){return i===Number.MAX_VALUE&&(i=pn.MAX_VALUE),r===Number.MAX_VALUE&&(r=pn.MAX_VALUE),{line:i,character:r}}e.create=t;function n(i){var r=i;return S.objectLiteral(r)&&S.uinteger(r.line)&&S.uinteger(r.character)}e.is=n})(st||(st={}));var qe;(function(e){function t(i,r,o,s){if(S.uinteger(i)&&S.uinteger(r)&&S.uinteger(o)&&S.uinteger(s))return{start:st.create(i,r),end:st.create(o,s)};if(st.is(i)&&st.is(r))return{start:i,end:r};throw new Error("Range#create called with invalid arguments[".concat(i,", ").concat(r,", ").concat(o,", ").concat(s,"]"))}e.create=t;function n(i){var r=i;return S.objectLiteral(r)&&st.is(r.start)&&st.is(r.end)}e.is=n})(qe||(qe={}));var yn;(function(e){function t(i,r){return{uri:i,range:r}}e.create=t;function n(i){var r=i;return S.objectLiteral(r)&&qe.is(r.range)&&(S.string(r.uri)||S.undefined(r.uri))}e.is=n})(yn||(yn={}));var ur;(function(e){function t(i,r,o,s){return{targetUri:i,targetRange:r,targetSelectionRange:o,originSelectionRange:s}}e.create=t;function n(i){var r=i;return S.objectLiteral(r)&&qe.is(r.targetRange)&&S.string(r.targetUri)&&qe.is(r.targetSelectionRange)&&(qe.is(r.originSelectionRange)||S.undefined(r.originSelectionRange))}e.is=n})(ur||(ur={}));var Bn;(function(e){function t(i,r,o,s){return{red:i,green:r,blue:o,alpha:s}}e.create=t;function n(i){var r=i;return S.objectLiteral(r)&&S.numberRange(r.red,0,1)&&S.numberRange(r.green,0,1)&&S.numberRange(r.blue,0,1)&&S.numberRange(r.alpha,0,1)}e.is=n})(Bn||(Bn={}));var dr;(function(e){function t(i,r){return{range:i,color:r}}e.create=t;function n(i){var r=i;return S.objectLiteral(r)&&qe.is(r.range)&&Bn.is(r.color)}e.is=n})(dr||(dr={}));var lr;(function(e){function t(i,r,o){return{label:i,textEdit:r,additionalTextEdits:o}}e.create=t;function n(i){var r=i;return S.objectLiteral(r)&&S.string(r.label)&&(S.undefined(r.textEdit)||mt.is(r))&&(S.undefined(r.additionalTextEdits)||S.typedArray(r.additionalTextEdits,mt.is))}e.is=n})(lr||(lr={}));var fr;(function(e){e.Comment="comment",e.Imports="imports",e.Region="region"})(fr||(fr={}));var gr;(function(e){function t(i,r,o,s,a,c){var d={startLine:i,endLine:r};return S.defined(o)&&(d.startCharacter=o),S.defined(s)&&(d.endCharacter=s),S.defined(a)&&(d.kind=a),S.defined(c)&&(d.collapsedText=c),d}e.create=t;function n(i){var r=i;return S.objectLiteral(r)&&S.uinteger(r.startLine)&&S.uinteger(r.startLine)&&(S.undefined(r.startCharacter)||S.uinteger(r.startCharacter))&&(S.undefined(r.endCharacter)||S.uinteger(r.endCharacter))&&(S.undefined(r.kind)||S.string(r.kind))}e.is=n})(gr||(gr={}));var Vn;(function(e){function t(i,r){return{location:i,message:r}}e.create=t;function n(i){var r=i;return S.defined(r)&&yn.is(r.location)&&S.string(r.message)}e.is=n})(Vn||(Vn={}));var hr;(function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4})(hr||(hr={}));var mr;(function(e){e.Unnecessary=1,e.Deprecated=2})(mr||(mr={}));var pr;(function(e){function t(n){var i=n;return S.objectLiteral(i)&&S.string(i.href)}e.is=t})(pr||(pr={}));var vn;(function(e){function t(i,r,o,s,a,c){var d={range:i,message:r};return S.defined(o)&&(d.severity=o),S.defined(s)&&(d.code=s),S.defined(a)&&(d.source=a),S.defined(c)&&(d.relatedInformation=c),d}e.create=t;function n(i){var r,o=i;return S.defined(o)&&qe.is(o.range)&&S.string(o.message)&&(S.number(o.severity)||S.undefined(o.severity))&&(S.integer(o.code)||S.string(o.code)||S.undefined(o.code))&&(S.undefined(o.codeDescription)||S.string((r=o.codeDescription)===null||r===void 0?void 0:r.href))&&(S.string(o.source)||S.undefined(o.source))&&(S.undefined(o.relatedInformation)||S.typedArray(o.relatedInformation,Vn.is))}e.is=n})(vn||(vn={}));var Mt;(function(e){function t(i,r){for(var o=[],s=2;s<arguments.length;s++)o[s-2]=arguments[s];var a={title:i,command:r};return S.defined(o)&&o.length>0&&(a.arguments=o),a}e.create=t;function n(i){var r=i;return S.defined(r)&&S.string(r.title)&&S.string(r.command)}e.is=n})(Mt||(Mt={}));var mt;(function(e){function t(o,s){return{range:o,newText:s}}e.replace=t;function n(o,s){return{range:{start:o,end:o},newText:s}}e.insert=n;function i(o){return{range:o,newText:""}}e.del=i;function r(o){var s=o;return S.objectLiteral(s)&&S.string(s.newText)&&qe.is(s.range)}e.is=r})(mt||(mt={}));var It;(function(e){function t(i,r,o){var s={label:i};return r!==void 0&&(s.needsConfirmation=r),o!==void 0&&(s.description=o),s}e.create=t;function n(i){var r=i;return S.objectLiteral(r)&&S.string(r.label)&&(S.boolean(r.needsConfirmation)||r.needsConfirmation===void 0)&&(S.string(r.description)||r.description===void 0)}e.is=n})(It||(It={}));var ze;(function(e){function t(n){var i=n;return S.string(i)}e.is=t})(ze||(ze={}));var Ct;(function(e){function t(o,s,a){return{range:o,newText:s,annotationId:a}}e.replace=t;function n(o,s,a){return{range:{start:o,end:o},newText:s,annotationId:a}}e.insert=n;function i(o,s){return{range:o,newText:"",annotationId:s}}e.del=i;function r(o){var s=o;return mt.is(s)&&(It.is(s.annotationId)||ze.is(s.annotationId))}e.is=r})(Ct||(Ct={}));var Cn;(function(e){function t(i,r){return{textDocument:i,edits:r}}e.create=t;function n(i){var r=i;return S.defined(r)&&_n.is(r.textDocument)&&Array.isArray(r.edits)}e.is=n})(Cn||(Cn={}));var Gt;(function(e){function t(i,r,o){var s={kind:"create",uri:i};return r!==void 0&&(r.overwrite!==void 0||r.ignoreIfExists!==void 0)&&(s.options=r),o!==void 0&&(s.annotationId=o),s}e.create=t;function n(i){var r=i;return r&&r.kind==="create"&&S.string(r.uri)&&(r.options===void 0||(r.options.overwrite===void 0||S.boolean(r.options.overwrite))&&(r.options.ignoreIfExists===void 0||S.boolean(r.options.ignoreIfExists)))&&(r.annotationId===void 0||ze.is(r.annotationId))}e.is=n})(Gt||(Gt={}));var Xt;(function(e){function t(i,r,o,s){var a={kind:"rename",oldUri:i,newUri:r};return o!==void 0&&(o.overwrite!==void 0||o.ignoreIfExists!==void 0)&&(a.options=o),s!==void 0&&(a.annotationId=s),a}e.create=t;function n(i){var r=i;return r&&r.kind==="rename"&&S.string(r.oldUri)&&S.string(r.newUri)&&(r.options===void 0||(r.options.overwrite===void 0||S.boolean(r.options.overwrite))&&(r.options.ignoreIfExists===void 0||S.boolean(r.options.ignoreIfExists)))&&(r.annotationId===void 0||ze.is(r.annotationId))}e.is=n})(Xt||(Xt={}));var Yt;(function(e){function t(i,r,o){var s={kind:"delete",uri:i};return r!==void 0&&(r.recursive!==void 0||r.ignoreIfNotExists!==void 0)&&(s.options=r),o!==void 0&&(s.annotationId=o),s}e.create=t;function n(i){var r=i;return r&&r.kind==="delete"&&S.string(r.uri)&&(r.options===void 0||(r.options.recursive===void 0||S.boolean(r.options.recursive))&&(r.options.ignoreIfNotExists===void 0||S.boolean(r.options.ignoreIfNotExists)))&&(r.annotationId===void 0||ze.is(r.annotationId))}e.is=n})(Yt||(Yt={}));var Jn;(function(e){function t(n){var i=n;return i&&(i.changes!==void 0||i.documentChanges!==void 0)&&(i.documentChanges===void 0||i.documentChanges.every(function(r){return S.string(r.kind)?Gt.is(r)||Xt.is(r)||Yt.is(r):Cn.is(r)}))}e.is=t})(Jn||(Jn={}));var Qn=function(){function e(t,n){this.edits=t,this.changeAnnotations=n}return e.prototype.insert=function(t,n,i){var r,o;if(i===void 0?r=mt.insert(t,n):ze.is(i)?(o=i,r=Ct.insert(t,n,i)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(i),r=Ct.insert(t,n,o)),this.edits.push(r),o!==void 0)return o},e.prototype.replace=function(t,n,i){var r,o;if(i===void 0?r=mt.replace(t,n):ze.is(i)?(o=i,r=Ct.replace(t,n,i)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(i),r=Ct.replace(t,n,o)),this.edits.push(r),o!==void 0)return o},e.prototype.delete=function(t,n){var i,r;if(n===void 0?i=mt.del(t):ze.is(n)?(r=n,i=Ct.del(t,n)):(this.assertChangeAnnotations(this.changeAnnotations),r=this.changeAnnotations.manage(n),i=Ct.del(t,r)),this.edits.push(i),r!==void 0)return r},e.prototype.add=function(t){this.edits.push(t)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e.prototype.assertChangeAnnotations=function(t){if(t===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},e}(),hs=function(){function e(t){this._annotations=t===void 0?Object.create(null):t,this._counter=0,this._size=0}return e.prototype.all=function(){return this._annotations},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),e.prototype.manage=function(t,n){var i;if(ze.is(t)?i=t:(i=this.nextId(),n=t),this._annotations[i]!==void 0)throw new Error("Id ".concat(i," is already in use."));if(n===void 0)throw new Error("No annotation provided for id ".concat(i));return this._annotations[i]=n,this._size++,i},e.prototype.nextId=function(){return this._counter++,this._counter.toString()},e}(),ac=function(){function e(t){var n=this;this._textEditChanges=Object.create(null),t!==void 0?(this._workspaceEdit=t,t.documentChanges?(this._changeAnnotations=new hs(t.changeAnnotations),t.changeAnnotations=this._changeAnnotations.all(),t.documentChanges.forEach(function(i){if(Cn.is(i)){var r=new Qn(i.edits,n._changeAnnotations);n._textEditChanges[i.textDocument.uri]=r}})):t.changes&&Object.keys(t.changes).forEach(function(i){var r=new Qn(t.changes[i]);n._textEditChanges[i]=r})):this._workspaceEdit={}}return Object.defineProperty(e.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),e.prototype.getTextEditChange=function(t){if(_n.is(t)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var n={uri:t.uri,version:t.version},i=this._textEditChanges[n.uri];if(!i){var r=[],o={textDocument:n,edits:r};this._workspaceEdit.documentChanges.push(o),i=new Qn(r,this._changeAnnotations),this._textEditChanges[n.uri]=i}return i}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var i=this._textEditChanges[t];if(!i){var r=[];this._workspaceEdit.changes[t]=r,i=new Qn(r),this._textEditChanges[t]=i}return i}},e.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new hs,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},e.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},e.prototype.createFile=function(t,n,i){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var r;It.is(n)||ze.is(n)?r=n:i=n;var o,s;if(r===void 0?o=Gt.create(t,i):(s=ze.is(r)?r:this._changeAnnotations.manage(r),o=Gt.create(t,i,s)),this._workspaceEdit.documentChanges.push(o),s!==void 0)return s},e.prototype.renameFile=function(t,n,i,r){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var o;It.is(i)||ze.is(i)?o=i:r=i;var s,a;if(o===void 0?s=Xt.create(t,n,r):(a=ze.is(o)?o:this._changeAnnotations.manage(o),s=Xt.create(t,n,r,a)),this._workspaceEdit.documentChanges.push(s),a!==void 0)return a},e.prototype.deleteFile=function(t,n,i){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var r;It.is(n)||ze.is(n)?r=n:i=n;var o,s;if(r===void 0?o=Yt.create(t,i):(s=ze.is(r)?r:this._changeAnnotations.manage(r),o=Yt.create(t,i,s)),this._workspaceEdit.documentChanges.push(o),s!==void 0)return s},e}(),yr;(function(e){function t(i){return{uri:i}}e.create=t;function n(i){var r=i;return S.defined(r)&&S.string(r.uri)}e.is=n})(yr||(yr={}));var vr;(function(e){function t(i,r){return{uri:i,version:r}}e.create=t;function n(i){var r=i;return S.defined(r)&&S.string(r.uri)&&S.integer(r.version)}e.is=n})(vr||(vr={}));var _n;(function(e){function t(i,r){return{uri:i,version:r}}e.create=t;function n(i){var r=i;return S.defined(r)&&S.string(r.uri)&&(r.version===null||S.integer(r.version))}e.is=n})(_n||(_n={}));var Cr;(function(e){function t(i,r,o,s){return{uri:i,languageId:r,version:o,text:s}}e.create=t;function n(i){var r=i;return S.defined(r)&&S.string(r.uri)&&S.string(r.languageId)&&S.integer(r.version)&&S.string(r.text)}e.is=n})(Cr||(Cr={}));var Gn;(function(e){e.PlainText="plaintext",e.Markdown="markdown";function t(n){var i=n;return i===e.PlainText||i===e.Markdown}e.is=t})(Gn||(Gn={}));var Zt;(function(e){function t(n){var i=n;return S.objectLiteral(n)&&Gn.is(i.kind)&&S.string(i.value)}e.is=t})(Zt||(Zt={}));var _r;(function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25})(_r||(_r={}));var Dr;(function(e){e.PlainText=1,e.Snippet=2})(Dr||(Dr={}));var br;(function(e){e.Deprecated=1})(br||(br={}));var wr;(function(e){function t(i,r,o){return{newText:i,insert:r,replace:o}}e.create=t;function n(i){var r=i;return r&&S.string(r.newText)&&qe.is(r.insert)&&qe.is(r.replace)}e.is=n})(wr||(wr={}));var Sr;(function(e){e.asIs=1,e.adjustIndentation=2})(Sr||(Sr={}));var Tr;(function(e){function t(n){var i=n;return i&&(S.string(i.detail)||i.detail===void 0)&&(S.string(i.description)||i.description===void 0)}e.is=t})(Tr||(Tr={}));var Rr;(function(e){function t(n){return{label:n}}e.create=t})(Rr||(Rr={}));var Pr;(function(e){function t(n,i){return{items:n||[],isIncomplete:!!i}}e.create=t})(Pr||(Pr={}));var Dn;(function(e){function t(i){return i.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}e.fromPlainText=t;function n(i){var r=i;return S.string(r)||S.objectLiteral(r)&&S.string(r.language)&&S.string(r.value)}e.is=n})(Dn||(Dn={}));var kr;(function(e){function t(n){var i=n;return!!i&&S.objectLiteral(i)&&(Zt.is(i.contents)||Dn.is(i.contents)||S.typedArray(i.contents,Dn.is))&&(n.range===void 0||qe.is(n.range))}e.is=t})(kr||(kr={}));var Fr;(function(e){function t(n,i){return i?{label:n,documentation:i}:{label:n}}e.create=t})(Fr||(Fr={}));var Er;(function(e){function t(n,i){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var s={label:n};return S.defined(i)&&(s.documentation=i),S.defined(r)?s.parameters=r:s.parameters=[],s}e.create=t})(Er||(Er={}));var Or;(function(e){e.Text=1,e.Read=2,e.Write=3})(Or||(Or={}));var qr;(function(e){function t(n,i){var r={range:n};return S.number(i)&&(r.kind=i),r}e.create=t})(qr||(qr={}));var Mr;(function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26})(Mr||(Mr={}));var Ir;(function(e){e.Deprecated=1})(Ir||(Ir={}));var Nr;(function(e){function t(n,i,r,o,s){var a={name:n,kind:i,location:{uri:o,range:r}};return s&&(a.containerName=s),a}e.create=t})(Nr||(Nr={}));var Lr;(function(e){function t(n,i,r,o){return o!==void 0?{name:n,kind:i,location:{uri:r,range:o}}:{name:n,kind:i,location:{uri:r}}}e.create=t})(Lr||(Lr={}));var jr;(function(e){function t(i,r,o,s,a,c){var d={name:i,detail:r,kind:o,range:s,selectionRange:a};return c!==void 0&&(d.children=c),d}e.create=t;function n(i){var r=i;return r&&S.string(r.name)&&S.number(r.kind)&&qe.is(r.range)&&qe.is(r.selectionRange)&&(r.detail===void 0||S.string(r.detail))&&(r.deprecated===void 0||S.boolean(r.deprecated))&&(r.children===void 0||Array.isArray(r.children))&&(r.tags===void 0||Array.isArray(r.tags))}e.is=n})(jr||(jr={}));var Ar;(function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"})(Ar||(Ar={}));var bn;(function(e){e.Invoked=1,e.Automatic=2})(bn||(bn={}));var Hr;(function(e){function t(i,r,o){var s={diagnostics:i};return r!=null&&(s.only=r),o!=null&&(s.triggerKind=o),s}e.create=t;function n(i){var r=i;return S.defined(r)&&S.typedArray(r.diagnostics,vn.is)&&(r.only===void 0||S.typedArray(r.only,S.string))&&(r.triggerKind===void 0||r.triggerKind===bn.Invoked||r.triggerKind===bn.Automatic)}e.is=n})(Hr||(Hr={}));var $r;(function(e){function t(i,r,o){var s={title:i},a=!0;return typeof r=="string"?(a=!1,s.kind=r):Mt.is(r)?s.command=r:s.edit=r,a&&o!==void 0&&(s.kind=o),s}e.create=t;function n(i){var r=i;return r&&S.string(r.title)&&(r.diagnostics===void 0||S.typedArray(r.diagnostics,vn.is))&&(r.kind===void 0||S.string(r.kind))&&(r.edit!==void 0||r.command!==void 0)&&(r.command===void 0||Mt.is(r.command))&&(r.isPreferred===void 0||S.boolean(r.isPreferred))&&(r.edit===void 0||Jn.is(r.edit))}e.is=n})($r||($r={}));var Wr;(function(e){function t(i,r){var o={range:i};return S.defined(r)&&(o.data=r),o}e.create=t;function n(i){var r=i;return S.defined(r)&&qe.is(r.range)&&(S.undefined(r.command)||Mt.is(r.command))}e.is=n})(Wr||(Wr={}));var Kr;(function(e){function t(i,r){return{tabSize:i,insertSpaces:r}}e.create=t;function n(i){var r=i;return S.defined(r)&&S.uinteger(r.tabSize)&&S.boolean(r.insertSpaces)}e.is=n})(Kr||(Kr={}));var Ur;(function(e){function t(i,r,o){return{range:i,target:r,data:o}}e.create=t;function n(i){var r=i;return S.defined(r)&&qe.is(r.range)&&(S.undefined(r.target)||S.string(r.target))}e.is=n})(Ur||(Ur={}));var zr;(function(e){function t(i,r){return{range:i,parent:r}}e.create=t;function n(i){var r=i;return S.objectLiteral(r)&&qe.is(r.range)&&(r.parent===void 0||e.is(r.parent))}e.is=n})(zr||(zr={}));var xr;(function(e){e.namespace="namespace",e.type="type",e.class="class",e.enum="enum",e.interface="interface",e.struct="struct",e.typeParameter="typeParameter",e.parameter="parameter",e.variable="variable",e.property="property",e.enumMember="enumMember",e.event="event",e.function="function",e.method="method",e.macro="macro",e.keyword="keyword",e.modifier="modifier",e.comment="comment",e.string="string",e.number="number",e.regexp="regexp",e.operator="operator",e.decorator="decorator"})(xr||(xr={}));var Br;(function(e){e.declaration="declaration",e.definition="definition",e.readonly="readonly",e.static="static",e.deprecated="deprecated",e.abstract="abstract",e.async="async",e.modification="modification",e.documentation="documentation",e.defaultLibrary="defaultLibrary"})(Br||(Br={}));var Vr;(function(e){function t(n){var i=n;return S.objectLiteral(i)&&(i.resultId===void 0||typeof i.resultId=="string")&&Array.isArray(i.data)&&(i.data.length===0||typeof i.data[0]=="number")}e.is=t})(Vr||(Vr={}));var Jr;(function(e){function t(i,r){return{range:i,text:r}}e.create=t;function n(i){var r=i;return r!=null&&qe.is(r.range)&&S.string(r.text)}e.is=n})(Jr||(Jr={}));var Qr;(function(e){function t(i,r,o){return{range:i,variableName:r,caseSensitiveLookup:o}}e.create=t;function n(i){var r=i;return r!=null&&qe.is(r.range)&&S.boolean(r.caseSensitiveLookup)&&(S.string(r.variableName)||r.variableName===void 0)}e.is=n})(Qr||(Qr={}));var Gr;(function(e){function t(i,r){return{range:i,expression:r}}e.create=t;function n(i){var r=i;return r!=null&&qe.is(r.range)&&(S.string(r.expression)||r.expression===void 0)}e.is=n})(Gr||(Gr={}));var Xr;(function(e){function t(i,r){return{frameId:i,stoppedLocation:r}}e.create=t;function n(i){var r=i;return S.defined(r)&&qe.is(i.stoppedLocation)}e.is=n})(Xr||(Xr={}));var Xn;(function(e){e.Type=1,e.Parameter=2;function t(n){return n===1||n===2}e.is=t})(Xn||(Xn={}));var Yn;(function(e){function t(i){return{value:i}}e.create=t;function n(i){var r=i;return S.objectLiteral(r)&&(r.tooltip===void 0||S.string(r.tooltip)||Zt.is(r.tooltip))&&(r.location===void 0||yn.is(r.location))&&(r.command===void 0||Mt.is(r.command))}e.is=n})(Yn||(Yn={}));var Yr;(function(e){function t(i,r,o){var s={position:i,label:r};return o!==void 0&&(s.kind=o),s}e.create=t;function n(i){var r=i;return S.objectLiteral(r)&&st.is(r.position)&&(S.string(r.label)||S.typedArray(r.label,Yn.is))&&(r.kind===void 0||Xn.is(r.kind))&&r.textEdits===void 0||S.typedArray(r.textEdits,mt.is)&&(r.tooltip===void 0||S.string(r.tooltip)||Zt.is(r.tooltip))&&(r.paddingLeft===void 0||S.boolean(r.paddingLeft))&&(r.paddingRight===void 0||S.boolean(r.paddingRight))}e.is=n})(Yr||(Yr={}));var Zr;(function(e){function t(n){var i=n;return S.objectLiteral(i)&&xn.is(i.uri)&&S.string(i.name)}e.is=t})(Zr||(Zr={}));var cc=[`
`,`\r
`,"\r"],eo;(function(e){function t(o,s,a,c){return new uc(o,s,a,c)}e.create=t;function n(o){var s=o;return!!(S.defined(s)&&S.string(s.uri)&&(S.undefined(s.languageId)||S.string(s.languageId))&&S.uinteger(s.lineCount)&&S.func(s.getText)&&S.func(s.positionAt)&&S.func(s.offsetAt))}e.is=n;function i(o,s){for(var a=o.getText(),c=r(s,function(y,E){var I=y.range.start.line-E.range.start.line;return I===0?y.range.start.character-E.range.start.character:I}),d=a.length,p=c.length-1;p>=0;p--){var m=c[p],f=o.offsetAt(m.range.start),h=o.offsetAt(m.range.end);if(h<=d)a=a.substring(0,f)+m.newText+a.substring(h,a.length);else throw new Error("Overlapping edit");d=f}return a}e.applyEdits=i;function r(o,s){if(o.length<=1)return o;var a=o.length/2|0,c=o.slice(0,a),d=o.slice(a);r(c,s),r(d,s);for(var p=0,m=0,f=0;p<c.length&&m<d.length;){var h=s(c[p],d[m]);h<=0?o[f++]=c[p++]:o[f++]=d[m++]}for(;p<c.length;)o[f++]=c[p++];for(;m<d.length;)o[f++]=d[m++];return o}})(eo||(eo={}));var uc=function(){function e(t,n,i,r){this._uri=t,this._languageId=n,this._version=i,this._content=r,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),e.prototype.getText=function(t){if(t){var n=this.offsetAt(t.start),i=this.offsetAt(t.end);return this._content.substring(n,i)}return this._content},e.prototype.update=function(t,n){this._content=t.text,this._version=n,this._lineOffsets=void 0},e.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var t=[],n=this._content,i=!0,r=0;r<n.length;r++){i&&(t.push(r),i=!1);var o=n.charAt(r);i=o==="\r"||o===`
`,o==="\r"&&r+1<n.length&&n.charAt(r+1)===`
`&&r++}i&&n.length>0&&t.push(n.length),this._lineOffsets=t}return this._lineOffsets},e.prototype.positionAt=function(t){t=Math.max(Math.min(t,this._content.length),0);var n=this.getLineOffsets(),i=0,r=n.length;if(r===0)return st.create(0,t);for(;i<r;){var o=Math.floor((i+r)/2);n[o]>t?r=o:i=o+1}var s=i-1;return st.create(s,t-n[s])},e.prototype.offsetAt=function(t){var n=this.getLineOffsets();if(t.line>=n.length)return this._content.length;if(t.line<0)return 0;var i=n[t.line],r=t.line+1<n.length?n[t.line+1]:this._content.length;return Math.max(Math.min(i+t.character,r),i)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),e}(),S;(function(e){var t=Object.prototype.toString;function n(h){return typeof h<"u"}e.defined=n;function i(h){return typeof h>"u"}e.undefined=i;function r(h){return h===!0||h===!1}e.boolean=r;function o(h){return t.call(h)==="[object String]"}e.string=o;function s(h){return t.call(h)==="[object Number]"}e.number=s;function a(h,y,E){return t.call(h)==="[object Number]"&&y<=h&&h<=E}e.numberRange=a;function c(h){return t.call(h)==="[object Number]"&&-2147483648<=h&&h<=2147483647}e.integer=c;function d(h){return t.call(h)==="[object Number]"&&0<=h&&h<=2147483647}e.uinteger=d;function p(h){return t.call(h)==="[object Function]"}e.func=p;function m(h){return h!==null&&typeof h=="object"}e.objectLiteral=m;function f(h,y){return Array.isArray(h)&&h.every(y)}e.typedArray=f})(S||(S={}));var dc=Object.freeze({__proto__:null,get DocumentUri(){return ar},get URI(){return xn},get integer(){return cr},get uinteger(){return pn},get Position(){return st},get Range(){return qe},get Location(){return yn},get LocationLink(){return ur},get Color(){return Bn},get ColorInformation(){return dr},get ColorPresentation(){return lr},get FoldingRangeKind(){return fr},get FoldingRange(){return gr},get DiagnosticRelatedInformation(){return Vn},get DiagnosticSeverity(){return hr},get DiagnosticTag(){return mr},get CodeDescription(){return pr},get Diagnostic(){return vn},get Command(){return Mt},get TextEdit(){return mt},get ChangeAnnotation(){return It},get ChangeAnnotationIdentifier(){return ze},get AnnotatedTextEdit(){return Ct},get TextDocumentEdit(){return Cn},get CreateFile(){return Gt},get RenameFile(){return Xt},get DeleteFile(){return Yt},get WorkspaceEdit(){return Jn},WorkspaceChange:ac,get TextDocumentIdentifier(){return yr},get VersionedTextDocumentIdentifier(){return vr},get OptionalVersionedTextDocumentIdentifier(){return _n},get TextDocumentItem(){return Cr},get MarkupKind(){return Gn},get MarkupContent(){return Zt},get CompletionItemKind(){return _r},get InsertTextFormat(){return Dr},get CompletionItemTag(){return br},get InsertReplaceEdit(){return wr},get InsertTextMode(){return Sr},get CompletionItemLabelDetails(){return Tr},get CompletionItem(){return Rr},get CompletionList(){return Pr},get MarkedString(){return Dn},get Hover(){return kr},get ParameterInformation(){return Fr},get SignatureInformation(){return Er},get DocumentHighlightKind(){return Or},get DocumentHighlight(){return qr},get SymbolKind(){return Mr},get SymbolTag(){return Ir},get SymbolInformation(){return Nr},get WorkspaceSymbol(){return Lr},get DocumentSymbol(){return jr},get CodeActionKind(){return Ar},get CodeActionTriggerKind(){return bn},get CodeActionContext(){return Hr},get CodeAction(){return $r},get CodeLens(){return Wr},get FormattingOptions(){return Kr},get DocumentLink(){return Ur},get SelectionRange(){return zr},get SemanticTokenTypes(){return xr},get SemanticTokenModifiers(){return Br},get SemanticTokens(){return Vr},get InlineValueText(){return Jr},get InlineValueVariableLookup(){return Qr},get InlineValueEvaluatableExpression(){return Gr},get InlineValueContext(){return Xr},get InlayHintKind(){return Xn},get InlayHintLabelPart(){return Yn},get InlayHint(){return Yr},get WorkspaceFolder(){return Zr},EOL:cc,get TextDocument(){return eo}}),to=Na(dc),Fe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProtocolNotificationType=e.ProtocolNotificationType0=e.ProtocolRequestType=e.ProtocolRequestType0=e.RegistrationType=e.MessageDirection=void 0;const t=qt;(function(a){a.clientToServer="clientToServer",a.serverToClient="serverToClient",a.both="both"})(e.MessageDirection||(e.MessageDirection={}));class n{constructor(c){this.method=c}}e.RegistrationType=n;class i extends t.RequestType0{constructor(c){super(c)}}e.ProtocolRequestType0=i;class r extends t.RequestType{constructor(c){super(c,t.ParameterStructures.byName)}}e.ProtocolRequestType=r;class o extends t.NotificationType0{constructor(c){super(c)}}e.ProtocolNotificationType0=o;class s extends t.NotificationType{constructor(c){super(c,t.ParameterStructures.byName)}}e.ProtocolNotificationType=s})(Fe);var ms={},Me={};Object.defineProperty(Me,"__esModule",{value:!0}),Me.objectLiteral=Me.typedArray=Me.stringArray=Me.array=Me.func=Me.error=Me.number=Me.string=Me.boolean=void 0;function lc(e){return e===!0||e===!1}Me.boolean=lc;function ps(e){return typeof e=="string"||e instanceof String}Me.string=ps;function fc(e){return typeof e=="number"||e instanceof Number}Me.number=fc;function gc(e){return e instanceof Error}Me.error=gc;function hc(e){return typeof e=="function"}Me.func=hc;function ys(e){return Array.isArray(e)}Me.array=ys;function mc(e){return ys(e)&&e.every(t=>ps(t))}Me.stringArray=mc;function pc(e,t){return Array.isArray(e)&&e.every(t)}Me.typedArray=pc;function yc(e){return e!==null&&typeof e=="object"}Me.objectLiteral=yc;var vs={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ImplementationRequest=void 0;const t=Fe;(function(n){n.method="textDocument/implementation",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)})(e.ImplementationRequest||(e.ImplementationRequest={}))})(vs);var Cs={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TypeDefinitionRequest=void 0;const t=Fe;(function(n){n.method="textDocument/typeDefinition",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)})(e.TypeDefinitionRequest||(e.TypeDefinitionRequest={}))})(Cs);var _s={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DidChangeWorkspaceFoldersNotification=e.WorkspaceFoldersRequest=void 0;const t=Fe;(function(n){n.method="workspace/workspaceFolders",n.messageDirection=t.MessageDirection.serverToClient,n.type=new t.ProtocolRequestType0(n.method)})(e.WorkspaceFoldersRequest||(e.WorkspaceFoldersRequest={})),function(n){n.method="workspace/didChangeWorkspaceFolders",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolNotificationType(n.method)}(e.DidChangeWorkspaceFoldersNotification||(e.DidChangeWorkspaceFoldersNotification={}))})(_s);var Ds={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConfigurationRequest=void 0;const t=Fe;(function(n){n.method="workspace/configuration",n.messageDirection=t.MessageDirection.serverToClient,n.type=new t.ProtocolRequestType(n.method)})(e.ConfigurationRequest||(e.ConfigurationRequest={}))})(Ds);var bs={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ColorPresentationRequest=e.DocumentColorRequest=void 0;const t=Fe;(function(n){n.method="textDocument/documentColor",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)})(e.DocumentColorRequest||(e.DocumentColorRequest={})),function(n){n.method="textDocument/colorPresentation",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e.ColorPresentationRequest||(e.ColorPresentationRequest={}))})(bs);var ws={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.FoldingRangeRequest=void 0;const t=Fe;(function(n){n.method="textDocument/foldingRange",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)})(e.FoldingRangeRequest||(e.FoldingRangeRequest={}))})(ws);var Ss={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DeclarationRequest=void 0;const t=Fe;(function(n){n.method="textDocument/declaration",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)})(e.DeclarationRequest||(e.DeclarationRequest={}))})(Ss);var Ts={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionRangeRequest=void 0;const t=Fe;(function(n){n.method="textDocument/selectionRange",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)})(e.SelectionRangeRequest||(e.SelectionRangeRequest={}))})(Ts);var Rs={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WorkDoneProgressCancelNotification=e.WorkDoneProgressCreateRequest=e.WorkDoneProgress=void 0;const t=qt,n=Fe;(function(i){i.type=new t.ProgressType;function r(o){return o===i.type}i.is=r})(e.WorkDoneProgress||(e.WorkDoneProgress={})),function(i){i.method="window/workDoneProgress/create",i.messageDirection=n.MessageDirection.serverToClient,i.type=new n.ProtocolRequestType(i.method)}(e.WorkDoneProgressCreateRequest||(e.WorkDoneProgressCreateRequest={})),function(i){i.method="window/workDoneProgress/cancel",i.messageDirection=n.MessageDirection.clientToServer,i.type=new n.ProtocolNotificationType(i.method)}(e.WorkDoneProgressCancelNotification||(e.WorkDoneProgressCancelNotification={}))})(Rs);var Ps={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CallHierarchyOutgoingCallsRequest=e.CallHierarchyIncomingCallsRequest=e.CallHierarchyPrepareRequest=void 0;const t=Fe;(function(n){n.method="textDocument/prepareCallHierarchy",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)})(e.CallHierarchyPrepareRequest||(e.CallHierarchyPrepareRequest={})),function(n){n.method="callHierarchy/incomingCalls",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e.CallHierarchyIncomingCallsRequest||(e.CallHierarchyIncomingCallsRequest={})),function(n){n.method="callHierarchy/outgoingCalls",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e.CallHierarchyOutgoingCallsRequest||(e.CallHierarchyOutgoingCallsRequest={}))})(Ps);var ks={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SemanticTokensRefreshRequest=e.SemanticTokensRangeRequest=e.SemanticTokensDeltaRequest=e.SemanticTokensRequest=e.SemanticTokensRegistrationType=e.TokenFormat=void 0;const t=Fe;(function(i){i.Relative="relative"})(e.TokenFormat||(e.TokenFormat={}));var n;(function(i){i.method="textDocument/semanticTokens",i.type=new t.RegistrationType(i.method)})(n=e.SemanticTokensRegistrationType||(e.SemanticTokensRegistrationType={})),function(i){i.method="textDocument/semanticTokens/full",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method),i.registrationMethod=n.method}(e.SemanticTokensRequest||(e.SemanticTokensRequest={})),function(i){i.method="textDocument/semanticTokens/full/delta",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method),i.registrationMethod=n.method}(e.SemanticTokensDeltaRequest||(e.SemanticTokensDeltaRequest={})),function(i){i.method="textDocument/semanticTokens/range",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method),i.registrationMethod=n.method}(e.SemanticTokensRangeRequest||(e.SemanticTokensRangeRequest={})),function(i){i.method="workspace/semanticTokens/refresh",i.messageDirection=t.MessageDirection.serverToClient,i.type=new t.ProtocolRequestType0(i.method)}(e.SemanticTokensRefreshRequest||(e.SemanticTokensRefreshRequest={}))})(ks);var Fs={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ShowDocumentRequest=void 0;const t=Fe;(function(n){n.method="window/showDocument",n.messageDirection=t.MessageDirection.serverToClient,n.type=new t.ProtocolRequestType(n.method)})(e.ShowDocumentRequest||(e.ShowDocumentRequest={}))})(Fs);var Es={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LinkedEditingRangeRequest=void 0;const t=Fe;(function(n){n.method="textDocument/linkedEditingRange",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)})(e.LinkedEditingRangeRequest||(e.LinkedEditingRangeRequest={}))})(Es);var Os={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WillDeleteFilesRequest=e.DidDeleteFilesNotification=e.DidRenameFilesNotification=e.WillRenameFilesRequest=e.DidCreateFilesNotification=e.WillCreateFilesRequest=e.FileOperationPatternKind=void 0;const t=Fe;(function(n){n.file="file",n.folder="folder"})(e.FileOperationPatternKind||(e.FileOperationPatternKind={})),function(n){n.method="workspace/willCreateFiles",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e.WillCreateFilesRequest||(e.WillCreateFilesRequest={})),function(n){n.method="workspace/didCreateFiles",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolNotificationType(n.method)}(e.DidCreateFilesNotification||(e.DidCreateFilesNotification={})),function(n){n.method="workspace/willRenameFiles",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e.WillRenameFilesRequest||(e.WillRenameFilesRequest={})),function(n){n.method="workspace/didRenameFiles",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolNotificationType(n.method)}(e.DidRenameFilesNotification||(e.DidRenameFilesNotification={})),function(n){n.method="workspace/didDeleteFiles",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolNotificationType(n.method)}(e.DidDeleteFilesNotification||(e.DidDeleteFilesNotification={})),function(n){n.method="workspace/willDeleteFiles",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e.WillDeleteFilesRequest||(e.WillDeleteFilesRequest={}))})(Os);var qs={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MonikerRequest=e.MonikerKind=e.UniquenessLevel=void 0;const t=Fe;(function(n){n.document="document",n.project="project",n.group="group",n.scheme="scheme",n.global="global"})(e.UniquenessLevel||(e.UniquenessLevel={})),function(n){n.$import="import",n.$export="export",n.local="local"}(e.MonikerKind||(e.MonikerKind={})),function(n){n.method="textDocument/moniker",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e.MonikerRequest||(e.MonikerRequest={}))})(qs);var Ms={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TypeHierarchySubtypesRequest=e.TypeHierarchySupertypesRequest=e.TypeHierarchyPrepareRequest=void 0;const t=Fe;(function(n){n.method="textDocument/prepareTypeHierarchy",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)})(e.TypeHierarchyPrepareRequest||(e.TypeHierarchyPrepareRequest={})),function(n){n.method="typeHierarchy/supertypes",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e.TypeHierarchySupertypesRequest||(e.TypeHierarchySupertypesRequest={})),function(n){n.method="typeHierarchy/subtypes",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e.TypeHierarchySubtypesRequest||(e.TypeHierarchySubtypesRequest={}))})(Ms);var Is={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.InlineValueRefreshRequest=e.InlineValueRequest=void 0;const t=Fe;(function(n){n.method="textDocument/inlineValue",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)})(e.InlineValueRequest||(e.InlineValueRequest={})),function(n){n.method="workspace/inlineValue/refresh",n.messageDirection=t.MessageDirection.serverToClient,n.type=new t.ProtocolRequestType0(n.method)}(e.InlineValueRefreshRequest||(e.InlineValueRefreshRequest={}))})(Is);var Ns={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.InlayHintRefreshRequest=e.InlayHintResolveRequest=e.InlayHintRequest=void 0;const t=Fe;(function(n){n.method="textDocument/inlayHint",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)})(e.InlayHintRequest||(e.InlayHintRequest={})),function(n){n.method="inlayHint/resolve",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e.InlayHintResolveRequest||(e.InlayHintResolveRequest={})),function(n){n.method="workspace/inlayHint/refresh",n.messageDirection=t.MessageDirection.serverToClient,n.type=new t.ProtocolRequestType0(n.method)}(e.InlayHintRefreshRequest||(e.InlayHintRefreshRequest={}))})(Ns);var Ls={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DiagnosticRefreshRequest=e.WorkspaceDiagnosticRequest=e.DocumentDiagnosticRequest=e.DocumentDiagnosticReportKind=e.DiagnosticServerCancellationData=void 0;const t=qt,n=Me,i=Fe;(function(r){function o(s){const a=s;return a&&n.boolean(a.retriggerRequest)}r.is=o})(e.DiagnosticServerCancellationData||(e.DiagnosticServerCancellationData={})),function(r){r.Full="full",r.Unchanged="unchanged"}(e.DocumentDiagnosticReportKind||(e.DocumentDiagnosticReportKind={})),function(r){r.method="textDocument/diagnostic",r.messageDirection=i.MessageDirection.clientToServer,r.type=new i.ProtocolRequestType(r.method),r.partialResult=new t.ProgressType}(e.DocumentDiagnosticRequest||(e.DocumentDiagnosticRequest={})),function(r){r.method="workspace/diagnostic",r.messageDirection=i.MessageDirection.clientToServer,r.type=new i.ProtocolRequestType(r.method),r.partialResult=new t.ProgressType}(e.WorkspaceDiagnosticRequest||(e.WorkspaceDiagnosticRequest={})),function(r){r.method="workspace/diagnostic/refresh",r.messageDirection=i.MessageDirection.serverToClient,r.type=new i.ProtocolRequestType0(r.method)}(e.DiagnosticRefreshRequest||(e.DiagnosticRefreshRequest={}))})(Ls);var js={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DidCloseNotebookDocumentNotification=e.DidSaveNotebookDocumentNotification=e.DidChangeNotebookDocumentNotification=e.NotebookCellArrayChange=e.DidOpenNotebookDocumentNotification=e.NotebookDocumentSyncRegistrationType=e.NotebookDocument=e.NotebookCell=e.ExecutionSummary=e.NotebookCellKind=void 0;const t=to,n=Me,i=Fe;var r;(function(c){c.Markup=1,c.Code=2;function d(p){return p===1||p===2}c.is=d})(r=e.NotebookCellKind||(e.NotebookCellKind={}));var o;(function(c){function d(f,h){const y={executionOrder:f};return(h===!0||h===!1)&&(y.success=h),y}c.create=d;function p(f){const h=f;return n.objectLiteral(h)&&t.uinteger.is(h.executionOrder)&&(h.success===void 0||n.boolean(h.success))}c.is=p;function m(f,h){return f===h?!0:f==null||h===null||h===void 0?!1:f.executionOrder===h.executionOrder&&f.success===h.success}c.equals=m})(o=e.ExecutionSummary||(e.ExecutionSummary={}));var s;(function(c){function d(h,y){return{kind:h,document:y}}c.create=d;function p(h){const y=h;return n.objectLiteral(y)&&r.is(y.kind)&&t.DocumentUri.is(y.document)&&(y.metadata===void 0||n.objectLiteral(y.metadata))}c.is=p;function m(h,y){const E=new Set;return h.document!==y.document&&E.add("document"),h.kind!==y.kind&&E.add("kind"),h.executionSummary!==y.executionSummary&&E.add("executionSummary"),(h.metadata!==void 0||y.metadata!==void 0)&&!f(h.metadata,y.metadata)&&E.add("metadata"),(h.executionSummary!==void 0||y.executionSummary!==void 0)&&!o.equals(h.executionSummary,y.executionSummary)&&E.add("executionSummary"),E}c.diff=m;function f(h,y){if(h===y)return!0;if(h==null||y===null||y===void 0||typeof h!=typeof y||typeof h!="object")return!1;const E=Array.isArray(h),I=Array.isArray(y);if(E!==I)return!1;if(E&&I){if(h.length!==y.length)return!1;for(let J=0;J<h.length;J++)if(!f(h[J],y[J]))return!1}if(n.objectLiteral(h)&&n.objectLiteral(y)){const J=Object.keys(h),B=Object.keys(y);if(J.length!==B.length||(J.sort(),B.sort(),!f(J,B)))return!1;for(let w=0;w<J.length;w++){const k=J[w];if(!f(h[k],y[k]))return!1}}return!0}})(s=e.NotebookCell||(e.NotebookCell={})),function(c){function d(m,f,h,y){return{uri:m,notebookType:f,version:h,cells:y}}c.create=d;function p(m){const f=m;return n.objectLiteral(f)&&n.string(f.uri)&&t.integer.is(f.version)&&n.typedArray(f.cells,s.is)}c.is=p}(e.NotebookDocument||(e.NotebookDocument={}));var a;(function(c){c.method="notebookDocument/sync",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.RegistrationType(c.method)})(a=e.NotebookDocumentSyncRegistrationType||(e.NotebookDocumentSyncRegistrationType={})),function(c){c.method="notebookDocument/didOpen",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolNotificationType(c.method),c.registrationMethod=a.method}(e.DidOpenNotebookDocumentNotification||(e.DidOpenNotebookDocumentNotification={})),function(c){function d(m){const f=m;return n.objectLiteral(f)&&t.uinteger.is(f.start)&&t.uinteger.is(f.deleteCount)&&(f.cells===void 0||n.typedArray(f.cells,s.is))}c.is=d;function p(m,f,h){const y={start:m,deleteCount:f};return h!==void 0&&(y.cells=h),y}c.create=p}(e.NotebookCellArrayChange||(e.NotebookCellArrayChange={})),function(c){c.method="notebookDocument/didChange",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolNotificationType(c.method),c.registrationMethod=a.method}(e.DidChangeNotebookDocumentNotification||(e.DidChangeNotebookDocumentNotification={})),function(c){c.method="notebookDocument/didSave",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolNotificationType(c.method),c.registrationMethod=a.method}(e.DidSaveNotebookDocumentNotification||(e.DidSaveNotebookDocumentNotification={})),function(c){c.method="notebookDocument/didClose",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolNotificationType(c.method),c.registrationMethod=a.method}(e.DidCloseNotebookDocumentNotification||(e.DidCloseNotebookDocumentNotification={}))})(js),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WorkspaceSymbolRequest=e.CodeActionResolveRequest=e.CodeActionRequest=e.DocumentSymbolRequest=e.DocumentHighlightRequest=e.ReferencesRequest=e.DefinitionRequest=e.SignatureHelpRequest=e.SignatureHelpTriggerKind=e.HoverRequest=e.CompletionResolveRequest=e.CompletionRequest=e.CompletionTriggerKind=e.PublishDiagnosticsNotification=e.WatchKind=e.RelativePattern=e.FileChangeType=e.DidChangeWatchedFilesNotification=e.WillSaveTextDocumentWaitUntilRequest=e.WillSaveTextDocumentNotification=e.TextDocumentSaveReason=e.DidSaveTextDocumentNotification=e.DidCloseTextDocumentNotification=e.DidChangeTextDocumentNotification=e.TextDocumentContentChangeEvent=e.DidOpenTextDocumentNotification=e.TextDocumentSyncKind=e.TelemetryEventNotification=e.LogMessageNotification=e.ShowMessageRequest=e.ShowMessageNotification=e.MessageType=e.DidChangeConfigurationNotification=e.ExitNotification=e.ShutdownRequest=e.InitializedNotification=e.InitializeErrorCodes=e.InitializeRequest=e.WorkDoneProgressOptions=e.TextDocumentRegistrationOptions=e.StaticRegistrationOptions=e.PositionEncodingKind=e.FailureHandlingKind=e.ResourceOperationKind=e.UnregistrationRequest=e.RegistrationRequest=e.DocumentSelector=e.NotebookCellTextDocumentFilter=e.NotebookDocumentFilter=e.TextDocumentFilter=void 0,e.TypeHierarchySubtypesRequest=e.TypeHierarchyPrepareRequest=e.MonikerRequest=e.MonikerKind=e.UniquenessLevel=e.WillDeleteFilesRequest=e.DidDeleteFilesNotification=e.WillRenameFilesRequest=e.DidRenameFilesNotification=e.WillCreateFilesRequest=e.DidCreateFilesNotification=e.FileOperationPatternKind=e.LinkedEditingRangeRequest=e.ShowDocumentRequest=e.SemanticTokensRegistrationType=e.SemanticTokensRefreshRequest=e.SemanticTokensRangeRequest=e.SemanticTokensDeltaRequest=e.SemanticTokensRequest=e.TokenFormat=e.CallHierarchyPrepareRequest=e.CallHierarchyOutgoingCallsRequest=e.CallHierarchyIncomingCallsRequest=e.WorkDoneProgressCancelNotification=e.WorkDoneProgressCreateRequest=e.WorkDoneProgress=e.SelectionRangeRequest=e.DeclarationRequest=e.FoldingRangeRequest=e.ColorPresentationRequest=e.DocumentColorRequest=e.ConfigurationRequest=e.DidChangeWorkspaceFoldersNotification=e.WorkspaceFoldersRequest=e.TypeDefinitionRequest=e.ImplementationRequest=e.ApplyWorkspaceEditRequest=e.ExecuteCommandRequest=e.PrepareRenameRequest=e.RenameRequest=e.PrepareSupportDefaultBehavior=e.DocumentOnTypeFormattingRequest=e.DocumentRangeFormattingRequest=e.DocumentFormattingRequest=e.DocumentLinkResolveRequest=e.DocumentLinkRequest=e.CodeLensRefreshRequest=e.CodeLensResolveRequest=e.CodeLensRequest=e.WorkspaceSymbolResolveRequest=void 0,e.DidCloseNotebookDocumentNotification=e.DidSaveNotebookDocumentNotification=e.DidChangeNotebookDocumentNotification=e.NotebookCellArrayChange=e.DidOpenNotebookDocumentNotification=e.NotebookDocumentSyncRegistrationType=e.NotebookDocument=e.NotebookCell=e.ExecutionSummary=e.NotebookCellKind=e.DiagnosticRefreshRequest=e.WorkspaceDiagnosticRequest=e.DocumentDiagnosticRequest=e.DocumentDiagnosticReportKind=e.DiagnosticServerCancellationData=e.InlayHintRefreshRequest=e.InlayHintResolveRequest=e.InlayHintRequest=e.InlineValueRefreshRequest=e.InlineValueRequest=e.TypeHierarchySupertypesRequest=void 0;const t=Fe,n=to,i=Me,r=vs;Object.defineProperty(e,"ImplementationRequest",{enumerable:!0,get:function(){return r.ImplementationRequest}});const o=Cs;Object.defineProperty(e,"TypeDefinitionRequest",{enumerable:!0,get:function(){return o.TypeDefinitionRequest}});const s=_s;Object.defineProperty(e,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return s.WorkspaceFoldersRequest}}),Object.defineProperty(e,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return s.DidChangeWorkspaceFoldersNotification}});const a=Ds;Object.defineProperty(e,"ConfigurationRequest",{enumerable:!0,get:function(){return a.ConfigurationRequest}});const c=bs;Object.defineProperty(e,"DocumentColorRequest",{enumerable:!0,get:function(){return c.DocumentColorRequest}}),Object.defineProperty(e,"ColorPresentationRequest",{enumerable:!0,get:function(){return c.ColorPresentationRequest}});const d=ws;Object.defineProperty(e,"FoldingRangeRequest",{enumerable:!0,get:function(){return d.FoldingRangeRequest}});const p=Ss;Object.defineProperty(e,"DeclarationRequest",{enumerable:!0,get:function(){return p.DeclarationRequest}});const m=Ts;Object.defineProperty(e,"SelectionRangeRequest",{enumerable:!0,get:function(){return m.SelectionRangeRequest}});const f=Rs;Object.defineProperty(e,"WorkDoneProgress",{enumerable:!0,get:function(){return f.WorkDoneProgress}}),Object.defineProperty(e,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return f.WorkDoneProgressCreateRequest}}),Object.defineProperty(e,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return f.WorkDoneProgressCancelNotification}});const h=Ps;Object.defineProperty(e,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return h.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(e,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return h.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(e,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return h.CallHierarchyPrepareRequest}});const y=ks;Object.defineProperty(e,"TokenFormat",{enumerable:!0,get:function(){return y.TokenFormat}}),Object.defineProperty(e,"SemanticTokensRequest",{enumerable:!0,get:function(){return y.SemanticTokensRequest}}),Object.defineProperty(e,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return y.SemanticTokensDeltaRequest}}),Object.defineProperty(e,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return y.SemanticTokensRangeRequest}}),Object.defineProperty(e,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return y.SemanticTokensRefreshRequest}}),Object.defineProperty(e,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return y.SemanticTokensRegistrationType}});const E=Fs;Object.defineProperty(e,"ShowDocumentRequest",{enumerable:!0,get:function(){return E.ShowDocumentRequest}});const I=Es;Object.defineProperty(e,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return I.LinkedEditingRangeRequest}});const J=Os;Object.defineProperty(e,"FileOperationPatternKind",{enumerable:!0,get:function(){return J.FileOperationPatternKind}}),Object.defineProperty(e,"DidCreateFilesNotification",{enumerable:!0,get:function(){return J.DidCreateFilesNotification}}),Object.defineProperty(e,"WillCreateFilesRequest",{enumerable:!0,get:function(){return J.WillCreateFilesRequest}}),Object.defineProperty(e,"DidRenameFilesNotification",{enumerable:!0,get:function(){return J.DidRenameFilesNotification}}),Object.defineProperty(e,"WillRenameFilesRequest",{enumerable:!0,get:function(){return J.WillRenameFilesRequest}}),Object.defineProperty(e,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return J.DidDeleteFilesNotification}}),Object.defineProperty(e,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return J.WillDeleteFilesRequest}});const B=qs;Object.defineProperty(e,"UniquenessLevel",{enumerable:!0,get:function(){return B.UniquenessLevel}}),Object.defineProperty(e,"MonikerKind",{enumerable:!0,get:function(){return B.MonikerKind}}),Object.defineProperty(e,"MonikerRequest",{enumerable:!0,get:function(){return B.MonikerRequest}});const w=Ms;Object.defineProperty(e,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return w.TypeHierarchyPrepareRequest}}),Object.defineProperty(e,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return w.TypeHierarchySubtypesRequest}}),Object.defineProperty(e,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return w.TypeHierarchySupertypesRequest}});const k=Is;Object.defineProperty(e,"InlineValueRequest",{enumerable:!0,get:function(){return k.InlineValueRequest}}),Object.defineProperty(e,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return k.InlineValueRefreshRequest}});const L=Ns;Object.defineProperty(e,"InlayHintRequest",{enumerable:!0,get:function(){return L.InlayHintRequest}}),Object.defineProperty(e,"InlayHintResolveRequest",{enumerable:!0,get:function(){return L.InlayHintResolveRequest}}),Object.defineProperty(e,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return L.InlayHintRefreshRequest}});const z=Ls;Object.defineProperty(e,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return z.DiagnosticServerCancellationData}}),Object.defineProperty(e,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return z.DocumentDiagnosticReportKind}}),Object.defineProperty(e,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return z.DocumentDiagnosticRequest}}),Object.defineProperty(e,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return z.WorkspaceDiagnosticRequest}}),Object.defineProperty(e,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return z.DiagnosticRefreshRequest}});const A=js;Object.defineProperty(e,"NotebookCellKind",{enumerable:!0,get:function(){return A.NotebookCellKind}}),Object.defineProperty(e,"ExecutionSummary",{enumerable:!0,get:function(){return A.ExecutionSummary}}),Object.defineProperty(e,"NotebookCell",{enumerable:!0,get:function(){return A.NotebookCell}}),Object.defineProperty(e,"NotebookDocument",{enumerable:!0,get:function(){return A.NotebookDocument}}),Object.defineProperty(e,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return A.NotebookDocumentSyncRegistrationType}}),Object.defineProperty(e,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return A.DidOpenNotebookDocumentNotification}}),Object.defineProperty(e,"NotebookCellArrayChange",{enumerable:!0,get:function(){return A.NotebookCellArrayChange}}),Object.defineProperty(e,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return A.DidChangeNotebookDocumentNotification}}),Object.defineProperty(e,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return A.DidSaveNotebookDocumentNotification}}),Object.defineProperty(e,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return A.DidCloseNotebookDocumentNotification}});var U;(function(l){function T(j){const K=j;return i.string(K.language)||i.string(K.scheme)||i.string(K.pattern)}l.is=T})(U=e.TextDocumentFilter||(e.TextDocumentFilter={}));var W;(function(l){function T(j){const K=j;return i.objectLiteral(K)&&(i.string(K.notebookType)||i.string(K.scheme)||i.string(K.pattern))}l.is=T})(W=e.NotebookDocumentFilter||(e.NotebookDocumentFilter={}));var ee;(function(l){function T(j){const K=j;return i.objectLiteral(K)&&(i.string(K.notebook)||W.is(K.notebook))&&(K.language===void 0||i.string(K.language))}l.is=T})(ee=e.NotebookCellTextDocumentFilter||(e.NotebookCellTextDocumentFilter={}));var R;(function(l){function T(j){if(!Array.isArray(j))return!1;for(let K of j)if(!i.string(K)&&!U.is(K)&&!ee.is(K))return!1;return!0}l.is=T})(R=e.DocumentSelector||(e.DocumentSelector={})),function(l){l.method="client/registerCapability",l.messageDirection=t.MessageDirection.serverToClient,l.type=new t.ProtocolRequestType(l.method)}(e.RegistrationRequest||(e.RegistrationRequest={})),function(l){l.method="client/unregisterCapability",l.messageDirection=t.MessageDirection.serverToClient,l.type=new t.ProtocolRequestType(l.method)}(e.UnregistrationRequest||(e.UnregistrationRequest={})),function(l){l.Create="create",l.Rename="rename",l.Delete="delete"}(e.ResourceOperationKind||(e.ResourceOperationKind={})),function(l){l.Abort="abort",l.Transactional="transactional",l.TextOnlyTransactional="textOnlyTransactional",l.Undo="undo"}(e.FailureHandlingKind||(e.FailureHandlingKind={})),function(l){l.UTF8="utf-8",l.UTF16="utf-16",l.UTF32="utf-32"}(e.PositionEncodingKind||(e.PositionEncodingKind={})),function(l){function T(j){const K=j;return K&&i.string(K.id)&&K.id.length>0}l.hasId=T}(e.StaticRegistrationOptions||(e.StaticRegistrationOptions={})),function(l){function T(j){const K=j;return K&&(K.documentSelector===null||R.is(K.documentSelector))}l.is=T}(e.TextDocumentRegistrationOptions||(e.TextDocumentRegistrationOptions={})),function(l){function T(K){const H=K;return i.objectLiteral(H)&&(H.workDoneProgress===void 0||i.boolean(H.workDoneProgress))}l.is=T;function j(K){const H=K;return H&&i.boolean(H.workDoneProgress)}l.hasWorkDoneProgress=j}(e.WorkDoneProgressOptions||(e.WorkDoneProgressOptions={})),function(l){l.method="initialize",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.InitializeRequest||(e.InitializeRequest={})),function(l){l.unknownProtocolVersion=1}(e.InitializeErrorCodes||(e.InitializeErrorCodes={})),function(l){l.method="initialized",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolNotificationType(l.method)}(e.InitializedNotification||(e.InitializedNotification={})),function(l){l.method="shutdown",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType0(l.method)}(e.ShutdownRequest||(e.ShutdownRequest={})),function(l){l.method="exit",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolNotificationType0(l.method)}(e.ExitNotification||(e.ExitNotification={})),function(l){l.method="workspace/didChangeConfiguration",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolNotificationType(l.method)}(e.DidChangeConfigurationNotification||(e.DidChangeConfigurationNotification={})),function(l){l.Error=1,l.Warning=2,l.Info=3,l.Log=4}(e.MessageType||(e.MessageType={})),function(l){l.method="window/showMessage",l.messageDirection=t.MessageDirection.serverToClient,l.type=new t.ProtocolNotificationType(l.method)}(e.ShowMessageNotification||(e.ShowMessageNotification={})),function(l){l.method="window/showMessageRequest",l.messageDirection=t.MessageDirection.serverToClient,l.type=new t.ProtocolRequestType(l.method)}(e.ShowMessageRequest||(e.ShowMessageRequest={})),function(l){l.method="window/logMessage",l.messageDirection=t.MessageDirection.serverToClient,l.type=new t.ProtocolNotificationType(l.method)}(e.LogMessageNotification||(e.LogMessageNotification={})),function(l){l.method="telemetry/event",l.messageDirection=t.MessageDirection.serverToClient,l.type=new t.ProtocolNotificationType(l.method)}(e.TelemetryEventNotification||(e.TelemetryEventNotification={})),function(l){l.None=0,l.Full=1,l.Incremental=2}(e.TextDocumentSyncKind||(e.TextDocumentSyncKind={})),function(l){l.method="textDocument/didOpen",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolNotificationType(l.method)}(e.DidOpenTextDocumentNotification||(e.DidOpenTextDocumentNotification={})),function(l){function T(K){let H=K;return H!=null&&typeof H.text=="string"&&H.range!==void 0&&(H.rangeLength===void 0||typeof H.rangeLength=="number")}l.isIncremental=T;function j(K){let H=K;return H!=null&&typeof H.text=="string"&&H.range===void 0&&H.rangeLength===void 0}l.isFull=j}(e.TextDocumentContentChangeEvent||(e.TextDocumentContentChangeEvent={})),function(l){l.method="textDocument/didChange",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolNotificationType(l.method)}(e.DidChangeTextDocumentNotification||(e.DidChangeTextDocumentNotification={})),function(l){l.method="textDocument/didClose",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolNotificationType(l.method)}(e.DidCloseTextDocumentNotification||(e.DidCloseTextDocumentNotification={})),function(l){l.method="textDocument/didSave",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolNotificationType(l.method)}(e.DidSaveTextDocumentNotification||(e.DidSaveTextDocumentNotification={})),function(l){l.Manual=1,l.AfterDelay=2,l.FocusOut=3}(e.TextDocumentSaveReason||(e.TextDocumentSaveReason={})),function(l){l.method="textDocument/willSave",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolNotificationType(l.method)}(e.WillSaveTextDocumentNotification||(e.WillSaveTextDocumentNotification={})),function(l){l.method="textDocument/willSaveWaitUntil",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.WillSaveTextDocumentWaitUntilRequest||(e.WillSaveTextDocumentWaitUntilRequest={})),function(l){l.method="workspace/didChangeWatchedFiles",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolNotificationType(l.method)}(e.DidChangeWatchedFilesNotification||(e.DidChangeWatchedFilesNotification={})),function(l){l.Created=1,l.Changed=2,l.Deleted=3}(e.FileChangeType||(e.FileChangeType={})),function(l){function T(j){const K=j;return i.objectLiteral(K)&&(n.URI.is(K.baseUri)||n.WorkspaceFolder.is(K.baseUri))&&i.string(K.pattern)}l.is=T}(e.RelativePattern||(e.RelativePattern={})),function(l){l.Create=1,l.Change=2,l.Delete=4}(e.WatchKind||(e.WatchKind={})),function(l){l.method="textDocument/publishDiagnostics",l.messageDirection=t.MessageDirection.serverToClient,l.type=new t.ProtocolNotificationType(l.method)}(e.PublishDiagnosticsNotification||(e.PublishDiagnosticsNotification={})),function(l){l.Invoked=1,l.TriggerCharacter=2,l.TriggerForIncompleteCompletions=3}(e.CompletionTriggerKind||(e.CompletionTriggerKind={})),function(l){l.method="textDocument/completion",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.CompletionRequest||(e.CompletionRequest={})),function(l){l.method="completionItem/resolve",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.CompletionResolveRequest||(e.CompletionResolveRequest={})),function(l){l.method="textDocument/hover",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.HoverRequest||(e.HoverRequest={})),function(l){l.Invoked=1,l.TriggerCharacter=2,l.ContentChange=3}(e.SignatureHelpTriggerKind||(e.SignatureHelpTriggerKind={})),function(l){l.method="textDocument/signatureHelp",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.SignatureHelpRequest||(e.SignatureHelpRequest={})),function(l){l.method="textDocument/definition",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.DefinitionRequest||(e.DefinitionRequest={})),function(l){l.method="textDocument/references",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.ReferencesRequest||(e.ReferencesRequest={})),function(l){l.method="textDocument/documentHighlight",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.DocumentHighlightRequest||(e.DocumentHighlightRequest={})),function(l){l.method="textDocument/documentSymbol",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.DocumentSymbolRequest||(e.DocumentSymbolRequest={})),function(l){l.method="textDocument/codeAction",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.CodeActionRequest||(e.CodeActionRequest={})),function(l){l.method="codeAction/resolve",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.CodeActionResolveRequest||(e.CodeActionResolveRequest={})),function(l){l.method="workspace/symbol",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.WorkspaceSymbolRequest||(e.WorkspaceSymbolRequest={})),function(l){l.method="workspaceSymbol/resolve",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.WorkspaceSymbolResolveRequest||(e.WorkspaceSymbolResolveRequest={})),function(l){l.method="textDocument/codeLens",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.CodeLensRequest||(e.CodeLensRequest={})),function(l){l.method="codeLens/resolve",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.CodeLensResolveRequest||(e.CodeLensResolveRequest={})),function(l){l.method="workspace/codeLens/refresh",l.messageDirection=t.MessageDirection.serverToClient,l.type=new t.ProtocolRequestType0(l.method)}(e.CodeLensRefreshRequest||(e.CodeLensRefreshRequest={})),function(l){l.method="textDocument/documentLink",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.DocumentLinkRequest||(e.DocumentLinkRequest={})),function(l){l.method="documentLink/resolve",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.DocumentLinkResolveRequest||(e.DocumentLinkResolveRequest={})),function(l){l.method="textDocument/formatting",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.DocumentFormattingRequest||(e.DocumentFormattingRequest={})),function(l){l.method="textDocument/rangeFormatting",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.DocumentRangeFormattingRequest||(e.DocumentRangeFormattingRequest={})),function(l){l.method="textDocument/onTypeFormatting",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.DocumentOnTypeFormattingRequest||(e.DocumentOnTypeFormattingRequest={})),function(l){l.Identifier=1}(e.PrepareSupportDefaultBehavior||(e.PrepareSupportDefaultBehavior={})),function(l){l.method="textDocument/rename",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.RenameRequest||(e.RenameRequest={})),function(l){l.method="textDocument/prepareRename",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.PrepareRenameRequest||(e.PrepareRenameRequest={})),function(l){l.method="workspace/executeCommand",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)}(e.ExecuteCommandRequest||(e.ExecuteCommandRequest={})),function(l){l.method="workspace/applyEdit",l.messageDirection=t.MessageDirection.serverToClient,l.type=new t.ProtocolRequestType("workspace/applyEdit")}(e.ApplyWorkspaceEditRequest||(e.ApplyWorkspaceEditRequest={}))}(ms);var Zn={};Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.createProtocolConnection=void 0;const As=qt;function vc(e,t,n,i){return As.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),(0,As.createMessageConnection)(e,t,n,i)}Zn.createProtocolConnection=vc,function(e){var t=Ie&&Ie.__createBinding||(Object.create?function(r,o,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(o,s);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(r,a,c)}:function(r,o,s,a){a===void 0&&(a=s),r[a]=o[s]}),n=Ie&&Ie.__exportStar||function(r,o){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&t(o,r,s)};Object.defineProperty(e,"__esModule",{value:!0}),e.LSPErrorCodes=e.createProtocolConnection=void 0,n(qt,e),n(to,e),n(Fe,e),n(ms,e);var i=Zn;Object.defineProperty(e,"createProtocolConnection",{enumerable:!0,get:function(){return i.createProtocolConnection}}),function(r){r.lspReservedErrorRangeStart=-32899,r.RequestFailed=-32803,r.ServerCancelled=-32802,r.ContentModified=-32801,r.RequestCancelled=-32800,r.lspReservedErrorRangeEnd=-32800}(e.LSPErrorCodes||(e.LSPErrorCodes={}))}(gs),function(e){var t=Ie&&Ie.__createBinding||(Object.create?function(o,s,a,c){c===void 0&&(c=a);var d=Object.getOwnPropertyDescriptor(s,a);(!d||("get"in d?!s.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(o,c,d)}:function(o,s,a,c){c===void 0&&(c=a),o[c]=s[a]}),n=Ie&&Ie.__exportStar||function(o,s){for(var a in o)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,o,a)};Object.defineProperty(e,"__esModule",{value:!0}),e.createProtocolConnection=void 0;const i=er.exports;n(er.exports,e),n(gs,e);function r(o,s,a,c){return(0,i.createMessageConnection)(o,s,a,c)}e.createProtocolConnection=r}(oe);var ei={},We={};Object.defineProperty(We,"__esModule",{value:!0}),We.forEach=We.mapAsync=We.map=We.clearTestMode=We.setTestMode=We.Semaphore=We.Delayer=void 0;const wn=oe;class Cc{constructor(t){this.defaultDelay=t,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(t,n=this.defaultDelay){return this.task=t,n>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(i=>{this.onSuccess=i}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var i=this.task();return this.task=void 0,i})),(n>=0||this.timeout===void 0)&&(this.timeout=(0,wn.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},n>=0?n:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let t=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,t}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}}We.Delayer=Cc;class _c{constructor(t=1){if(t<=0)throw new Error("Capacity must be greater than 0");this._capacity=t,this._active=0,this._waiting=[]}lock(t){return new Promise((n,i)=>{this._waiting.push({thunk:t,resolve:n,reject:i}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,wn.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const t=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const n=t.thunk();n instanceof Promise?n.then(i=>{this._active--,t.resolve(i),this.runNext()},i=>{this._active--,t.reject(i),this.runNext()}):(this._active--,t.resolve(n),this.runNext())}catch(n){this._active--,t.reject(n),this.runNext()}}}We.Semaphore=_c;let no=!1;function Dc(){no=!0}We.setTestMode=Dc;function bc(){no=!1}We.clearTestMode=bc;const Hs=15;class io{constructor(t=Hs){this.yieldAfter=no===!0?Math.max(t,2):Math.max(t,Hs),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){const t=Date.now()-this.startTime,n=Math.max(0,this.yieldAfter-t);if(this.total+=this.counter,this.counter=0,t>=this.yieldAfter||n<=1)return this.counterInterval=1,this.total=0,!0;switch(t){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}}async function wc(e,t,n,i){if(e.length===0)return[];const r=new Array(e.length),o=new io(i?.yieldAfter);function s(c){o.start();for(let d=c;d<e.length;d++)if(r[d]=t(e[d]),o.shouldYield())return i?.yieldCallback&&i.yieldCallback(),d+1;return-1}let a=s(0);for(;a!==-1&&!(n!==void 0&&n.isCancellationRequested);)a=await new Promise(c=>{(0,wn.RAL)().timer.setImmediate(()=>{c(s(a))})});return r}We.map=wc;async function Sc(e,t,n,i){if(e.length===0)return[];const r=new Array(e.length),o=new io(i?.yieldAfter);async function s(c){o.start();for(let d=c;d<e.length;d++)if(r[d]=await t(e[d],n),o.shouldYield())return i?.yieldCallback&&i.yieldCallback(),d+1;return-1}let a=await s(0);for(;a!==-1&&!(n!==void 0&&n.isCancellationRequested);)a=await new Promise(c=>{(0,wn.RAL)().timer.setImmediate(()=>{c(s(a))})});return r}We.mapAsync=Sc;async function Tc(e,t,n,i){if(e.length===0)return;const r=new io(i?.yieldAfter);function o(a){r.start();for(let c=a;c<e.length;c++)if(t(e[c]),r.shouldYield())return i?.yieldCallback&&i.yieldCallback(),c+1;return-1}let s=o(0);for(;s!==-1&&!(n!==void 0&&n.isCancellationRequested);)s=await new Promise(a=>{(0,wn.RAL)().timer.setImmediate(()=>{a(o(s))})})}We.forEach=Tc;var ti={};Object.defineProperty(ti,"__esModule",{value:!0});const Rc=ie.default;class Pc extends Rc.CompletionItem{constructor(t){super(t)}}ti.default=Pc;var ni={};Object.defineProperty(ni,"__esModule",{value:!0});const kc=ie.default;class Fc extends kc.CodeLens{constructor(t){super(t)}}ni.default=Fc;var ii={};Object.defineProperty(ii,"__esModule",{value:!0});const Ec=ie.default;class Oc extends Ec.DocumentLink{constructor(t,n){super(t,n)}}ii.default=Oc;var ri={};Object.defineProperty(ri,"__esModule",{value:!0});const qc=ie.default;class Mc extends qc.CodeAction{constructor(t,n){super(t),this.data=n}}ri.default=Mc;var ro={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProtocolDiagnostic=e.DiagnosticCode=void 0;const t=ie.default,n=ve;(function(r){function o(s){const a=s;return a!=null&&(n.number(a.value)||n.string(a.value))&&n.string(a.target)}r.is=o})(e.DiagnosticCode||(e.DiagnosticCode={}));class i extends t.Diagnostic{constructor(o,s,a,c){super(o,s,a),this.data=c,this.hasDiagnosticCode=!1}}e.ProtocolDiagnostic=i})(ro);var oi={};Object.defineProperty(oi,"__esModule",{value:!0});const Ic=ie.default;class Nc extends Ic.CallHierarchyItem{constructor(t,n,i,r,o,s,a){super(t,n,i,r,o,s),a!==void 0&&(this.data=a)}}oi.default=Nc;var si={};Object.defineProperty(si,"__esModule",{value:!0});const Lc=ie.default;class jc extends Lc.TypeHierarchyItem{constructor(t,n,i,r,o,s,a){super(t,n,i,r,o,s),a!==void 0&&(this.data=a)}}si.default=jc;var ai={};Object.defineProperty(ai,"__esModule",{value:!0});const ci=ie.default;class Ac extends ci.SymbolInformation{constructor(t,n,i,r,o){const s=!(r instanceof ci.Uri);super(t,n,i,s?r:new ci.Location(r,new ci.Range(0,0,0,0))),this.hasRange=s,o!==void 0&&(this.data=o)}}ai.default=Ac;var ui={};Object.defineProperty(ui,"__esModule",{value:!0});const Hc=ie.default;class $c extends Hc.InlayHint{constructor(t,n,i){super(t,n,i)}}ui.default=$c,Object.defineProperty(ei,"__esModule",{value:!0}),ei.createConverter=void 0;const Le=ie.default,ae=oe,en=ve,$s=We,Wc=ti,Kc=ni,Uc=ii,zc=ri,Ws=ro,xc=oi,Bc=si,Vc=ai,Jc=ui;var oo;(function(e){function t(n){const i=n;return i&&!!i.inserting&&!!i.replacing}e.is=t})(oo||(oo={}));function Qc(e){const n=e||(g=>g.toString());function i(g){return n(g)}function r(g){return{uri:n(g.uri)}}function o(g){return{uri:n(g.uri),languageId:g.languageId,version:g.version,text:g.getText()}}function s(g){return{uri:n(g.uri),version:g.version}}function a(g){return{textDocument:o(g)}}function c(g){const F=g;return!!F.document&&!!F.contentChanges}function d(g){const F=g;return!!F.uri&&!!F.version}function p(g,F,Q){if(d(g))return{textDocument:{uri:n(g.uri),version:g.version},contentChanges:[{text:g.getText()}]};if(c(g)){const he=F,be=Q;return{textDocument:{uri:n(he),version:be},contentChanges:g.contentChanges.map(Ye=>{const Ue=Ye.range;return{range:{start:{line:Ue.start.line,character:Ue.start.character},end:{line:Ue.end.line,character:Ue.end.character}},rangeLength:Ye.rangeLength,text:Ye.text}})}}else throw Error("Unsupported text document change parameter")}function m(g){return{textDocument:r(g)}}function f(g,F=!1){let Q={textDocument:r(g)};return F&&(Q.text=g.getText()),Q}function h(g){switch(g){case Le.TextDocumentSaveReason.Manual:return ae.TextDocumentSaveReason.Manual;case Le.TextDocumentSaveReason.AfterDelay:return ae.TextDocumentSaveReason.AfterDelay;case Le.TextDocumentSaveReason.FocusOut:return ae.TextDocumentSaveReason.FocusOut}return ae.TextDocumentSaveReason.Manual}function y(g){return{textDocument:r(g.document),reason:h(g.reason)}}function E(g){return{files:g.files.map(F=>({uri:n(F)}))}}function I(g){return{files:g.files.map(F=>({oldUri:n(F.oldUri),newUri:n(F.newUri)}))}}function J(g){return{files:g.files.map(F=>({uri:n(F)}))}}function B(g){return{files:g.files.map(F=>({uri:n(F)}))}}function w(g){return{files:g.files.map(F=>({oldUri:n(F.oldUri),newUri:n(F.newUri)}))}}function k(g){return{files:g.files.map(F=>({uri:n(F)}))}}function L(g,F){return{textDocument:r(g),position:K(F)}}function z(g){switch(g){case Le.CompletionTriggerKind.TriggerCharacter:return ae.CompletionTriggerKind.TriggerCharacter;case Le.CompletionTriggerKind.TriggerForIncompleteCompletions:return ae.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return ae.CompletionTriggerKind.Invoked}}function A(g,F,Q){return{textDocument:r(g),position:K(F),context:{triggerKind:z(Q.triggerKind),triggerCharacter:Q.triggerCharacter}}}function U(g){switch(g){case Le.SignatureHelpTriggerKind.Invoke:return ae.SignatureHelpTriggerKind.Invoked;case Le.SignatureHelpTriggerKind.TriggerCharacter:return ae.SignatureHelpTriggerKind.TriggerCharacter;case Le.SignatureHelpTriggerKind.ContentChange:return ae.SignatureHelpTriggerKind.ContentChange}}function W(g){return{label:g.label}}function ee(g){return g.map(W)}function R(g){return{label:g.label,parameters:ee(g.parameters)}}function l(g){return g.map(R)}function T(g){return g===void 0?g:{signatures:l(g.signatures),activeSignature:g.activeSignature,activeParameter:g.activeParameter}}function j(g,F,Q){return{textDocument:r(g),position:K(F),context:{isRetrigger:Q.isRetrigger,triggerCharacter:Q.triggerCharacter,triggerKind:U(Q.triggerKind),activeSignatureHelp:T(Q.activeSignatureHelp)}}}function K(g){return{line:g.line,character:g.character}}function H(g){return g==null?g:{line:g.line>ae.uinteger.MAX_VALUE?ae.uinteger.MAX_VALUE:g.line,character:g.character>ae.uinteger.MAX_VALUE?ae.uinteger.MAX_VALUE:g.character}}function X(g,F){return $s.map(g,H,F)}function re(g){return g==null?g:{start:H(g.start),end:H(g.end)}}function Te(g){return g==null?g:ae.Location.create(i(g.uri),re(g.range))}function xe(g){switch(g){case Le.DiagnosticSeverity.Error:return ae.DiagnosticSeverity.Error;case Le.DiagnosticSeverity.Warning:return ae.DiagnosticSeverity.Warning;case Le.DiagnosticSeverity.Information:return ae.DiagnosticSeverity.Information;case Le.DiagnosticSeverity.Hint:return ae.DiagnosticSeverity.Hint}}function ut(g){if(!g)return;let F=[];for(let Q of g){let he=Ke(Q);he!==void 0&&F.push(he)}return F.length>0?F:void 0}function Ke(g){switch(g){case Le.DiagnosticTag.Unnecessary:return ae.DiagnosticTag.Unnecessary;case Le.DiagnosticTag.Deprecated:return ae.DiagnosticTag.Deprecated;default:return}}function Je(g){return{message:g.message,location:Te(g.location)}}function lt(g){return g.map(Je)}function ft(g){if(g!=null)return en.number(g)||en.string(g)?g:{value:g.value,target:i(g.target)}}function Qe(g){const F=ae.Diagnostic.create(re(g.range),g.message),Q=g instanceof Ws.ProtocolDiagnostic?g:void 0;Q!==void 0&&Q.data!==void 0&&(F.data=Q.data);const he=ft(g.code);return Ws.DiagnosticCode.is(he)?Q!==void 0&&Q.hasDiagnosticCode?F.code=he:(F.code=he.value,F.codeDescription={href:he.target}):F.code=he,en.number(g.severity)&&(F.severity=xe(g.severity)),Array.isArray(g.tags)&&(F.tags=ut(g.tags)),g.relatedInformation&&(F.relatedInformation=lt(g.relatedInformation)),g.source&&(F.source=g.source),F}function Ge(g,F){return g==null?g:$s.map(g,Qe,F)}function Ze(g,F){switch(g){case"$string":return F;case ae.MarkupKind.PlainText:return{kind:g,value:F};case ae.MarkupKind.Markdown:return{kind:g,value:F.value};default:return`Unsupported Markup content received. Kind is: ${g}`}}function je(g){switch(g){case Le.CompletionItemTag.Deprecated:return ae.CompletionItemTag.Deprecated}}function ue(g){if(g===void 0)return g;const F=[];for(let Q of g){const he=je(Q);he!==void 0&&F.push(he)}return F}function Be(g,F){return F!==void 0?F:g+1}function _e(g,F=!1){let Q,he;en.string(g.label)?Q=g.label:(Q=g.label.label,F&&(g.label.detail!==void 0||g.label.description!==void 0)&&(he={detail:g.label.detail,description:g.label.description}));let be={label:Q};he!==void 0&&(be.labelDetails=he);let Oe=g instanceof Wc.default?g:void 0;g.detail&&(be.detail=g.detail),g.documentation&&(!Oe||Oe.documentationFormat==="$string"?be.documentation=g.documentation:be.documentation=Ze(Oe.documentationFormat,g.documentation)),g.filterText&&(be.filterText=g.filterText),Y(be,g),en.number(g.kind)&&(be.kind=Be(g.kind,Oe&&Oe.originalItemKind)),g.sortText&&(be.sortText=g.sortText),g.additionalTextEdits&&(be.additionalTextEdits=pt(g.additionalTextEdits)),g.commitCharacters&&(be.commitCharacters=g.commitCharacters.slice()),g.command&&(be.command=te(g.command)),(g.preselect===!0||g.preselect===!1)&&(be.preselect=g.preselect);const Ye=ue(g.tags);if(Oe){if(Oe.data!==void 0&&(be.data=Oe.data),Oe.deprecated===!0||Oe.deprecated===!1){if(Oe.deprecated===!0&&Ye!==void 0&&Ye.length>0){const Ue=Ye.indexOf(Le.CompletionItemTag.Deprecated);Ue!==-1&&Ye.splice(Ue,1)}be.deprecated=Oe.deprecated}Oe.insertTextMode!==void 0&&(be.insertTextMode=Oe.insertTextMode)}return Ye!==void 0&&Ye.length>0&&(be.tags=Ye),be.insertTextMode===void 0&&g.keepWhitespace===!0&&(be.insertTextMode=ae.InsertTextMode.adjustIndentation),be}function Y(g,F){let Q=ae.InsertTextFormat.PlainText,he,be;F.textEdit?(he=F.textEdit.newText,be=F.textEdit.range):F.insertText instanceof Le.SnippetString?(Q=ae.InsertTextFormat.Snippet,he=F.insertText.value):he=F.insertText,F.range&&(be=F.range),g.insertTextFormat=Q,F.fromEdit&&he!==void 0&&be!==void 0?g.textEdit=$e(he,be):g.insertText=he}function $e(g,F){return oo.is(F)?ae.InsertReplaceEdit.create(g,re(F.inserting),re(F.replacing)):{newText:g,range:re(F)}}function gt(g){return{range:re(g.range),newText:g.newText}}function pt(g){return g==null?g:g.map(gt)}function Xe(g){return g<=Le.SymbolKind.TypeParameter?g+1:ae.SymbolKind.Property}function Z(g){return g}function _(g){return g.map(Z)}function b(g,F,Q){return{textDocument:r(g),position:K(F),context:{includeDeclaration:Q.includeDeclaration}}}async function D(g,F){let Q=ae.CodeAction.create(g.title);if(g instanceof zc.default&&g.data!==void 0&&(Q.data=g.data),g.kind!==void 0&&(Q.kind=N(g.kind)),g.diagnostics!==void 0&&(Q.diagnostics=await Ge(g.diagnostics,F)),g.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return g.command!==void 0&&(Q.command=te(g.command)),g.isPreferred!==void 0&&(Q.isPreferred=g.isPreferred),g.disabled!==void 0&&(Q.disabled={reason:g.disabled.reason}),Q}async function M(g,F){if(g==null)return g;let Q;return g.only&&en.string(g.only.value)&&(Q=[g.only.value]),ae.CodeActionContext.create(await Ge(g.diagnostics,F),Q,q(g.triggerKind))}function q(g){switch(g){case Le.CodeActionTriggerKind.Invoke:return ae.CodeActionTriggerKind.Invoked;case Le.CodeActionTriggerKind.Automatic:return ae.CodeActionTriggerKind.Automatic;default:return}}function N(g){if(g!=null)return g.value}function De(g){return g==null?g:ae.InlineValueContext.create(g.frameId,re(g.stoppedLocation))}function te(g){let F=ae.Command.create(g.title,g.command);return g.arguments&&(F.arguments=g.arguments),F}function Ae(g){let F=ae.CodeLens.create(re(g.range));return g.command&&(F.command=te(g.command)),g instanceof Kc.default&&g.data&&(F.data=g.data),F}function He(g,F){const Q={tabSize:g.tabSize,insertSpaces:g.insertSpaces};return F.trimTrailingWhitespace&&(Q.trimTrailingWhitespace=!0),F.trimFinalNewlines&&(Q.trimFinalNewlines=!0),F.insertFinalNewline&&(Q.insertFinalNewline=!0),Q}function kt(g){return{textDocument:r(g)}}function Kt(g){return{textDocument:r(g)}}function Ut(g){let F=ae.DocumentLink.create(re(g.range));g.target&&(F.target=i(g.target)),g.tooltip!==void 0&&(F.tooltip=g.tooltip);let Q=g instanceof Uc.default?g:void 0;return Q&&Q.data&&(F.data=Q.data),F}function Ft(g){return{textDocument:r(g)}}function zt(g){const F={name:g.name,kind:Xe(g.kind),uri:i(g.uri),range:re(g.range),selectionRange:re(g.selectionRange)};return g.detail!==void 0&&g.detail.length>0&&(F.detail=g.detail),g.tags!==void 0&&(F.tags=_(g.tags)),g instanceof xc.default&&g.data!==void 0&&(F.data=g.data),F}function un(g){const F={name:g.name,kind:Xe(g.kind),uri:i(g.uri),range:re(g.range),selectionRange:re(g.selectionRange)};return g.detail!==void 0&&g.detail.length>0&&(F.detail=g.detail),g.tags!==void 0&&(F.tags=_(g.tags)),g instanceof Bc.default&&g.data!==void 0&&(F.data=g.data),F}function xt(g){const F=g instanceof Vc.default?{name:g.name,kind:Xe(g.kind),location:g.hasRange?Te(g.location):{uri:n(g.location.uri)},data:g.data}:{name:g.name,kind:Xe(g.kind),location:Te(g.location)};return g.tags!==void 0&&(F.tags=_(g.tags)),g.containerName!==""&&(F.containerName=g.containerName),F}function dn(g){const F=typeof g.label=="string"?g.label:g.label.map(Bt),Q=ae.InlayHint.create(H(g.position),F);return g.kind!==void 0&&(Q.kind=g.kind),g.textEdits!==void 0&&(Q.textEdits=pt(g.textEdits)),g.tooltip!==void 0&&(Q.tooltip=Et(g.tooltip)),g.paddingLeft!==void 0&&(Q.paddingLeft=g.paddingLeft),g.paddingRight!==void 0&&(Q.paddingRight=g.paddingRight),g instanceof Jc.default&&g.data!==void 0&&(Q.data=g.data),Q}function Bt(g){const F=ae.InlayHintLabelPart.create(g.value);return g.location!==void 0&&(F.location=Te(g.location)),g.command!==void 0&&(F.command=te(g.command)),g.tooltip!==void 0&&(F.tooltip=Et(g.tooltip)),F}function Et(g){return typeof g=="string"?g:{kind:ae.MarkupKind.Markdown,value:g.value}}return{asUri:i,asTextDocumentIdentifier:r,asTextDocumentItem:o,asVersionedTextDocumentIdentifier:s,asOpenTextDocumentParams:a,asChangeTextDocumentParams:p,asCloseTextDocumentParams:m,asSaveTextDocumentParams:f,asWillSaveTextDocumentParams:y,asDidCreateFilesParams:E,asDidRenameFilesParams:I,asDidDeleteFilesParams:J,asWillCreateFilesParams:B,asWillRenameFilesParams:w,asWillDeleteFilesParams:k,asTextDocumentPositionParams:L,asCompletionParams:A,asSignatureHelpParams:j,asWorkerPosition:K,asRange:re,asPosition:H,asPositions:X,asLocation:Te,asDiagnosticSeverity:xe,asDiagnosticTag:Ke,asDiagnostic:Qe,asDiagnostics:Ge,asCompletionItem:_e,asTextEdit:gt,asSymbolKind:Xe,asSymbolTag:Z,asSymbolTags:_,asReferenceParams:b,asCodeAction:D,asCodeActionContext:M,asInlineValueContext:De,asCommand:te,asCodeLens:Ae,asFormattingOptions:He,asDocumentSymbolParams:kt,asCodeLensParams:Kt,asDocumentLink:Ut,asDocumentLinkParams:Ft,asCallHierarchyItem:zt,asTypeHierarchyItem:un,asInlayHint:dn,asWorkspaceSymbol:xt}}ei.createConverter=Qc;var di={};Object.defineProperty(di,"__esModule",{value:!0}),di.createConverter=void 0;const V=ie.default,ne=oe,at=ve,Ce=We,Gc=ti,Xc=ni,Yc=ii,Zc=ri,Ks=ro,eu=oi,tu=si,nu=ai,iu=ui,Us=oe;var li;(function(e){function t(n){let i=n;return i&&at.string(i.language)&&at.string(i.value)}e.is=t})(li||(li={}));function ru(e,t,n){const r=e||(u=>V.Uri.parse(u));function o(u){return r(u)}function s(u){const v=[];for(const P of u)if(typeof P=="string")v.push(P);else if(Us.NotebookCellTextDocumentFilter.is(P))if(typeof P.notebook=="string")v.push({notebookType:P.notebook,language:P.language});else{const $=P.notebook.notebookType??"*";v.push({notebookType:$,scheme:P.notebook.scheme,pattern:P.notebook.pattern,language:P.language})}else Us.TextDocumentFilter.is(P)&&v.push({language:P.language,scheme:P.scheme,pattern:P.pattern});return v}async function a(u,v){return Ce.map(u,d,v)}function c(u){const v=new Array(u.length);for(let P=0;P<u.length;P++)v[P]=d(u[P]);return v}function d(u){let v=new Ks.ProtocolDiagnostic(y(u.range),u.message,I(u.severity),u.data);if(u.code!==void 0){if(typeof u.code=="string"||typeof u.code=="number")ne.CodeDescription.is(u.codeDescription)?v.code={value:u.code,target:o(u.codeDescription.href)}:v.code=u.code;else if(Ks.DiagnosticCode.is(u.code)){v.hasDiagnosticCode=!0;const P=u.code;v.code={value:P.value,target:o(P.target)}}}return u.source&&(v.source=u.source),u.relatedInformation&&(v.relatedInformation=p(u.relatedInformation)),Array.isArray(u.tags)&&(v.tags=m(u.tags)),v}function p(u){const v=new Array(u.length);for(let P=0;P<u.length;P++){const $=u[P];v[P]=new V.DiagnosticRelatedInformation(Ke($.location),$.message)}return v}function m(u){if(!u)return;let v=[];for(let P of u){let $=f(P);$!==void 0&&v.push($)}return v.length>0?v:void 0}function f(u){switch(u){case ne.DiagnosticTag.Unnecessary:return V.DiagnosticTag.Unnecessary;case ne.DiagnosticTag.Deprecated:return V.DiagnosticTag.Deprecated;default:return}}function h(u){return u?new V.Position(u.line,u.character):void 0}function y(u){return u?new V.Range(u.start.line,u.start.character,u.end.line,u.end.character):void 0}async function E(u,v){return Ce.map(u,P=>new V.Range(P.start.line,P.start.character,P.end.line,P.end.character),v)}function I(u){if(u==null)return V.DiagnosticSeverity.Error;switch(u){case ne.DiagnosticSeverity.Error:return V.DiagnosticSeverity.Error;case ne.DiagnosticSeverity.Warning:return V.DiagnosticSeverity.Warning;case ne.DiagnosticSeverity.Information:return V.DiagnosticSeverity.Information;case ne.DiagnosticSeverity.Hint:return V.DiagnosticSeverity.Hint}return V.DiagnosticSeverity.Error}function J(u){if(at.string(u))return w(u);if(li.is(u))return w().appendCodeblock(u.value,u.language);if(Array.isArray(u)){let v=[];for(let P of u){let $=w();li.is(P)?$.appendCodeblock(P.value,P.language):$.appendMarkdown(P),v.push($)}return v}else return w(u)}function B(u){if(at.string(u))return u;switch(u.kind){case ne.MarkupKind.Markdown:return w(u.value);case ne.MarkupKind.PlainText:return u.value;default:return`Unsupported Markup content received. Kind is: ${u.kind}`}}function w(u){let v;if(u===void 0||typeof u=="string")v=new V.MarkdownString(u);else switch(u.kind){case ne.MarkupKind.Markdown:v=new V.MarkdownString(u.value);break;case ne.MarkupKind.PlainText:v=new V.MarkdownString,v.appendText(u.value);break;default:v=new V.MarkdownString,v.appendText(`Unsupported Markup content received. Kind is: ${u.kind}`);break}return v.isTrusted=t,v.supportHtml=n,v}function k(u){if(!!u)return new V.Hover(J(u.contents),y(u.range))}async function L(u,v,P){if(!u)return;if(Array.isArray(u))return Ce.map(u,ot=>ee(ot,v),P);const $=u,{defaultRange:fe,commitCharacters:me}=z($,v),ce=await Ce.map($.items,ot=>ee(ot,me,fe,$.itemDefaults?.insertTextMode,$.itemDefaults?.insertTextFormat,$.itemDefaults?.data),P);return new V.CompletionList(ce,$.isIncomplete)}function z(u,v){const P=u.itemDefaults?.editRange,$=u.itemDefaults?.commitCharacters??v;return ne.Range.is(P)?{defaultRange:y(P),commitCharacters:$}:P!==void 0?{defaultRange:{inserting:y(P.insert),replacing:y(P.replace)},commitCharacters:$}:{defaultRange:void 0,commitCharacters:$}}function A(u){return ne.CompletionItemKind.Text<=u&&u<=ne.CompletionItemKind.TypeParameter?[u-1,void 0]:[V.CompletionItemKind.Text,u]}function U(u){switch(u){case ne.CompletionItemTag.Deprecated:return V.CompletionItemTag.Deprecated}}function W(u){if(u==null)return[];const v=[];for(const P of u){const $=U(P);$!==void 0&&v.push($)}return v}function ee(u,v,P,$,fe,me){const ce=W(u.tags),ot=R(u),Re=new Gc.default(ot);u.detail&&(Re.detail=u.detail),u.documentation&&(Re.documentation=B(u.documentation),Re.documentationFormat=at.string(u.documentation)?"$string":u.documentation.kind),u.filterText&&(Re.filterText=u.filterText);const Wn=l(u,P,fe);if(Wn&&(Re.insertText=Wn.text,Re.range=Wn.range,Re.fromEdit=Wn.fromEdit),at.number(u.kind)){let[Ra,Zo]=A(u.kind);Re.kind=Ra,Zo&&(Re.originalItemKind=Zo)}u.sortText&&(Re.sortText=u.sortText),u.additionalTextEdits&&(Re.additionalTextEdits=H(u.additionalTextEdits));const Xo=u.commitCharacters!==void 0?at.stringArray(u.commitCharacters)?u.commitCharacters:void 0:v;Xo&&(Re.commitCharacters=Xo.slice()),u.command&&(Re.command=_(u.command)),(u.deprecated===!0||u.deprecated===!1)&&(Re.deprecated=u.deprecated,u.deprecated===!0&&ce.push(V.CompletionItemTag.Deprecated)),(u.preselect===!0||u.preselect===!1)&&(Re.preselect=u.preselect);const Yo=u.data??me;Yo!==void 0&&(Re.data=Yo),ce.length>0&&(Re.tags=ce);const Yi=u.insertTextMode??$;return Yi!==void 0&&(Re.insertTextMode=Yi,Yi===ne.InsertTextMode.asIs&&(Re.keepWhitespace=!0)),Re}function R(u){return ne.CompletionItemLabelDetails.is(u.labelDetails)?{label:u.label,detail:u.labelDetails.detail,description:u.labelDetails.description}:u.label}function l(u,v,P){const $=u.insertTextFormat??P;if(u.textEdit!==void 0||v!==void 0){const[fe,me]=u.textEdit!==void 0?T(u.textEdit):[v,u.textEditText??u.label];return $===ne.InsertTextFormat.Snippet?{text:new V.SnippetString(me),range:fe,fromEdit:!0}:{text:me,range:fe,fromEdit:!0}}else return u.insertText?$===ne.InsertTextFormat.Snippet?{text:new V.SnippetString(u.insertText),fromEdit:!1}:{text:u.insertText,fromEdit:!1}:void 0}function T(u){return ne.InsertReplaceEdit.is(u)?[{inserting:y(u.insert),replacing:y(u.replace)},u.newText]:[y(u.range),u.newText]}function j(u){if(!!u)return new V.TextEdit(y(u.range),u.newText)}async function K(u,v){if(!!u)return Ce.map(u,j,v)}function H(u){if(!u)return;const v=new Array(u.length);for(let P=0;P<u.length;P++)v[P]=j(u[P]);return v}async function X(u,v){if(!u)return;let P=new V.SignatureHelp;return at.number(u.activeSignature)?P.activeSignature=u.activeSignature:P.activeSignature=0,at.number(u.activeParameter)?P.activeParameter=u.activeParameter:P.activeParameter=0,u.signatures&&(P.signatures=await re(u.signatures,v)),P}async function re(u,v){return Ce.mapAsync(u,Te,v)}async function Te(u,v){let P=new V.SignatureInformation(u.label);return u.documentation!==void 0&&(P.documentation=B(u.documentation)),u.parameters!==void 0&&(P.parameters=await xe(u.parameters,v)),u.activeParameter!==void 0&&(P.activeParameter=u.activeParameter),P}function xe(u,v){return Ce.map(u,ut,v)}function ut(u){let v=new V.ParameterInformation(u.label);return u.documentation&&(v.documentation=B(u.documentation)),v}function Ke(u){return u?new V.Location(r(u.uri),y(u.range)):void 0}async function Je(u,v){if(!!u)return Qe(u,v)}async function lt(u,v){if(!!u)return Qe(u,v)}function ft(u){if(!u)return;let v={targetUri:r(u.targetUri),targetRange:y(u.targetRange),originSelectionRange:y(u.originSelectionRange),targetSelectionRange:y(u.targetSelectionRange)};if(!v.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return v}async function Qe(u,v){if(!!u)if(at.array(u)){if(u.length===0)return[];if(ne.LocationLink.is(u[0])){const P=u;return Ce.map(P,ft,v)}else{const P=u;return Ce.map(P,Ke,v)}}else return ne.LocationLink.is(u)?[ft(u)]:Ke(u)}async function Ge(u,v){if(!!u)return Ce.map(u,Ke,v)}async function Ze(u,v){if(!!u)return Ce.map(u,je,v)}function je(u){let v=new V.DocumentHighlight(y(u.range));return at.number(u.kind)&&(v.kind=ue(u.kind)),v}function ue(u){switch(u){case ne.DocumentHighlightKind.Text:return V.DocumentHighlightKind.Text;case ne.DocumentHighlightKind.Read:return V.DocumentHighlightKind.Read;case ne.DocumentHighlightKind.Write:return V.DocumentHighlightKind.Write}return V.DocumentHighlightKind.Text}async function Be(u,v){if(!!u)return Ce.map(u,gt,v)}function _e(u){return u<=ne.SymbolKind.TypeParameter?u-1:V.SymbolKind.Property}function Y(u){switch(u){case ne.SymbolTag.Deprecated:return V.SymbolTag.Deprecated;default:return}}function $e(u){if(u==null)return;const v=[];for(const P of u){const $=Y(P);$!==void 0&&v.push($)}return v.length===0?void 0:v}function gt(u){const v=u.data,P=u.location,$=P.range===void 0||v!==void 0?new nu.default(u.name,_e(u.kind),u.containerName??"",P.range===void 0?r(P.uri):new V.Location(r(u.location.uri),y(P.range)),v):new V.SymbolInformation(u.name,_e(u.kind),u.containerName??"",new V.Location(r(u.location.uri),y(P.range)));return Z($,u),$}async function pt(u,v){if(u!=null)return Ce.map(u,Xe,v)}function Xe(u){let v=new V.DocumentSymbol(u.name,u.detail||"",_e(u.kind),y(u.range),y(u.selectionRange));if(Z(v,u),u.children!==void 0&&u.children.length>0){let P=[];for(let $ of u.children)P.push(Xe($));v.children=P}return v}function Z(u,v){u.tags=$e(v.tags),v.deprecated&&(u.tags?u.tags.includes(V.SymbolTag.Deprecated)||(u.tags=u.tags.concat(V.SymbolTag.Deprecated)):u.tags=[V.SymbolTag.Deprecated])}function _(u){let v={title:u.title,command:u.command};return u.arguments&&(v.arguments=u.arguments),v}async function b(u,v){if(!!u)return Ce.map(u,_,v)}const D=new Map;D.set(ne.CodeActionKind.Empty,V.CodeActionKind.Empty),D.set(ne.CodeActionKind.QuickFix,V.CodeActionKind.QuickFix),D.set(ne.CodeActionKind.Refactor,V.CodeActionKind.Refactor),D.set(ne.CodeActionKind.RefactorExtract,V.CodeActionKind.RefactorExtract),D.set(ne.CodeActionKind.RefactorInline,V.CodeActionKind.RefactorInline),D.set(ne.CodeActionKind.RefactorRewrite,V.CodeActionKind.RefactorRewrite),D.set(ne.CodeActionKind.Source,V.CodeActionKind.Source),D.set(ne.CodeActionKind.SourceOrganizeImports,V.CodeActionKind.SourceOrganizeImports);function M(u){if(u==null)return;let v=D.get(u);if(v)return v;let P=u.split(".");v=V.CodeActionKind.Empty;for(let $ of P)v=v.append($);return v}function q(u){if(u!=null)return u.map(v=>M(v))}async function N(u,v){if(u==null)return;let P=new Zc.default(u.title,u.data);return u.kind!==void 0&&(P.kind=M(u.kind)),u.diagnostics!==void 0&&(P.diagnostics=c(u.diagnostics)),u.edit!==void 0&&(P.edit=await He(u.edit,v)),u.command!==void 0&&(P.command=_(u.command)),u.isPreferred!==void 0&&(P.isPreferred=u.isPreferred),u.disabled!==void 0&&(P.disabled={reason:u.disabled.reason}),P}function De(u,v){return Ce.mapAsync(u,async P=>ne.Command.is(P)?_(P):N(P,v),v)}function te(u){if(!u)return;let v=new Xc.default(y(u.range));return u.command&&(v.command=_(u.command)),u.data!==void 0&&u.data!==null&&(v.data=u.data),v}async function Ae(u,v){if(!!u)return Ce.map(u,te,v)}async function He(u,v){if(!u)return;const P=new Map;if(u.changeAnnotations!==void 0){const me=u.changeAnnotations;await Ce.forEach(Object.keys(me),ce=>{const ot=kt(me[ce]);P.set(ce,ot)},v)}const $=me=>{if(me!==void 0)return P.get(me)},fe=new V.WorkspaceEdit;if(u.documentChanges){const me=u.documentChanges;await Ce.forEach(me,ce=>{if(ne.CreateFile.is(ce))fe.createFile(r(ce.uri),ce.options,$(ce.annotationId));else if(ne.RenameFile.is(ce))fe.renameFile(r(ce.oldUri),r(ce.newUri),ce.options,$(ce.annotationId));else if(ne.DeleteFile.is(ce))fe.deleteFile(r(ce.uri),ce.options,$(ce.annotationId));else if(ne.TextDocumentEdit.is(ce)){const ot=r(ce.textDocument.uri);for(const Re of ce.edits)ne.AnnotatedTextEdit.is(Re)?fe.replace(ot,y(Re.range),Re.newText,$(Re.annotationId)):fe.replace(ot,y(Re.range),Re.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(ce,void 0,4)}`)},v)}else if(u.changes){const me=u.changes;await Ce.forEach(Object.keys(me),ce=>{fe.set(r(ce),H(me[ce]))},v)}return fe}function kt(u){if(u!==void 0)return{label:u.label,needsConfirmation:!!u.needsConfirmation,description:u.description}}function Kt(u){let v=y(u.range),P=u.target?o(u.target):void 0,$=new Yc.default(v,P);return u.tooltip!==void 0&&($.tooltip=u.tooltip),u.data!==void 0&&u.data!==null&&($.data=u.data),$}async function Ut(u,v){if(!!u)return Ce.map(u,Kt,v)}function Ft(u){return new V.Color(u.red,u.green,u.blue,u.alpha)}function zt(u){return new V.ColorInformation(y(u.range),Ft(u.color))}async function un(u,v){if(!!u)return Ce.map(u,zt,v)}function xt(u){let v=new V.ColorPresentation(u.label);return v.additionalTextEdits=H(u.additionalTextEdits),u.textEdit&&(v.textEdit=j(u.textEdit)),v}async function dn(u,v){if(!!u)return Ce.map(u,xt,v)}function Bt(u){if(u)switch(u){case ne.FoldingRangeKind.Comment:return V.FoldingRangeKind.Comment;case ne.FoldingRangeKind.Imports:return V.FoldingRangeKind.Imports;case ne.FoldingRangeKind.Region:return V.FoldingRangeKind.Region}}function Et(u){return new V.FoldingRange(u.startLine,u.endLine,Bt(u.kind))}async function g(u,v){if(!!u)return Ce.map(u,Et,v)}function F(u){return new V.SelectionRange(y(u.range),u.parent?F(u.parent):void 0)}async function Q(u,v){return Array.isArray(u)?Ce.map(u,F,v):[]}function he(u){return ne.InlineValueText.is(u)?new V.InlineValueText(y(u.range),u.text):ne.InlineValueVariableLookup.is(u)?new V.InlineValueVariableLookup(y(u.range),u.variableName,u.caseSensitiveLookup):new V.InlineValueEvaluatableExpression(y(u.range),u.expression)}async function be(u,v){return Array.isArray(u)?Ce.map(u,he,v):[]}async function Oe(u,v){const P=typeof u.label=="string"?u.label:await Ce.map(u.label,Ye,v),$=new iu.default(h(u.position),P);return u.kind!==void 0&&($.kind=u.kind),u.textEdits!==void 0&&($.textEdits=await K(u.textEdits,v)),u.tooltip!==void 0&&($.tooltip=Ue(u.tooltip)),u.paddingLeft!==void 0&&($.paddingLeft=u.paddingLeft),u.paddingRight!==void 0&&($.paddingRight=u.paddingRight),u.data!==void 0&&($.data=u.data),$}function Ye(u){const v=new V.InlayHintLabelPart(u.value);return u.location!==void 0&&(v.location=Ke(u.location)),u.tooltip!==void 0&&(v.tooltip=Ue(u.tooltip)),u.command!==void 0&&(v.command=_(u.command)),v}function Ue(u){return typeof u=="string"?u:w(u)}async function Ot(u,v){if(!!Array.isArray(u))return Ce.mapAsync(u,Oe,v)}function Vt(u){if(u===null)return;const v=new eu.default(_e(u.kind),u.name,u.detail||"",o(u.uri),y(u.range),y(u.selectionRange),u.data);return u.tags!==void 0&&(v.tags=$e(u.tags)),v}async function Xi(u,v){if(u!==null)return Ce.map(u,Vt,v)}async function St(u,v){return new V.CallHierarchyIncomingCall(Vt(u.from),await E(u.fromRanges,v))}async function Hn(u,v){if(u!==null)return Ce.mapAsync(u,St,v)}async function ln(u,v){return new V.CallHierarchyOutgoingCall(Vt(u.to),await E(u.fromRanges,v))}async function fn(u,v){if(u!==null)return Ce.mapAsync(u,ln,v)}async function $n(u,v){if(u!=null)return new V.SemanticTokens(new Uint32Array(u.data),u.resultId)}function yt(u){return new V.SemanticTokensEdit(u.start,u.deleteCount,u.data!==void 0?new Uint32Array(u.data):void 0)}async function C(u,v){if(u!=null)return new V.SemanticTokensEdits(u.edits.map(yt),u.resultId)}function O(u){return u}async function x(u,v){if(u!=null)return new V.LinkedEditingRanges(await E(u.ranges,v),G(u.wordPattern))}function G(u){if(u!=null)return new RegExp(u)}function Se(u){if(u===null)return;let v=new tu.default(_e(u.kind),u.name,u.detail||"",o(u.uri),y(u.range),y(u.selectionRange),u.data);return u.tags!==void 0&&(v.tags=$e(u.tags)),v}async function we(u,v){if(u!==null)return Ce.map(u,Se,v)}function ke(u){if(at.string(u))return u;if(ne.RelativePattern.is(u)){if(ne.URI.is(u.baseUri))return new V.RelativePattern(o(u.baseUri),u.pattern);if(ne.WorkspaceFolder.is(u.baseUri)){const v=V.workspace.getWorkspaceFolder(o(u.baseUri.uri));return v!==void 0?new V.RelativePattern(v,u.pattern):void 0}}}return{asUri:o,asDocumentSelector:s,asDiagnostics:a,asDiagnostic:d,asRange:y,asRanges:E,asPosition:h,asDiagnosticSeverity:I,asDiagnosticTag:f,asHover:k,asCompletionResult:L,asCompletionItem:ee,asTextEdit:j,asTextEdits:K,asSignatureHelp:X,asSignatureInformations:re,asSignatureInformation:Te,asParameterInformations:xe,asParameterInformation:ut,asDeclarationResult:Je,asDefinitionResult:lt,asLocation:Ke,asReferences:Ge,asDocumentHighlights:Ze,asDocumentHighlight:je,asDocumentHighlightKind:ue,asSymbolKind:_e,asSymbolTag:Y,asSymbolTags:$e,asSymbolInformations:Be,asSymbolInformation:gt,asDocumentSymbols:pt,asDocumentSymbol:Xe,asCommand:_,asCommands:b,asCodeAction:N,asCodeActionKind:M,asCodeActionKinds:q,asCodeActionResult:De,asCodeLens:te,asCodeLenses:Ae,asWorkspaceEdit:He,asDocumentLink:Kt,asDocumentLinks:Ut,asFoldingRangeKind:Bt,asFoldingRange:Et,asFoldingRanges:g,asColor:Ft,asColorInformation:zt,asColorInformations:un,asColorPresentation:xt,asColorPresentations:dn,asSelectionRange:F,asSelectionRanges:Q,asInlineValue:he,asInlineValues:be,asInlayHint:Oe,asInlayHints:Ot,asSemanticTokensLegend:O,asSemanticTokens:$n,asSemanticTokensEdit:yt,asSemanticTokensEdits:C,asCallHierarchyItem:Vt,asCallHierarchyItems:Xi,asCallHierarchyIncomingCall:St,asCallHierarchyIncomingCalls:Hn,asCallHierarchyOutgoingCall:ln,asCallHierarchyOutgoingCalls:fn,asLinkedEditingRanges:x,asTypeHierarchyItem:Se,asTypeHierarchyItems:we,asGlobPattern:ke}}di.createConverter=ru;var pe={};Object.defineProperty(pe,"__esModule",{value:!0}),pe.generateUuid=pe.parse=pe.isUUID=pe.v4=pe.empty=void 0;class so{constructor(t){this._value=t}asHex(){return this._value}equals(t){return this.asHex()===t.asHex()}}class de extends so{constructor(){super([de._randomHex(),de._randomHex(),de._randomHex(),de._randomHex(),de._randomHex(),de._randomHex(),de._randomHex(),de._randomHex(),"-",de._randomHex(),de._randomHex(),de._randomHex(),de._randomHex(),"-","4",de._randomHex(),de._randomHex(),de._randomHex(),"-",de._oneOf(de._timeHighBits),de._randomHex(),de._randomHex(),de._randomHex(),"-",de._randomHex(),de._randomHex(),de._randomHex(),de._randomHex(),de._randomHex(),de._randomHex(),de._randomHex(),de._randomHex(),de._randomHex(),de._randomHex(),de._randomHex(),de._randomHex()].join(""))}static _oneOf(t){return t[Math.floor(t.length*Math.random())]}static _randomHex(){return de._oneOf(de._chars)}}de._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],de._timeHighBits=["8","9","a","b"],pe.empty=new so("00000000-0000-0000-0000-000000000000");function zs(){return new de}pe.v4=zs;const ou=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function xs(e){return ou.test(e)}pe.isUUID=xs;function su(e){if(!xs(e))throw new Error("invalid uuid");return new so(e)}pe.parse=su;function au(){return zs().asHex()}pe.generateUuid=au;var Sn={};Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.ProgressPart=void 0;const Bs=ie.default,Vs=oe,Js=ve;class cu{constructor(t,n,i){this._client=t,this._token=n,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(Vs.WorkDoneProgress.type,this._token,r=>{switch(r.kind){case"begin":this.begin(r);break;case"report":this.report(r);break;case"end":this.done(),i&&i(this);break}})}begin(t){this._infinite=t.percentage===void 0,this._lspProgressDisposable!==void 0&&Bs.window.withProgress({location:Bs.ProgressLocation.Window,cancellable:t.cancellable,title:t.title},async(n,i)=>{if(this._lspProgressDisposable!==void 0)return this._progress=n,this._cancellationToken=i,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(Vs.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(t),new Promise((r,o)=>{this._resolve=r,this._reject=o})})}report(t){if(this._infinite&&Js.string(t.message))this._progress!==void 0&&this._progress.report({message:t.message});else if(Js.number(t.percentage)){const n=Math.max(0,Math.min(t.percentage,100)),i=Math.max(0,n-this._reported);this._reported+=i,this._progress!==void 0&&this._progress.report({message:t.message,increment:i})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}}Sn.ProgressPart=cu;var ye={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WorkspaceFeature=e.TextDocumentLanguageFeature=e.TextDocumentEventFeature=e.DynamicDocumentFeature=e.DynamicFeature=e.StaticFeature=e.ensure=e.LSPCancellationError=void 0;const t=ie.default,n=oe,i=ve,r=pe;class o extends t.CancellationError{constructor(f){super(),this.data=f}}e.LSPCancellationError=o;function s(m,f){return m[f]===void 0&&(m[f]={}),m[f]}e.ensure=s,function(m){function f(h){const y=h;return y!=null&&i.func(y.fillClientCapabilities)&&i.func(y.initialize)&&i.func(y.getState)&&i.func(y.dispose)&&(y.fillInitializeParams===void 0||i.func(y.fillInitializeParams))}m.is=f}(e.StaticFeature||(e.StaticFeature={})),function(m){function f(h){const y=h;return y!=null&&i.func(y.fillClientCapabilities)&&i.func(y.initialize)&&i.func(y.getState)&&i.func(y.dispose)&&(y.fillInitializeParams===void 0||i.func(y.fillInitializeParams))&&i.func(y.register)&&i.func(y.unregister)&&y.registrationType!==void 0}m.is=f}(e.DynamicFeature||(e.DynamicFeature={}));class a{constructor(f){this._client=f}getState(){const f=this.getDocumentSelectors();let h=0;for(const E of f){h++;for(const I of t.workspace.textDocuments)if(t.languages.match(E,I)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}const y=h>0;return{kind:"document",id:this.registrationType.method,registrations:y,matches:!1}}}e.DynamicDocumentFeature=a;class c extends a{constructor(f,h,y,E,I,J,B){super(f),this._event=h,this._type=y,this._middleware=E,this._createParams=I,this._textDocument=J,this._selectorFilter=B,this._selectors=new Map,this._onNotificationSent=new t.EventEmitter}static textDocumentFilter(f,h){for(const y of f)if(t.languages.match(y,h)>0)return!0;return!1}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(f){!f.registerOptions.documentSelector||(this._listener||(this._listener=this._event(h=>{this.callback(h).catch(y=>{this._client.error(`Sending document notification ${this._type.method} failed.`,y)})})),this._selectors.set(f.id,this._client.protocol2CodeConverter.asDocumentSelector(f.registerOptions.documentSelector)))}async callback(f){const h=async y=>{const E=this._createParams(y);await this._client.sendNotification(this._type,E),this.notificationSent(this.getTextDocument(y),this._type,E)};if(this.matches(f)){const y=this._middleware();return y?y(f,E=>h(E)):h(f)}}matches(f){return this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(f))?!1:!this._selectorFilter||this._selectorFilter(this._selectors.values(),f)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(f,h,y){this._onNotificationSent.fire({textDocument:f,type:h,params:y})}unregister(f){this._selectors.delete(f),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(f){for(const h of this._selectors.values())if(t.languages.match(h,f)>0)return{send:y=>this.callback(y)}}}e.TextDocumentEventFeature=c;class d extends a{constructor(f,h){super(f),this._registrationType=h,this._registrations=new Map}*getDocumentSelectors(){for(const f of this._registrations.values()){const h=f.data.registerOptions.documentSelector;h!==null&&(yield this._client.protocol2CodeConverter.asDocumentSelector(h))}}get registrationType(){return this._registrationType}register(f){if(!f.registerOptions.documentSelector)return;let h=this.registerLanguageProvider(f.registerOptions,f.id);this._registrations.set(f.id,{disposable:h[0],data:f,provider:h[1]})}unregister(f){let h=this._registrations.get(f);h!==void 0&&h.disposable.dispose()}dispose(){this._registrations.forEach(f=>{f.disposable.dispose()}),this._registrations.clear()}getRegistration(f,h){if(h){if(n.TextDocumentRegistrationOptions.is(h)){const y=n.StaticRegistrationOptions.hasId(h)?h.id:r.generateUuid(),E=h.documentSelector??f;if(E)return[y,Object.assign({},h,{documentSelector:E})]}else if(i.boolean(h)&&h===!0||n.WorkDoneProgressOptions.is(h)){if(!f)return[void 0,void 0];const y=i.boolean(h)&&h===!0?{documentSelector:f}:Object.assign({},h,{documentSelector:f});return[r.generateUuid(),y]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(f,h){if(!(!f||!h))return i.boolean(h)&&h===!0?{documentSelector:f}:Object.assign({},h,{documentSelector:f})}getProvider(f){for(const h of this._registrations.values()){let y=h.data.registerOptions.documentSelector;if(y!==null&&t.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(y),f)>0)return h.provider}}getAllProviders(){const f=[];for(const h of this._registrations.values())f.push(h.provider);return f}}e.TextDocumentLanguageFeature=d;class p{constructor(f,h){this._client=f,this._registrationType=h,this._registrations=new Map}getState(){const f=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:f}}get registrationType(){return this._registrationType}register(f){const h=this.registerLanguageProvider(f.registerOptions);this._registrations.set(f.id,{disposable:h[0],provider:h[1]})}unregister(f){let h=this._registrations.get(f);h!==void 0&&h.disposable.dispose()}dispose(){this._registrations.forEach(f=>{f.disposable.dispose()}),this._registrations.clear()}getProviders(){const f=[];for(const h of this._registrations.values())f.push(h.provider);return f}}e.WorkspaceFeature=p})(ye);var ao={};const uu=typeof process=="object"&&process&&process.platform==="win32";var du=uu?{sep:"\\"}:{sep:"/"},lu=Qs;function Qs(e,t,n){e instanceof RegExp&&(e=Gs(e,n)),t instanceof RegExp&&(t=Gs(t,n));var i=Xs(e,t,n);return i&&{start:i[0],end:i[1],pre:n.slice(0,i[0]),body:n.slice(i[0]+e.length,i[1]),post:n.slice(i[1]+t.length)}}function Gs(e,t){var n=t.match(e);return n?n[0]:null}Qs.range=Xs;function Xs(e,t,n){var i,r,o,s,a,c=n.indexOf(e),d=n.indexOf(t,c+1),p=c;if(c>=0&&d>0){if(e===t)return[c,d];for(i=[],o=n.length;p>=0&&!a;)p==c?(i.push(p),c=n.indexOf(e,p+1)):i.length==1?a=[i.pop(),d]:(r=i.pop(),r<o&&(o=r,s=d),d=n.indexOf(t,p+1)),p=c<d&&c>=0?c:d;i.length&&(a=[o,s])}return a}var Ys=lu,fu=mu,Zs="\0SLASH"+Math.random()+"\0",ea="\0OPEN"+Math.random()+"\0",co="\0CLOSE"+Math.random()+"\0",ta="\0COMMA"+Math.random()+"\0",na="\0PERIOD"+Math.random()+"\0";function uo(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function gu(e){return e.split("\\\\").join(Zs).split("\\{").join(ea).split("\\}").join(co).split("\\,").join(ta).split("\\.").join(na)}function hu(e){return e.split(Zs).join("\\").split(ea).join("{").split(co).join("}").split(ta).join(",").split(na).join(".")}function ia(e){if(!e)return[""];var t=[],n=Ys("{","}",e);if(!n)return e.split(",");var i=n.pre,r=n.body,o=n.post,s=i.split(",");s[s.length-1]+="{"+r+"}";var a=ia(o);return o.length&&(s[s.length-1]+=a.shift(),s.push.apply(s,a)),t.push.apply(t,s),t}function mu(e){return e?(e.substr(0,2)==="{}"&&(e="\\{\\}"+e.substr(2)),Tn(gu(e),!0).map(hu)):[]}function pu(e){return"{"+e+"}"}function yu(e){return/^-?0\d/.test(e)}function vu(e,t){return e<=t}function Cu(e,t){return e>=t}function Tn(e,t){var n=[],i=Ys("{","}",e);if(!i)return[e];var r=i.pre,o=i.post.length?Tn(i.post,!1):[""];if(/\$$/.test(i.pre))for(var s=0;s<o.length;s++){var a=r+"{"+i.body+"}"+o[s];n.push(a)}else{var c=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body),d=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body),p=c||d,m=i.body.indexOf(",")>=0;if(!p&&!m)return i.post.match(/,.*\}/)?(e=i.pre+"{"+i.body+co+i.post,Tn(e)):[e];var f;if(p)f=i.body.split(/\.\./);else if(f=ia(i.body),f.length===1&&(f=Tn(f[0],!1).map(pu),f.length===1))return o.map(function(ee){return i.pre+f[0]+ee});var h;if(p){var y=uo(f[0]),E=uo(f[1]),I=Math.max(f[0].length,f[1].length),J=f.length==3?Math.abs(uo(f[2])):1,B=vu,w=E<y;w&&(J*=-1,B=Cu);var k=f.some(yu);h=[];for(var L=y;B(L,E);L+=J){var z;if(d)z=String.fromCharCode(L),z==="\\"&&(z="");else if(z=String(L),k){var A=I-z.length;if(A>0){var U=new Array(A+1).join("0");L<0?z="-"+U+z.slice(1):z=U+z}}h.push(z)}}else{h=[];for(var W=0;W<f.length;W++)h.push.apply(h,Tn(f[W],!1))}for(var W=0;W<h.length;W++)for(var s=0;s<o.length;s++){var a=r+h[W]+o[s];(!t||p||a)&&n.push(a)}}return n}const nt=fi=(e,t,n={})=>(gi(t),!n.nocomment&&t.charAt(0)==="#"?!1:new hi(t,n).match(e));var fi=nt;const lo=du;nt.sep=lo.sep;const dt=Symbol("globstar **");nt.GLOBSTAR=dt;const _u=fu,ra={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},fo="[^/]",go=fo+"*?",Du="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",bu="(?:(?!(?:\\/|^)\\.).)*?",oa=e=>e.split("").reduce((t,n)=>(t[n]=!0,t),{}),sa=oa("().*{}+?[]^$\\!"),wu=oa("[.("),aa=/\/+/;nt.filter=(e,t={})=>(n,i,r)=>nt(n,e,t);const Tt=(e,t={})=>{const n={};return Object.keys(e).forEach(i=>n[i]=e[i]),Object.keys(t).forEach(i=>n[i]=t[i]),n};nt.defaults=e=>{if(!e||typeof e!="object"||!Object.keys(e).length)return nt;const t=nt,n=(i,r,o)=>t(i,r,Tt(e,o));return n.Minimatch=class extends t.Minimatch{constructor(r,o){super(r,Tt(e,o))}},n.Minimatch.defaults=i=>t.defaults(Tt(e,i)).Minimatch,n.filter=(i,r)=>t.filter(i,Tt(e,r)),n.defaults=i=>t.defaults(Tt(e,i)),n.makeRe=(i,r)=>t.makeRe(i,Tt(e,r)),n.braceExpand=(i,r)=>t.braceExpand(i,Tt(e,r)),n.match=(i,r,o)=>t.match(i,r,Tt(e,o)),n},nt.braceExpand=(e,t)=>ca(e,t);const ca=(e,t={})=>(gi(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:_u(e)),Su=1024*64,gi=e=>{if(typeof e!="string")throw new TypeError("invalid pattern");if(e.length>Su)throw new TypeError("pattern is too long")},ho=Symbol("subparse");nt.makeRe=(e,t)=>new hi(e,t||{}).makeRe(),nt.match=(e,t,n={})=>{const i=new hi(t,n);return e=e.filter(r=>i.match(r)),i.options.nonull&&!e.length&&e.push(t),e};const Tu=e=>e.replace(/\\(.)/g,"$1"),Ru=e=>e.replace(/\\([^-\]])/g,"$1"),Pu=e=>e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),ku=e=>e.replace(/[[\]\\]/g,"\\$&");class hi{constructor(t,n){gi(t),n||(n={}),this.options=n,this.set=[],this.pattern=t,this.windowsPathsNoEscape=!!n.windowsPathsNoEscape||n.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!n.partial,this.make()}debug(){}make(){const t=this.pattern,n=this.options;if(!n.nocomment&&t.charAt(0)==="#"){this.comment=!0;return}if(!t){this.empty=!0;return}this.parseNegate();let i=this.globSet=this.braceExpand();n.debug&&(this.debug=(...r)=>console.error(...r)),this.debug(this.pattern,i),i=this.globParts=i.map(r=>r.split(aa)),this.debug(this.pattern,i),i=i.map((r,o,s)=>r.map(this.parse,this)),this.debug(this.pattern,i),i=i.filter(r=>r.indexOf(!1)===-1),this.debug(this.pattern,i),this.set=i}parseNegate(){if(this.options.nonegate)return;const t=this.pattern;let n=!1,i=0;for(let r=0;r<t.length&&t.charAt(r)==="!";r++)n=!n,i++;i&&(this.pattern=t.slice(i)),this.negate=n}matchOne(t,n,i){var r=this.options;this.debug("matchOne",{this:this,file:t,pattern:n}),this.debug("matchOne",t.length,n.length);for(var o=0,s=0,a=t.length,c=n.length;o<a&&s<c;o++,s++){this.debug("matchOne loop");var d=n[s],p=t[o];if(this.debug(n,d,p),d===!1)return!1;if(d===dt){this.debug("GLOBSTAR",[n,d,p]);var m=o,f=s+1;if(f===c){for(this.debug("** at the end");o<a;o++)if(t[o]==="."||t[o]===".."||!r.dot&&t[o].charAt(0)===".")return!1;return!0}for(;m<a;){var h=t[m];if(this.debug(`
globstar while`,t,m,n,f,h),this.matchOne(t.slice(m),n.slice(f),i))return this.debug("globstar found match!",m,a,h),!0;if(h==="."||h===".."||!r.dot&&h.charAt(0)==="."){this.debug("dot detected!",t,m,n,f);break}this.debug("globstar swallow a segment, and continue"),m++}return!!(i&&(this.debug(`
>>> no match, partial?`,t,m,n,f),m===a))}var y;if(typeof d=="string"?(y=p===d,this.debug("string match",d,p,y)):(y=p.match(d),this.debug("pattern match",d,p,y)),!y)return!1}if(o===a&&s===c)return!0;if(o===a)return i;if(s===c)return o===a-1&&t[o]==="";throw new Error("wtf?")}braceExpand(){return ca(this.pattern,this.options)}parse(t,n){gi(t);const i=this.options;if(t==="**")if(i.noglobstar)t="*";else return dt;if(t==="")return"";let r="",o=!1,s=!1;const a=[],c=[];let d,p=!1,m=-1,f=-1,h,y,E,I=t.charAt(0)===".",J=i.dot||I;const B=()=>I?"":J?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",w=A=>A.charAt(0)==="."?"":i.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",k=()=>{if(d){switch(d){case"*":r+=go,o=!0;break;case"?":r+=fo,o=!0;break;default:r+="\\"+d;break}this.debug("clearStateChar %j %j",d,r),d=!1}};for(let A=0,U;A<t.length&&(U=t.charAt(A));A++){if(this.debug("%s	%s %s %j",t,A,r,U),s){if(U==="/")return!1;sa[U]&&(r+="\\"),r+=U,s=!1;continue}switch(U){case"/":return!1;case"\\":if(p&&t.charAt(A+1)==="-"){r+=U;continue}k(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",t,A,r,U),p){this.debug("  in class"),U==="!"&&A===f+1&&(U="^"),r+=U;continue}this.debug("call clearStateChar %j",d),k(),d=U,i.noext&&k();continue;case"(":{if(p){r+="(";continue}if(!d){r+="\\(";continue}const W={type:d,start:A-1,reStart:r.length,open:ra[d].open,close:ra[d].close};this.debug(this.pattern,"	",W),a.push(W),r+=W.open,W.start===0&&W.type!=="!"&&(I=!0,r+=w(t.slice(A+1))),this.debug("plType %j %j",d,r),d=!1;continue}case")":{const W=a[a.length-1];if(p||!W){r+="\\)";continue}a.pop(),k(),o=!0,y=W,r+=y.close,y.type==="!"&&c.push(Object.assign(y,{reEnd:r.length}));continue}case"|":{const W=a[a.length-1];if(p||!W){r+="\\|";continue}k(),r+="|",W.start===0&&W.type!=="!"&&(I=!0,r+=w(t.slice(A+1)));continue}case"[":if(k(),p){r+="\\"+U;continue}p=!0,f=A,m=r.length,r+=U;continue;case"]":if(A===f+1||!p){r+="\\"+U;continue}h=t.substring(f+1,A);try{RegExp("["+ku(Ru(h))+"]"),r+=U}catch{r=r.substring(0,m)+"(?:$.)"}o=!0,p=!1;continue;default:k(),sa[U]&&!(U==="^"&&p)&&(r+="\\"),r+=U;break}}for(p&&(h=t.slice(f+1),E=this.parse(h,ho),r=r.substring(0,m)+"\\["+E[0],o=o||E[1]),y=a.pop();y;y=a.pop()){let A;A=r.slice(y.reStart+y.open.length),this.debug("setting tail",r,y),A=A.replace(/((?:\\{2}){0,64})(\\?)\|/g,(W,ee,R)=>(R||(R="\\"),ee+ee+R+"|")),this.debug(`tail=%j
   %s`,A,A,y,r);const U=y.type==="*"?go:y.type==="?"?fo:"\\"+y.type;o=!0,r=r.slice(0,y.reStart)+U+"\\("+A}k(),s&&(r+="\\\\");const L=wu[r.charAt(0)];for(let A=c.length-1;A>-1;A--){const U=c[A],W=r.slice(0,U.reStart),ee=r.slice(U.reStart,U.reEnd-8);let R=r.slice(U.reEnd);const l=r.slice(U.reEnd-8,U.reEnd)+R,T=W.split(")").length,j=W.split("(").length-T;let K=R;for(let X=0;X<j;X++)K=K.replace(/\)[+*?]?/,"");R=K;const H=R===""&&n!==ho?"(?:$|\\/)":"";r=W+ee+R+H+l}if(r!==""&&o&&(r="(?=.)"+r),L&&(r=B()+r),n===ho)return[r,o];if(i.nocase&&!o&&(o=t.toUpperCase()!==t.toLowerCase()),!o)return Tu(t);const z=i.nocase?"i":"";try{return Object.assign(new RegExp("^"+r+"$",z),{_glob:t,_src:r})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;const t=this.set;if(!t.length)return this.regexp=!1,this.regexp;const n=this.options,i=n.noglobstar?go:n.dot?Du:bu,r=n.nocase?"i":"";let o=t.map(s=>(s=s.map(a=>typeof a=="string"?Pu(a):a===dt?dt:a._src).reduce((a,c)=>(a[a.length-1]===dt&&c===dt||a.push(c),a),[]),s.forEach((a,c)=>{a!==dt||s[c-1]===dt||(c===0?s.length>1?s[c+1]="(?:\\/|"+i+"\\/)?"+s[c+1]:s[c]=i:c===s.length-1?s[c-1]+="(?:\\/|"+i+")?":(s[c-1]+="(?:\\/|\\/"+i+"\\/)"+s[c+1],s[c+1]=dt))}),s.filter(a=>a!==dt).join("/"))).join("|");o="^(?:"+o+")$",this.negate&&(o="^(?!"+o+").*$");try{this.regexp=new RegExp(o,r)}catch{this.regexp=!1}return this.regexp}match(t,n=this.partial){if(this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return t==="";if(t==="/"&&n)return!0;const i=this.options;lo.sep!=="/"&&(t=t.split(lo.sep).join("/")),t=t.split(aa),this.debug(this.pattern,"split",t);const r=this.set;this.debug(this.pattern,"set",r);let o;for(let s=t.length-1;s>=0&&(o=t[s],!o);s--);for(let s=0;s<r.length;s++){const a=r[s];let c=t;if(i.matchBase&&a.length===1&&(c=[o]),this.matchOne(c,a,n))return i.flipNegate?!0:!this.negate}return i.flipNegate?!1:this.negate}static defaults(t){return nt.defaults(t).Minimatch}}nt.Minimatch=hi,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DiagnosticFeature=e.DiagnosticPullMode=e.vsdiag=void 0;const t=fi,n=ie.default,i=oe,r=pe,o=ye;function s(B,w){return B[w]===void 0&&(B[w]={}),B[w]}var a;(function(B){(function(w){w.full="full",w.unChanged="unChanged"})(B.DocumentDiagnosticReportKind||(B.DocumentDiagnosticReportKind={}))})(a=e.vsdiag||(e.vsdiag={}));var c;(function(B){B.onType="onType",B.onSave="onSave"})(c=e.DiagnosticPullMode||(e.DiagnosticPullMode={}));var d;(function(B){B.active="open",B.reschedule="reschedule",B.outDated="drop"})(d||(d={}));class p{constructor(){this.open=new Set,this._onOpen=new n.EventEmitter,this._onClose=new n.EventEmitter,p.fillTabResources(this.open);const w=k=>{if(k.closed.length===0&&k.opened.length===0)return;const L=this.open,z=new Set;p.fillTabResources(z);const A=new Set,U=new Set(z);for(const W of L.values())z.has(W)?U.delete(W):A.add(W);if(this.open=z,A.size>0){const W=new Set;for(const ee of A)W.add(n.Uri.parse(ee));this._onClose.fire(W)}if(U.size>0){const W=new Set;for(const ee of U)W.add(n.Uri.parse(ee));this._onOpen.fire(W)}};n.window.tabGroups.onDidChangeTabs!==void 0?this.disposable=n.window.tabGroups.onDidChangeTabs(w):this.disposable={dispose:()=>{}}}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(w){return w instanceof n.Uri?n.window.activeTextEditor?.document.uri===w:n.window.activeTextEditor?.document===w}isVisible(w){const k=w instanceof n.Uri?w:w.uri;return this.open.has(k.toString())}getTabResources(){const w=new Set;return p.fillTabResources(new Set,w),w}static fillTabResources(w,k){const L=w??new Set;for(const z of n.window.tabGroups.all)for(const A of z.tabs){const U=A.input;let W;U instanceof n.TabInputText?W=U.uri:U instanceof n.TabInputTextDiff&&(W=U.modified),W!==void 0&&!L.has(W.toString())&&(L.add(W.toString()),k!==void 0&&k.add(W))}}}var m;(function(B){B[B.document=1]="document",B[B.workspace=2]="workspace"})(m||(m={}));var f;(function(B){function w(k){return k instanceof n.Uri?k.toString():k.uri.toString()}B.asKey=w})(f||(f={}));class h{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(w,k,L){const z=w===m.document?this.documentPullStates:this.workspacePullStates,[A,U,W]=k instanceof n.Uri?[k.toString(),k,L]:[k.uri.toString(),k.uri,k.version];let ee=z.get(A);return ee===void 0&&(ee={document:U,pulledVersion:W,resultId:void 0},z.set(A,ee)),ee}update(w,k,L,z){const A=w===m.document?this.documentPullStates:this.workspacePullStates,[U,W,ee,R]=k instanceof n.Uri?[k.toString(),k,L,z]:[k.uri.toString(),k.uri,k.version,L];let l=A.get(U);l===void 0?(l={document:W,pulledVersion:ee,resultId:R},A.set(U,l)):(l.pulledVersion=ee,l.resultId=R)}unTrack(w,k){const L=f.asKey(k);(w===m.document?this.documentPullStates:this.workspacePullStates).delete(L)}tracks(w,k){const L=f.asKey(k);return(w===m.document?this.documentPullStates:this.workspacePullStates).has(L)}getResultId(w,k){const L=f.asKey(k);return(w===m.document?this.documentPullStates:this.workspacePullStates).get(L)?.resultId}getAllResultIds(){const w=[];for(let[k,L]of this.workspacePullStates)this.documentPullStates.has(k)&&(L=this.documentPullStates.get(k)),L.resultId!==void 0&&w.push({uri:k,value:L.resultId});return w}}class y{constructor(w,k,L){this.client=w,this.tabs=k,this.options=L,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new n.EventEmitter,this.provider=this.createProvider(),this.diagnostics=n.languages.createDiagnosticCollection(L.identifier),this.openRequests=new Map,this.documentStates=new h,this.workspaceErrorCounter=0}knows(w,k){const L=k instanceof n.Uri?k:k.uri;return this.documentStates.tracks(w,k)||this.openRequests.has(L.toString())}forget(w,k){this.documentStates.unTrack(w,k)}pull(w,k){if(this.isDisposed)return;const L=w instanceof n.Uri?w:w.uri;this.pullAsync(w).then(()=>{k&&k()},z=>{this.client.error(`Document pull failed for text document ${L.toString()}`,z,!1)})}async pullAsync(w,k){if(this.isDisposed)return;const L=w instanceof n.Uri,z=L?w:w.uri,A=z.toString();k=L?k:w.version;const U=this.openRequests.get(A),W=L?this.documentStates.track(m.document,w,k):this.documentStates.track(m.document,w);if(U===void 0){const ee=new n.CancellationTokenSource;this.openRequests.set(A,{state:d.active,document:w,version:k,tokenSource:ee});let R,l;try{R=await this.provider.provideDiagnostics(w,W.resultId,ee.token)??{kind:a.DocumentDiagnosticReportKind.full,items:[]}}catch(T){if(T instanceof o.LSPCancellationError&&i.DiagnosticServerCancellationData.is(T.data)&&T.data.retriggerRequest===!1&&(l={state:d.outDated,document:w}),l===void 0&&T instanceof n.CancellationError)l={state:d.reschedule,document:w};else throw T}if(l=l??this.openRequests.get(A),l===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${A}`),this.diagnostics.delete(z);return}if(this.openRequests.delete(A),!this.tabs.isVisible(w)){this.documentStates.unTrack(m.document,w);return}if(l.state===d.outDated)return;R!==void 0&&(R.kind===a.DocumentDiagnosticReportKind.full&&this.diagnostics.set(z,R.items),W.pulledVersion=k,W.resultId=R.resultId),l.state===d.reschedule&&this.pull(w)}else U.state===d.active?(U.tokenSource.cancel(),this.openRequests.set(A,{state:d.reschedule,document:U.document})):U.state===d.outDated&&this.openRequests.set(A,{state:d.reschedule,document:U.document})}forgetDocument(w){const k=w instanceof n.Uri?w:w.uri,L=k.toString(),z=this.openRequests.get(L);this.options.workspaceDiagnostics?z!==void 0?this.openRequests.set(L,{state:d.reschedule,document:w}):this.pull(w,()=>{this.forget(m.document,w)}):(z!==void 0&&(z.state===d.active&&z.tokenSource.cancel(),this.openRequests.set(L,{state:d.outDated,document:w})),this.diagnostics.delete(k),this.forget(m.document,w))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,i.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},w=>{!(w instanceof o.LSPCancellationError)&&!i.DiagnosticServerCancellationData.is(w.data)&&(this.client.error("Workspace diagnostic pull failed.",w,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,i.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new n.CancellationTokenSource;const w=this.documentStates.getAllResultIds().map(k=>({uri:this.client.protocol2CodeConverter.asUri(k.uri),value:k.value}));await this.provider.provideWorkspaceDiagnostics(w,this.workspaceCancellation.token,k=>{if(!(!k||this.isDisposed))for(const L of k.items)L.kind===a.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(m.document,L.uri)||this.diagnostics.set(L.uri,L.items)),this.documentStates.update(m.workspace,L.uri,L.version??void 0,L.resultId)})}createProvider(){const w={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(k,L,z)=>{const A=(W,ee,R)=>{const l={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(W instanceof n.Uri?W:W.uri)},previousResultId:ee};return this.isDisposed===!0||!this.client.isRunning()?{kind:a.DocumentDiagnosticReportKind.full,items:[]}:this.client.sendRequest(i.DocumentDiagnosticRequest.type,l,R).then(async T=>T==null||this.isDisposed||R.isCancellationRequested?{kind:a.DocumentDiagnosticReportKind.full,items:[]}:T.kind===i.DocumentDiagnosticReportKind.Full?{kind:a.DocumentDiagnosticReportKind.full,resultId:T.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(T.items,R)}:{kind:a.DocumentDiagnosticReportKind.unChanged,resultId:T.resultId},T=>this.client.handleFailedRequest(i.DocumentDiagnosticRequest.type,R,T,{kind:a.DocumentDiagnosticReportKind.full,items:[]}))},U=this.client.middleware;return U.provideDiagnostics?U.provideDiagnostics(k,L,z,A):A(k,L,z)}};return this.options.workspaceDiagnostics&&(w.provideWorkspaceDiagnostics=(k,L,z)=>{const A=async R=>R.kind===i.DocumentDiagnosticReportKind.Full?{kind:a.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(R.uri),resultId:R.resultId,version:R.version,items:await this.client.protocol2CodeConverter.asDiagnostics(R.items,L)}:{kind:a.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(R.uri),resultId:R.resultId,version:R.version},U=R=>{const l=[];for(const T of R)l.push({uri:this.client.code2ProtocolConverter.asUri(T.uri),value:T.value});return l},W=(R,l)=>{const T=(0,r.generateUuid)(),j=this.client.onProgress(i.WorkspaceDiagnosticRequest.partialResult,T,async H=>{if(H==null){z(null);return}const X={items:[]};for(const re of H.items)try{X.items.push(await A(re))}catch(Te){this.client.error("Converting workspace diagnostics failed.",Te)}z(X)}),K={identifier:this.options.identifier,previousResultIds:U(R),partialResultToken:T};return this.isDisposed===!0||!this.client.isRunning()?{items:[]}:this.client.sendRequest(i.WorkspaceDiagnosticRequest.type,K,l).then(async H=>{if(l.isCancellationRequested)return{items:[]};const X={items:[]};for(const re of H.items)X.items.push(await A(re));return j.dispose(),z(X),{items:[]}},H=>(j.dispose(),this.client.handleFailedRequest(i.DocumentDiagnosticRequest.type,l,H,{items:[]})))},ee=this.client.middleware;return ee.provideWorkspaceDiagnostics?ee.provideWorkspaceDiagnostics(k,L,z,W):W(k,L)}),w}dispose(){this.isDisposed=!0,this.workspaceCancellation?.cancel(),this.workspaceTimeout?.dispose();for(const[w,k]of this.openRequests)k.state===d.active&&k.tokenSource.cancel(),this.openRequests.set(w,{state:d.outDated,document:k.document});this.diagnostics.dispose()}}class E{constructor(w){this.diagnosticRequestor=w,this.documents=new i.LinkedMap,this.isDisposed=!1}add(w){if(this.isDisposed===!0)return;const k=f.asKey(w);this.documents.has(k)||(this.documents.set(k,w,i.Touch.Last),this.trigger())}remove(w){const k=f.asKey(w);this.documents.delete(k),this.documents.size===0?this.stop():k===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){if(this.isDisposed!==!0){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,i.RAL)().timer.setInterval(()=>{const w=this.documents.first;if(w!==void 0){const k=f.asKey(w);this.diagnosticRequestor.pull(w),this.documents.set(k,w,i.Touch.Last),k===this.endDocumentKey()&&this.stop()}},200)}}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){this.intervalHandle?.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return this.endDocument!==void 0?f.asKey(this.endDocument):void 0}}class I{constructor(w,k,L){const z=w.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},A=w.protocol2CodeConverter.asDocumentSelector(L.documentSelector),U=[],W=H=>{const X=L.documentSelector;if(z.match!==void 0)return z.match(X,H);for(const re of X)if(!!i.TextDocumentFilter.is(re)){if(typeof re=="string"||re.language!==void 0&&re.language!=="*"||re.scheme!==void 0&&re.scheme!=="*"&&re.scheme!==H.scheme)return!1;if(re.pattern!==void 0){const Te=new t.Minimatch(re.pattern,{noext:!0});if(!Te.makeRe()||!Te.match(H.fsPath))return!1}}return!0},ee=H=>H instanceof n.Uri?W(H):n.languages.match(A,H)>0&&k.isVisible(H),R=H=>H instanceof n.Uri?this.activeTextDocument?.uri.toString()===H.toString():this.activeTextDocument===H;this.diagnosticRequestor=new y(w,k,L),this.backgroundScheduler=new E(this.diagnosticRequestor);const l=H=>{!ee(H)||!L.interFileDependencies||R(H)||this.backgroundScheduler.add(H)};this.activeTextDocument=n.window.activeTextEditor?.document,n.window.onDidChangeActiveTextEditor(H=>{const X=this.activeTextDocument;this.activeTextDocument=H?.document,X!==void 0&&l(X),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});const T=w.getFeature(i.DidOpenTextDocumentNotification.method);U.push(T.onNotificationSent(H=>{const X=H.textDocument;this.diagnosticRequestor.knows(m.document,X)||ee(X)&&this.diagnosticRequestor.pull(X,()=>{l(X)})})),k.onOpen(H=>{for(const X of H){if(this.diagnosticRequestor.knows(m.document,X))continue;const re=X.toString();let Te;for(const xe of n.workspace.textDocuments)if(re===xe.uri.toString()){Te=xe;break}Te!==void 0&&ee(Te)?this.diagnosticRequestor.pull(Te,()=>{l(Te)}):ee(X)&&this.diagnosticRequestor.pull(X,()=>{l(X)})}});const j=new Set;for(const H of n.workspace.textDocuments)ee(H)&&(this.diagnosticRequestor.pull(H,()=>{l(H)}),j.add(H.uri.toString()));if(z.onTabs===!0)for(const H of k.getTabResources())!j.has(H.toString())&&ee(H)&&this.diagnosticRequestor.pull(H,()=>{l(H)});if(z.onChange===!0){const H=w.getFeature(i.DidChangeTextDocumentNotification.method);U.push(H.onNotificationSent(async X=>{const re=X.textDocument;(z.filter===void 0||!z.filter(re,c.onType))&&this.diagnosticRequestor.knows(m.document,re)&&this.diagnosticRequestor.pull(re,()=>{this.backgroundScheduler.trigger()})}))}if(z.onSave===!0){const H=w.getFeature(i.DidSaveTextDocumentNotification.method);U.push(H.onNotificationSent(X=>{const re=X.textDocument;(z.filter===void 0||!z.filter(re,c.onSave))&&this.diagnosticRequestor.knows(m.document,re)&&this.diagnosticRequestor.pull(X.textDocument,()=>{this.backgroundScheduler.trigger()})}))}const K=w.getFeature(i.DidCloseTextDocumentNotification.method);U.push(K.onNotificationSent(H=>{this.cleanUpDocument(H.textDocument)})),k.onClose(H=>{for(const X of H)this.cleanUpDocument(X)}),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(const H of n.workspace.textDocuments)ee(H)&&this.diagnosticRequestor.pull(H)}),L.workspaceDiagnostics===!0&&L.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=n.Disposable.from(...U,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(w){this.diagnosticRequestor.knows(m.document,w)&&(this.diagnosticRequestor.forgetDocument(w),this.backgroundScheduler.remove(w))}}class J extends o.TextDocumentLanguageFeature{constructor(w){super(w,i.DocumentDiagnosticRequest.type)}fillClientCapabilities(w){let k=s(s(w,"textDocument"),"diagnostic");k.dynamicRegistration=!0,k.relatedDocumentSupport=!1,s(s(w,"workspace"),"diagnostics").refreshSupport=!0}initialize(w,k){this._client.onRequest(i.DiagnosticRefreshRequest.type,async()=>{for(const U of this.getAllProviders())U.onDidChangeDiagnosticsEmitter.fire()});let[z,A]=this.getRegistration(k,w.diagnosticProvider);!z||!A||this.register({id:z,registerOptions:A})}dispose(){this.tabs!==void 0&&(this.tabs.dispose(),this.tabs=void 0),super.dispose()}registerLanguageProvider(w){this.tabs===void 0&&(this.tabs=new p);const k=new I(this._client,this.tabs,w);return[k.disposable,k]}}e.DiagnosticFeature=J}(ao);var mi={};Object.defineProperty(mi,"__esModule",{value:!0}),mi.NotebookDocumentSyncFeature=void 0;const Ve=ie.default,Fu=fi,_t=oe,Eu=pe,ua=ve;function da(e,t){return e[t]===void 0&&(e[t]={}),e[t]}var tn;(function(e){(function(t){function n(m,f){return{version:m.version,uri:f.asUri(m.uri)}}t.asVersionedNotebookDocumentIdentifier=n;function i(m,f,h){const y=_t.NotebookDocument.create(h.asUri(m.uri),m.notebookType,m.version,r(f,h));return Object.keys(m.metadata).length>0&&(y.metadata=o(m.metadata)),y}t.asNotebookDocument=i;function r(m,f){return m.map(h=>s(h,f))}t.asNotebookCells=r;function o(m){return c(new Set,m)}t.asMetadata=o;function s(m,f){const h=_t.NotebookCell.create(a(m.kind),f.asUri(m.document.uri));return Object.keys(m.metadata).length>0&&(h.metadata=o(m.metadata)),m.executionSummary!==void 0&&ua.number(m.executionSummary.executionOrder)&&ua.boolean(m.executionSummary.success)&&(h.executionSummary={executionOrder:m.executionSummary.executionOrder,success:m.executionSummary.success}),h}t.asNotebookCell=s;function a(m){switch(m){case Ve.NotebookCellKind.Markup:return _t.NotebookCellKind.Markup;case Ve.NotebookCellKind.Code:return _t.NotebookCellKind.Code}}function c(m,f){if(m.has(f))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(f)){const h=[];for(const y of f)if(y!==null&&typeof y=="object"||Array.isArray(y))h.push(c(m,y));else{if(y instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");h.push(y)}return h}else{const h=Object.keys(f),y=Object.create(null);for(const E of h){const I=f[E];if(I!==null&&typeof I=="object"||Array.isArray(I))y[E]=c(m,I);else{if(I instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");y[E]=I}}return y}}function d(m,f){const h=f.asChangeTextDocumentParams(m,m.document.uri,m.document.version);return{document:h.textDocument,changes:h.contentChanges}}t.asTextContentChange=d;function p(m,f){const h=Object.create(null);if(m.metadata&&(h.metadata=e.c2p.asMetadata(m.metadata)),m.cells!==void 0){const y=Object.create(null),E=m.cells;E.structure&&(y.structure={array:{start:E.structure.array.start,deleteCount:E.structure.array.deleteCount,cells:E.structure.array.cells!==void 0?E.structure.array.cells.map(I=>e.c2p.asNotebookCell(I,f)):void 0},didOpen:E.structure.didOpen!==void 0?E.structure.didOpen.map(I=>f.asOpenTextDocumentParams(I.document).textDocument):void 0,didClose:E.structure.didClose!==void 0?E.structure.didClose.map(I=>f.asCloseTextDocumentParams(I.document).textDocument):void 0}),E.data!==void 0&&(y.data=E.data.map(I=>e.c2p.asNotebookCell(I,f))),E.textContent!==void 0&&(y.textContent=E.textContent.map(I=>e.c2p.asTextContentChange(I,f))),Object.keys(y).length>0&&(h.cells=y)}return h}t.asNotebookDocumentChangeEvent=p})(e.c2p||(e.c2p={}))})(tn||(tn={}));var mo;(function(e){function t(a,c,d){const p=a.length,m=c.length;let f=0;for(;f<m&&f<p&&n(a[f],c[f],d);)f++;if(f<m&&f<p){let h=p-1,y=m-1;for(;h>=0&&y>=0&&n(a[h],c[y],d);)h--,y--;const E=h+1-f,I=f===y+1?void 0:c.slice(f,y+1);return I!==void 0?{start:f,deleteCount:E,cells:I}:{start:f,deleteCount:E}}else return f<m?{start:f,deleteCount:0,cells:c.slice(f)}:f<p?{start:f,deleteCount:p-f}:void 0}e.computeDiff=t;function n(a,c,d=!0){return a.kind!==c.kind||a.document.uri.toString()!==c.document.uri.toString()||a.document.languageId!==c.document.languageId||!i(a.executionSummary,c.executionSummary)?!1:!d||d&&o(a.metadata,c.metadata)}function i(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.executionOrder===c.executionOrder&&a.success===c.success&&r(a.timing,c.timing)}function r(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.startTime===c.startTime&&a.endTime===c.endTime}function o(a,c){if(a===c)return!0;if(a==null||c===null||c===void 0||typeof a!=typeof c||typeof a!="object")return!1;const d=Array.isArray(a),p=Array.isArray(c);if(d!==p)return!1;if(d&&p){if(a.length!==c.length)return!1;for(let m=0;m<a.length;m++)if(!o(a[m],c[m]))return!1}if(s(a)&&s(c)){const m=Object.keys(a),f=Object.keys(c);if(m.length!==f.length||(m.sort(),f.sort(),!o(m,f)))return!1;for(let h=0;h<m.length;h++){const y=m[h];if(!o(a[y],c[y]))return!1}return!0}return!1}function s(a){return a!==null&&typeof a=="object"}e.isObjectLiteral=s})(mo||(mo={}));var po;(function(e){function t(n,i){if(typeof n=="string")return n==="*"||i.notebookType===n;if(n.notebookType!==void 0&&n.notebookType!=="*"&&i.notebookType!==n.notebookType)return!1;const r=i.uri;if(n.scheme!==void 0&&n.scheme!=="*"&&r.scheme!==n.scheme)return!1;if(n.pattern!==void 0){const o=new Fu.Minimatch(n.pattern,{noext:!0});if(!o.makeRe()||!o.match(r.fsPath))return!1}return!0}e.matchNotebook=t})(po||(po={}));var pi;(function(e){function t(i){const r=i.notebookSelector,o=[];for(const s of r){const a=(typeof s.notebook=="string"?s.notebook:s.notebook?.notebookType)??"*",c=typeof s.notebook=="string"?void 0:s.notebook?.scheme,d=typeof s.notebook=="string"?void 0:s.notebook?.pattern;if(s.cells!==void 0)for(const p of s.cells)o.push(n(a,c,d,p.language));else o.push(n(a,c,d,void 0))}return o}e.asDocumentSelector=t;function n(i,r,o,s){return r===void 0&&o===void 0?{notebook:i,language:s}:{notebook:{notebookType:i,scheme:r,pattern:o},language:s}}})(pi||(pi={}));var yi;(function(e){function t(n){return{cells:n,uris:new Set(n.map(i=>i.document.uri.toString()))}}e.create=t})(yi||(yi={}));class vi{constructor(t,n){this.client=t,this.options=n,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=t.protocol2CodeConverter.asDocumentSelector(pi.asDocumentSelector(n)),Ve.workspace.onDidOpenNotebookDocument(i=>{this.notebookDidOpen.add(i.uri.toString()),this.didOpen(i)},void 0,this.disposables);for(const i of Ve.workspace.notebookDocuments)this.notebookDidOpen.add(i.uri.toString()),this.didOpen(i);Ve.workspace.onDidChangeNotebookDocument(i=>this.didChangeNotebookDocument(i),void 0,this.disposables),this.options.save===!0&&Ve.workspace.onDidSaveNotebookDocument(i=>this.didSave(i),void 0,this.disposables),Ve.workspace.onDidCloseNotebookDocument(i=>{this.didClose(i),this.notebookDidOpen.delete(i.uri.toString())},void 0,this.disposables)}getState(){for(const t of Ve.workspace.notebookDocuments)if(this.getMatchingCells(t)!==void 0)return{kind:"document",id:"$internal",registrations:!0,matches:!0};return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(t){return Ve.languages.match(this.selector,t)>0}didOpenNotebookCellTextDocument(t,n){if(Ve.languages.match(this.selector,n.document)===0||!this.notebookDidOpen.has(t.uri.toString()))return;const i=this.notebookSyncInfo.get(t.uri.toString()),r=this.cellMatches(t,n);if(i!==void 0){const o=i.uris.has(n.document.uri.toString());if(r&&o||!r&&!o)return;if(r){const s=this.getMatchingCells(t);if(s!==void 0){const a=this.asNotebookDocumentChangeEvent(t,void 0,i,s);a!==void 0&&this.doSendChange(a,s).catch(()=>{})}}}else r&&this.doSendOpen(t,[n]).catch(()=>{})}didChangeNotebookCellTextDocument(t,n){Ve.languages.match(this.selector,n.document)!==0&&this.doSendChange({notebook:t,cells:{textContent:[n]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(t,n){const i=this.notebookSyncInfo.get(t.uri.toString());if(i===void 0)return;const r=n.document.uri,o=i.cells.findIndex(s=>s.document.uri.toString()===r.toString());if(o!==-1)if(o===0&&i.cells.length===1)this.doSendClose(t,i.cells).catch(()=>{});else{const s=i.cells.slice(),a=s.splice(o,1);this.doSendChange({notebook:t,cells:{structure:{array:{start:o,deleteCount:1},didClose:a}}},s).catch(()=>{})}}dispose(){for(const t of this.disposables)t.dispose()}didOpen(t,n=this.getMatchingCells(t),i=this.notebookSyncInfo.get(t.uri.toString())){if(i!==void 0)if(n!==void 0){const r=this.asNotebookDocumentChangeEvent(t,void 0,i,n);r!==void 0&&this.doSendChange(r,n).catch(()=>{})}else this.doSendClose(t,[]).catch(()=>{});else{if(n===void 0)return;this.doSendOpen(t,n).catch(()=>{})}}didChangeNotebookDocument(t){const n=t.notebook,i=this.notebookSyncInfo.get(n.uri.toString());if(i===void 0){if(t.contentChanges.length===0)return;const r=this.getMatchingCells(n);if(r===void 0)return;this.didOpen(n,r,i)}else{const r=this.getMatchingCells(n);if(r===void 0){this.didClose(n,i);return}const o=this.asNotebookDocumentChangeEvent(t.notebook,t,i,r);o!==void 0&&this.doSendChange(o,r).catch(()=>{})}}didSave(t){this.notebookSyncInfo.get(t.uri.toString())!==void 0&&this.doSendSave(t).catch(()=>{})}didClose(t,n=this.notebookSyncInfo.get(t.uri.toString())){if(n===void 0)return;const i=t.getCells().filter(r=>n.uris.has(r.document.uri.toString()));this.doSendClose(t,i).catch(()=>{})}async sendDidOpenNotebookDocument(t){const n=this.getMatchingCells(t);if(n!==void 0)return this.doSendOpen(t,n)}async doSendOpen(t,n){const i=async(o,s)=>{const a=tn.c2p.asNotebookDocument(o,s,this.client.code2ProtocolConverter),c=s.map(d=>this.client.code2ProtocolConverter.asTextDocumentItem(d.document));try{await this.client.sendNotification(_t.DidOpenNotebookDocumentNotification.type,{notebookDocument:a,cellTextDocuments:c})}catch(d){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",d),d}},r=this.client.middleware?.notebooks;return this.notebookSyncInfo.set(t.uri.toString(),yi.create(n)),r?.didOpen!==void 0?r.didOpen(t,n,i):i(t,n)}async sendDidChangeNotebookDocument(t){return this.doSendChange(t,void 0)}async doSendChange(t,n=this.getMatchingCells(t.notebook)){const i=async o=>{try{await this.client.sendNotification(_t.DidChangeNotebookDocumentNotification.type,{notebookDocument:tn.c2p.asVersionedNotebookDocumentIdentifier(o.notebook,this.client.code2ProtocolConverter),change:tn.c2p.asNotebookDocumentChangeEvent(o,this.client.code2ProtocolConverter)})}catch(s){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",s),s}},r=this.client.middleware?.notebooks;return t.cells?.structure!==void 0&&this.notebookSyncInfo.set(t.notebook.uri.toString(),yi.create(n??[])),r?.didChange!==void 0?r?.didChange(t,i):i(t)}async sendDidSaveNotebookDocument(t){return this.doSendSave(t)}async doSendSave(t){const n=async r=>{try{await this.client.sendNotification(_t.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(r.uri)}})}catch(o){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",o),o}},i=this.client.middleware?.notebooks;return i?.didSave!==void 0?i.didSave(t,n):n(t)}async sendDidCloseNotebookDocument(t){return this.doSendClose(t,this.getMatchingCells(t)??[])}async doSendClose(t,n){const i=async(o,s)=>{try{await this.client.sendNotification(_t.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(o.uri)},cellTextDocuments:s.map(a=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(a.document))})}catch(a){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",a),a}},r=this.client.middleware?.notebooks;return this.notebookSyncInfo.delete(t.uri.toString()),r?.didClose!==void 0?r.didClose(t,n,i):i(t,n)}asNotebookDocumentChangeEvent(t,n,i,r){if(n!==void 0&&n.notebook!==t)throw new Error("Notebook must be identical");const o={notebook:t};n?.metadata!==void 0&&(o.metadata=tn.c2p.asMetadata(n.metadata));let s;if(n?.cellChanges!==void 0&&n.cellChanges.length>0){const a=[];s=new Set(r.map(c=>c.document.uri.toString()));for(const c of n.cellChanges)s.has(c.cell.document.uri.toString())&&(c.executionSummary!==void 0||c.metadata!==void 0)&&a.push(c.cell);a.length>0&&(o.cells=o.cells??{},o.cells.data=a)}if((n?.contentChanges!==void 0&&n.contentChanges.length>0||n===void 0)&&i!==void 0&&r!==void 0){const a=i.cells,c=r,d=mo.computeDiff(a,c,!1);let p,m;if(d!==void 0){p=d.cells===void 0?new Map:new Map(d.cells.map(y=>[y.document.uri.toString(),y])),m=d.deleteCount===0?new Map:new Map(a.slice(d.start,d.start+d.deleteCount).map(y=>[y.document.uri.toString(),y]));for(const y of Array.from(m.keys()))p.has(y)&&(m.delete(y),p.delete(y));o.cells=o.cells??{};const f=[],h=[];if(p.size>0||m.size>0){for(const y of p.values())f.push(y);for(const y of m.values())h.push(y)}o.cells.structure={array:d,didOpen:f,didClose:h}}}return Object.keys(o).length>1?o:void 0}getMatchingCells(t,n=t.getCells()){if(this.options.notebookSelector!==void 0){for(const i of this.options.notebookSelector)if(i.notebook===void 0||po.matchNotebook(i.notebook,t)){const r=this.filterCells(t,n,i.cells);return r.length===0?void 0:r}}}cellMatches(t,n){const i=this.getMatchingCells(t,[n]);return i!==void 0&&i[0]===n}filterCells(t,n,i){const r=i!==void 0?n.filter(o=>{const s=o.document.languageId;return i.some(a=>a.language==="*"||s===a.language)}):n;return typeof this.client.clientOptions.notebookDocumentOptions?.filterCells=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(t,r):r}}class $t{constructor(t){this.client=t,this.registrations=new Map,this.registrationType=_t.NotebookDocumentSyncRegistrationType.type,Ve.workspace.onDidOpenTextDocument(n=>{if(n.uri.scheme!==$t.CellScheme)return;const[i,r]=this.findNotebookDocumentAndCell(n);if(!(i===void 0||r===void 0))for(const o of this.registrations.values())o instanceof vi&&o.didOpenNotebookCellTextDocument(i,r)}),Ve.workspace.onDidChangeTextDocument(n=>{if(n.contentChanges.length===0)return;const i=n.document;if(i.uri.scheme!==$t.CellScheme)return;const[r]=this.findNotebookDocumentAndCell(i);if(r!==void 0)for(const o of this.registrations.values())o instanceof vi&&o.didChangeNotebookCellTextDocument(r,n)}),Ve.workspace.onDidCloseTextDocument(n=>{if(n.uri.scheme!==$t.CellScheme)return;const[i,r]=this.findNotebookDocumentAndCell(n);if(!(i===void 0||r===void 0))for(const o of this.registrations.values())o instanceof vi&&o.didCloseNotebookCellTextDocument(i,r)})}getState(){if(this.registrations.size===0)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(const t of this.registrations.values()){const n=t.getState();if(n.kind==="document"&&n.registrations===!0&&n.matches===!0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(t){const n=da(da(t,"notebookDocument"),"synchronization");n.dynamicRegistration=!0,n.executionSummarySupport=!0}preInitialize(t){const n=t.notebookDocumentSync;n!==void 0&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(pi.asDocumentSelector(n)))}initialize(t){const n=t.notebookDocumentSync;if(n===void 0)return;const i=n.id??Eu.generateUuid();this.register({id:i,registerOptions:n})}register(t){const n=new vi(this.client,t.registerOptions);this.registrations.set(t.id,n)}unregister(t){const n=this.registrations.get(t);n&&n.dispose()}dispose(){for(const t of this.registrations.values())t.dispose();this.registrations.clear()}handles(t){if(t.uri.scheme!==$t.CellScheme)return!1;if(this.dedicatedChannel!==void 0&&Ve.languages.match(this.dedicatedChannel,t)>0)return!0;for(const n of this.registrations.values())if(n.handles(t))return!0;return!1}getProvider(t){for(const n of this.registrations.values())if(n.handles(t.document))return n}findNotebookDocumentAndCell(t){const n=t.uri.toString();for(const i of Ve.workspace.notebookDocuments)for(const r of i.getCells())if(r.document.uri.toString()===n)return[i,r];return[void 0,void 0]}}mi.NotebookDocumentSyncFeature=$t,$t.CellScheme="vscode-notebook-cell";var Rt={};Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.SyncConfigurationFeature=Rt.toJSONObject=Rt.ConfigurationFeature=void 0;const nn=ie.default,Rn=oe,Ou=ve,qu=pe,la=ye;class Mu{constructor(t){this._client=t}getState(){return{kind:"static"}}fillClientCapabilities(t){t.workspace=t.workspace||{},t.workspace.configuration=!0}initialize(){let t=this._client;t.onRequest(Rn.ConfigurationRequest.type,(n,i)=>{let r=s=>{let a=[];for(let c of s.items){let d=c.scopeUri!==void 0&&c.scopeUri!==null?this._client.protocol2CodeConverter.asUri(c.scopeUri):void 0;a.push(this.getConfiguration(d,c.section!==null?c.section:void 0))}return a},o=t.middleware.workspace;return o&&o.configuration?o.configuration(n,i,r):r(n)})}getConfiguration(t,n){let i=null;if(n){let r=n.lastIndexOf(".");if(r===-1)i=Nt(nn.workspace.getConfiguration(void 0,t).get(n));else{let o=nn.workspace.getConfiguration(n.substr(0,r),t);o&&(i=Nt(o.get(n.substr(r+1))))}}else{let r=nn.workspace.getConfiguration(void 0,t);i={};for(let o of Object.keys(r))r.has(o)&&(i[o]=Nt(r.get(o)))}return i===void 0&&(i=null),i}dispose(){}}Rt.ConfigurationFeature=Mu;function Nt(e){if(e){if(Array.isArray(e))return e.map(Nt);if(typeof e=="object"){const t=Object.create(null);for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=Nt(e[n]));return t}}return e}Rt.toJSONObject=Nt;class Iu{constructor(t){this._client=t,this.isDisposed=!1,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return Rn.DidChangeConfigurationNotification.type}fillClientCapabilities(t){(0,la.ensure)((0,la.ensure)(t,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){let t=this._client.clientOptions.synchronize?.configurationSection;t!==void 0&&this.register({id:qu.generateUuid(),registerOptions:{section:t}})}register(t){let n=nn.workspace.onDidChangeConfiguration(i=>{this.onDidChangeConfiguration(t.registerOptions.section,i)});this._listeners.set(t.id,n),t.registerOptions.section!==void 0&&this.onDidChangeConfiguration(t.registerOptions.section,void 0)}unregister(t){let n=this._listeners.get(t);n&&(this._listeners.delete(t),n.dispose())}dispose(){for(const t of this._listeners.values())t.dispose();this._listeners.clear(),this.isDisposed=!0}onDidChangeConfiguration(t,n){if(this.isDisposed)return;let i;if(Ou.string(t)?i=[t]:i=t,i!==void 0&&n!==void 0&&!i.some(a=>n.affectsConfiguration(a)))return;const r=async s=>s===void 0?this._client.sendNotification(Rn.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(Rn.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(s)});let o=this._client.middleware.workspace?.didChangeConfiguration;(o?o(i,r):r(i)).catch(s=>{this._client.error(`Sending notification ${Rn.DidChangeConfigurationNotification.type.method} failed`,s)})}extractSettingsInformation(t){function n(o,s){let a=o;for(let c=0;c<s.length-1;c++){let d=a[s[c]];d||(d=Object.create(null),a[s[c]]=d),a=d}return a}let i=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,r=Object.create(null);for(let o=0;o<t.length;o++){let s=t[o],a=s.indexOf("."),c=null;if(a>=0?c=nn.workspace.getConfiguration(s.substr(0,a),i).get(s.substr(a+1)):c=nn.workspace.getConfiguration(void 0,i).get(s),c){let d=t[o].split(".");n(r,d)[d[d.length-1]]=Nt(c)}}return r}}Rt.SyncConfigurationFeature=Iu;var et={};Object.defineProperty(et,"__esModule",{value:!0}),et.DidSaveTextDocumentFeature=et.WillSaveWaitUntilFeature=et.WillSaveFeature=et.DidChangeTextDocumentFeature=et.DidCloseTextDocumentFeature=et.DidOpenTextDocumentFeature=void 0;const it=ie.default,Pe=oe,Ee=ye,rn=pe;class Nu extends Ee.TextDocumentEventFeature{constructor(t,n){super(t,it.workspace.onDidOpenTextDocument,Pe.DidOpenTextDocumentNotification.type,()=>t.middleware.didOpen,i=>t.code2ProtocolConverter.asOpenTextDocumentParams(i),i=>i,Ee.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=n}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(t){(0,Ee.ensure)((0,Ee.ensure)(t,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(t,n){const i=t.resolvedTextDocumentSync;n&&i&&i.openClose&&this.register({id:rn.generateUuid(),registerOptions:{documentSelector:n}})}get registrationType(){return Pe.DidOpenTextDocumentNotification.type}register(t){if(super.register(t),!t.registerOptions.documentSelector)return;const n=this._client.protocol2CodeConverter.asDocumentSelector(t.registerOptions.documentSelector);it.workspace.textDocuments.forEach(i=>{const r=i.uri.toString();if(!this._syncedDocuments.has(r)&&it.languages.match(n,i)>0&&!this._client.hasDedicatedTextSynchronizationFeature(i)){const o=this._client.middleware,s=a=>this._client.sendNotification(this._type,this._createParams(a));(o.didOpen?o.didOpen(i,s):s(i)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)}),this._syncedDocuments.set(r,i)}})}getTextDocument(t){return t}notificationSent(t,n,i){this._syncedDocuments.set(t.uri.toString(),t),super.notificationSent(t,n,i)}}et.DidOpenTextDocumentFeature=Nu;class Lu extends Ee.TextDocumentEventFeature{constructor(t,n,i){super(t,it.workspace.onDidCloseTextDocument,Pe.DidCloseTextDocumentNotification.type,()=>t.middleware.didClose,r=>t.code2ProtocolConverter.asCloseTextDocumentParams(r),r=>r,Ee.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=n,this._pendingTextDocumentChanges=i}get registrationType(){return Pe.DidCloseTextDocumentNotification.type}fillClientCapabilities(t){(0,Ee.ensure)((0,Ee.ensure)(t,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(t,n){let i=t.resolvedTextDocumentSync;n&&i&&i.openClose&&this.register({id:rn.generateUuid(),registerOptions:{documentSelector:n}})}async callback(t){await super.callback(t),this._pendingTextDocumentChanges.delete(t.uri.toString())}getTextDocument(t){return t}notificationSent(t,n,i){this._syncedDocuments.delete(t.uri.toString()),super.notificationSent(t,n,i)}unregister(t){const n=this._selectors.get(t);super.unregister(t);const i=this._selectors.values();this._syncedDocuments.forEach(r=>{if(it.languages.match(n,r)>0&&!this._selectorFilter(i,r)&&!this._client.hasDedicatedTextSynchronizationFeature(r)){let o=this._client.middleware,s=a=>this._client.sendNotification(this._type,this._createParams(a));this._syncedDocuments.delete(r.uri.toString()),(o.didClose?o.didClose(r,s):s(r)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)})}})}}et.DidCloseTextDocumentFeature=Lu;class ju extends Ee.DynamicDocumentFeature{constructor(t,n){super(t),this._changeData=new Map,this._onNotificationSent=new it.EventEmitter,this._onPendingChangeAdded=new it.EventEmitter,this._pendingTextDocumentChanges=n,this._syncKind=Pe.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return Pe.DidChangeTextDocumentNotification.type}fillClientCapabilities(t){(0,Ee.ensure)((0,Ee.ensure)(t,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(t,n){let i=t.resolvedTextDocumentSync;n&&i&&i.change!==void 0&&i.change!==Pe.TextDocumentSyncKind.None&&this.register({id:rn.generateUuid(),registerOptions:Object.assign({},{documentSelector:n},{syncKind:i.change})})}register(t){!t.registerOptions.documentSelector||(this._listener||(this._listener=it.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(t.id,{syncKind:t.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(t.registerOptions.documentSelector)}),this.updateSyncKind(t.registerOptions.syncKind))}*getDocumentSelectors(){for(const t of this._changeData.values())yield t.documentSelector}async callback(t){if(t.contentChanges.length===0)return;const n=t.document.uri,i=t.document.version,r=[];for(const o of this._changeData.values())if(it.languages.match(o.documentSelector,t.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(t.document)){const s=this._client.middleware;if(o.syncKind===Pe.TextDocumentSyncKind.Incremental){const a=async c=>{const d=this._client.code2ProtocolConverter.asChangeTextDocumentParams(c,n,i);await this._client.sendNotification(Pe.DidChangeTextDocumentNotification.type,d),this.notificationSent(c.document,Pe.DidChangeTextDocumentNotification.type,d)};r.push(s.didChange?s.didChange(t,c=>a(c)):a(t))}else if(o.syncKind===Pe.TextDocumentSyncKind.Full){const a=async c=>{const d=c.document.uri.toString();this._pendingTextDocumentChanges.set(d,c.document),this._onPendingChangeAdded.fire()};r.push(s.didChange?s.didChange(t,c=>a(c)):a(t))}}return Promise.all(r).then(void 0,o=>{throw this._client.error(`Sending document notification ${Pe.DidChangeTextDocumentNotification.type.method} failed`,o),o})}notificationSent(t,n,i){this._onNotificationSent.fire({textDocument:t,type:n,params:i})}unregister(t){if(this._changeData.delete(t),this._changeData.size===0)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=Pe.TextDocumentSyncKind.None;else{this._syncKind=Pe.TextDocumentSyncKind.None;for(const n of this._changeData.values())if(this.updateSyncKind(n.syncKind),this._syncKind===Pe.TextDocumentSyncKind.Full)break}}dispose(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=Pe.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(t){if(this._pendingTextDocumentChanges.size===0)return[];let n;if(t.size===0)n=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{n=[];for(const i of this._pendingTextDocumentChanges)t.has(i[0])||(n.push(i[1]),this._pendingTextDocumentChanges.delete(i[0]))}return n}getProvider(t){for(const n of this._changeData.values())if(it.languages.match(n.documentSelector,t)>0)return{send:i=>this.callback(i)}}updateSyncKind(t){if(this._syncKind!==Pe.TextDocumentSyncKind.Full)switch(t){case Pe.TextDocumentSyncKind.Full:this._syncKind=t;break;case Pe.TextDocumentSyncKind.Incremental:this._syncKind===Pe.TextDocumentSyncKind.None&&(this._syncKind=Pe.TextDocumentSyncKind.Incremental);break}}}et.DidChangeTextDocumentFeature=ju;class Au extends Ee.TextDocumentEventFeature{constructor(t){super(t,it.workspace.onWillSaveTextDocument,Pe.WillSaveTextDocumentNotification.type,()=>t.middleware.willSave,n=>t.code2ProtocolConverter.asWillSaveTextDocumentParams(n),n=>n.document,(n,i)=>Ee.TextDocumentEventFeature.textDocumentFilter(n,i.document))}get registrationType(){return Pe.WillSaveTextDocumentNotification.type}fillClientCapabilities(t){let n=(0,Ee.ensure)((0,Ee.ensure)(t,"textDocument"),"synchronization");n.willSave=!0}initialize(t,n){let i=t.resolvedTextDocumentSync;n&&i&&i.willSave&&this.register({id:rn.generateUuid(),registerOptions:{documentSelector:n}})}getTextDocument(t){return t.document}}et.WillSaveFeature=Au;class Hu extends Ee.DynamicDocumentFeature{constructor(t){super(t),this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return Pe.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(t){let n=(0,Ee.ensure)((0,Ee.ensure)(t,"textDocument"),"synchronization");n.willSaveWaitUntil=!0}initialize(t,n){let i=t.resolvedTextDocumentSync;n&&i&&i.willSaveWaitUntil&&this.register({id:rn.generateUuid(),registerOptions:{documentSelector:n}})}register(t){!t.registerOptions.documentSelector||(this._listener||(this._listener=it.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(t.id,this._client.protocol2CodeConverter.asDocumentSelector(t.registerOptions.documentSelector)))}callback(t){if(Ee.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),t.document)&&!this._client.hasDedicatedTextSynchronizationFeature(t.document)){let n=this._client.middleware,i=r=>this._client.sendRequest(Pe.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(r)).then(async o=>{let s=await this._client.protocol2CodeConverter.asTextEdits(o);return s===void 0?[]:s});t.waitUntil(n.willSaveWaitUntil?n.willSaveWaitUntil(t,i):i(t))}}unregister(t){this._selectors.delete(t),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}}et.WillSaveWaitUntilFeature=Hu;class $u extends Ee.TextDocumentEventFeature{constructor(t){super(t,it.workspace.onDidSaveTextDocument,Pe.DidSaveTextDocumentNotification.type,()=>t.middleware.didSave,n=>t.code2ProtocolConverter.asSaveTextDocumentParams(n,this._includeText),n=>n,Ee.TextDocumentEventFeature.textDocumentFilter),this._includeText=!1}get registrationType(){return Pe.DidSaveTextDocumentNotification.type}fillClientCapabilities(t){(0,Ee.ensure)((0,Ee.ensure)(t,"textDocument"),"synchronization").didSave=!0}initialize(t,n){const i=t.resolvedTextDocumentSync;if(n&&i&&i.save){const r=typeof i.save=="boolean"?{includeText:!1}:{includeText:!!i.save.includeText};this.register({id:rn.generateUuid(),registerOptions:Object.assign({},{documentSelector:n},r)})}}register(t){this._includeText=!!t.registerOptions.includeText,super.register(t)}getTextDocument(t){return t}}et.DidSaveTextDocumentFeature=$u;var Ci={};Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.CompletionItemFeature=void 0;const Wu=ie.default,le=oe,yo=ye,Ku=pe,Uu=[le.CompletionItemKind.Text,le.CompletionItemKind.Method,le.CompletionItemKind.Function,le.CompletionItemKind.Constructor,le.CompletionItemKind.Field,le.CompletionItemKind.Variable,le.CompletionItemKind.Class,le.CompletionItemKind.Interface,le.CompletionItemKind.Module,le.CompletionItemKind.Property,le.CompletionItemKind.Unit,le.CompletionItemKind.Value,le.CompletionItemKind.Enum,le.CompletionItemKind.Keyword,le.CompletionItemKind.Snippet,le.CompletionItemKind.Color,le.CompletionItemKind.File,le.CompletionItemKind.Reference,le.CompletionItemKind.Folder,le.CompletionItemKind.EnumMember,le.CompletionItemKind.Constant,le.CompletionItemKind.Struct,le.CompletionItemKind.Event,le.CompletionItemKind.Operator,le.CompletionItemKind.TypeParameter];class zu extends yo.TextDocumentLanguageFeature{constructor(t){super(t,le.CompletionRequest.type),this.labelDetailsSupport=new Map}fillClientCapabilities(t){let n=(0,yo.ensure)((0,yo.ensure)(t,"textDocument"),"completion");n.dynamicRegistration=!0,n.contextSupport=!0,n.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[le.MarkupKind.Markdown,le.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[le.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[le.InsertTextMode.asIs,le.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},n.insertTextMode=le.InsertTextMode.adjustIndentation,n.completionItemKind={valueSet:Uu},n.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode"]}}initialize(t,n){const i=this.getRegistrationOptions(n,t.completionProvider);!i||this.register({id:Ku.generateUuid(),registerOptions:i})}registerLanguageProvider(t,n){this.labelDetailsSupport.set(n,!!t.completionItem?.labelDetailsSupport);const i=t.triggerCharacters??[],r=t.allCommitCharacters,o=t.documentSelector,s={provideCompletionItems:(a,c,d,p)=>{const m=this._client,f=this._client.middleware,h=(y,E,I,J)=>m.sendRequest(le.CompletionRequest.type,m.code2ProtocolConverter.asCompletionParams(y,E,I),J).then(B=>J.isCancellationRequested?null:m.protocol2CodeConverter.asCompletionResult(B,r,J),B=>m.handleFailedRequest(le.CompletionRequest.type,J,B,null));return f.provideCompletionItem?f.provideCompletionItem(a,c,p,d,h):h(a,c,p,d)},resolveCompletionItem:t.resolveProvider?(a,c)=>{const d=this._client,p=this._client.middleware,m=(f,h)=>d.sendRequest(le.CompletionResolveRequest.type,d.code2ProtocolConverter.asCompletionItem(f,!!this.labelDetailsSupport.get(n)),h).then(y=>h.isCancellationRequested?null:d.protocol2CodeConverter.asCompletionItem(y),y=>d.handleFailedRequest(le.CompletionResolveRequest.type,h,y,f));return p.resolveCompletionItem?p.resolveCompletionItem(a,c,m):m(a,c)}:void 0};return[Wu.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(o),s,...i),s]}}Ci.CompletionItemFeature=zu;var _i={};Object.defineProperty(_i,"__esModule",{value:!0}),_i.HoverFeature=void 0;const xu=ie.default,Pn=oe,vo=ye,Bu=pe;class Vu extends vo.TextDocumentLanguageFeature{constructor(t){super(t,Pn.HoverRequest.type)}fillClientCapabilities(t){const n=(0,vo.ensure)((0,vo.ensure)(t,"textDocument"),"hover");n.dynamicRegistration=!0,n.contentFormat=[Pn.MarkupKind.Markdown,Pn.MarkupKind.PlainText]}initialize(t,n){const i=this.getRegistrationOptions(n,t.hoverProvider);!i||this.register({id:Bu.generateUuid(),registerOptions:i})}registerLanguageProvider(t){const n=t.documentSelector,i={provideHover:(r,o,s)=>{const a=this._client,c=(p,m,f)=>a.sendRequest(Pn.HoverRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,m),f).then(h=>f.isCancellationRequested?null:a.protocol2CodeConverter.asHover(h),h=>a.handleFailedRequest(Pn.HoverRequest.type,f,h,null)),d=a.middleware;return d.provideHover?d.provideHover(r,o,s,c):c(r,o,s)}};return[this.registerProvider(n,i),i]}registerProvider(t,n){return xu.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n)}}_i.HoverFeature=Vu;var Di={};Object.defineProperty(Di,"__esModule",{value:!0}),Di.DefinitionFeature=void 0;const Ju=ie.default,Co=oe,_o=ye,Qu=pe;class Gu extends _o.TextDocumentLanguageFeature{constructor(t){super(t,Co.DefinitionRequest.type)}fillClientCapabilities(t){let n=(0,_o.ensure)((0,_o.ensure)(t,"textDocument"),"definition");n.dynamicRegistration=!0,n.linkSupport=!0}initialize(t,n){const i=this.getRegistrationOptions(n,t.definitionProvider);!i||this.register({id:Qu.generateUuid(),registerOptions:i})}registerLanguageProvider(t){const n=t.documentSelector,i={provideDefinition:(r,o,s)=>{const a=this._client,c=(p,m,f)=>a.sendRequest(Co.DefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,m),f).then(h=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(h,f),h=>a.handleFailedRequest(Co.DefinitionRequest.type,f,h,null)),d=a.middleware;return d.provideDefinition?d.provideDefinition(r,o,s,c):c(r,o,s)}};return[this.registerProvider(n,i),i]}registerProvider(t,n){return Ju.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n)}}Di.DefinitionFeature=Gu;var bi={};Object.defineProperty(bi,"__esModule",{value:!0}),bi.SignatureHelpFeature=void 0;const fa=ie.default,kn=oe,Do=ye,Xu=pe;class Yu extends Do.TextDocumentLanguageFeature{constructor(t){super(t,kn.SignatureHelpRequest.type)}fillClientCapabilities(t){let n=(0,Do.ensure)((0,Do.ensure)(t,"textDocument"),"signatureHelp");n.dynamicRegistration=!0,n.signatureInformation={documentationFormat:[kn.MarkupKind.Markdown,kn.MarkupKind.PlainText]},n.signatureInformation.parameterInformation={labelOffsetSupport:!0},n.signatureInformation.activeParameterSupport=!0,n.contextSupport=!0}initialize(t,n){const i=this.getRegistrationOptions(n,t.signatureHelpProvider);!i||this.register({id:Xu.generateUuid(),registerOptions:i})}registerLanguageProvider(t){const n={provideSignatureHelp:(i,r,o,s)=>{const a=this._client,c=(p,m,f,h)=>a.sendRequest(kn.SignatureHelpRequest.type,a.code2ProtocolConverter.asSignatureHelpParams(p,m,f),h).then(y=>h.isCancellationRequested?null:a.protocol2CodeConverter.asSignatureHelp(y,h),y=>a.handleFailedRequest(kn.SignatureHelpRequest.type,h,y,null)),d=a.middleware;return d.provideSignatureHelp?d.provideSignatureHelp(i,r,s,o,c):c(i,r,s,o)}};return[this.registerProvider(t,n),n]}registerProvider(t,n){const i=this._client.protocol2CodeConverter.asDocumentSelector(t.documentSelector);if(t.retriggerCharacters===void 0){const r=t.triggerCharacters||[];return fa.languages.registerSignatureHelpProvider(i,n,...r)}else{const r={triggerCharacters:t.triggerCharacters||[],retriggerCharacters:t.retriggerCharacters||[]};return fa.languages.registerSignatureHelpProvider(i,n,r)}}}bi.SignatureHelpFeature=Yu;var wi={};Object.defineProperty(wi,"__esModule",{value:!0}),wi.DocumentHighlightFeature=void 0;const Zu=ie.default,bo=oe,wo=ye,ed=pe;class td extends wo.TextDocumentLanguageFeature{constructor(t){super(t,bo.DocumentHighlightRequest.type)}fillClientCapabilities(t){(0,wo.ensure)((0,wo.ensure)(t,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(t,n){const i=this.getRegistrationOptions(n,t.documentHighlightProvider);!i||this.register({id:ed.generateUuid(),registerOptions:i})}registerLanguageProvider(t){const n=t.documentSelector,i={provideDocumentHighlights:(r,o,s)=>{const a=this._client,c=(p,m,f)=>a.sendRequest(bo.DocumentHighlightRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,m),f).then(h=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDocumentHighlights(h,f),h=>a.handleFailedRequest(bo.DocumentHighlightRequest.type,f,h,null)),d=a.middleware;return d.provideDocumentHighlights?d.provideDocumentHighlights(r,o,s,c):c(r,o,s)}};return[Zu.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),i),i]}}wi.DocumentHighlightFeature=td;var So={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DocumentSymbolFeature=e.SupportedSymbolTags=e.SupportedSymbolKinds=void 0;const t=ie.default,n=oe,i=ye,r=pe;e.SupportedSymbolKinds=[n.SymbolKind.File,n.SymbolKind.Module,n.SymbolKind.Namespace,n.SymbolKind.Package,n.SymbolKind.Class,n.SymbolKind.Method,n.SymbolKind.Property,n.SymbolKind.Field,n.SymbolKind.Constructor,n.SymbolKind.Enum,n.SymbolKind.Interface,n.SymbolKind.Function,n.SymbolKind.Variable,n.SymbolKind.Constant,n.SymbolKind.String,n.SymbolKind.Number,n.SymbolKind.Boolean,n.SymbolKind.Array,n.SymbolKind.Object,n.SymbolKind.Key,n.SymbolKind.Null,n.SymbolKind.EnumMember,n.SymbolKind.Struct,n.SymbolKind.Event,n.SymbolKind.Operator,n.SymbolKind.TypeParameter],e.SupportedSymbolTags=[n.SymbolTag.Deprecated];class o extends i.TextDocumentLanguageFeature{constructor(a){super(a,n.DocumentSymbolRequest.type)}fillClientCapabilities(a){let c=(0,i.ensure)((0,i.ensure)(a,"textDocument"),"documentSymbol");c.dynamicRegistration=!0,c.symbolKind={valueSet:e.SupportedSymbolKinds},c.hierarchicalDocumentSymbolSupport=!0,c.tagSupport={valueSet:e.SupportedSymbolTags},c.labelSupport=!0}initialize(a,c){const d=this.getRegistrationOptions(c,a.documentSymbolProvider);!d||this.register({id:r.generateUuid(),registerOptions:d})}registerLanguageProvider(a){const c=a.documentSelector,d={provideDocumentSymbols:(m,f)=>{const h=this._client,y=async(I,J)=>{try{const B=await h.sendRequest(n.DocumentSymbolRequest.type,h.code2ProtocolConverter.asDocumentSymbolParams(I),J);if(J.isCancellationRequested||B===void 0||B===null)return null;if(B.length===0)return[];{const w=B[0];return n.DocumentSymbol.is(w)?await h.protocol2CodeConverter.asDocumentSymbols(B,J):await h.protocol2CodeConverter.asSymbolInformations(B,J)}}catch(B){return h.handleFailedRequest(n.DocumentSymbolRequest.type,J,B,null)}},E=h.middleware;return E.provideDocumentSymbols?E.provideDocumentSymbols(m,f,y):y(m,f)}},p=a.label!==void 0?{label:a.label}:void 0;return[t.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(c),d,p),d]}}e.DocumentSymbolFeature=o})(So);var Si={};Object.defineProperty(Si,"__esModule",{value:!0}),Si.WorkspaceSymbolFeature=void 0;const nd=ie.default,Fn=oe,To=ye,ga=So,id=pe;class rd extends To.WorkspaceFeature{constructor(t){super(t,Fn.WorkspaceSymbolRequest.type)}fillClientCapabilities(t){let n=(0,To.ensure)((0,To.ensure)(t,"workspace"),"symbol");n.dynamicRegistration=!0,n.symbolKind={valueSet:ga.SupportedSymbolKinds},n.tagSupport={valueSet:ga.SupportedSymbolTags},n.resolveSupport={properties:["location.range"]}}initialize(t){!t.workspaceSymbolProvider||this.register({id:id.generateUuid(),registerOptions:t.workspaceSymbolProvider===!0?{workDoneProgress:!1}:t.workspaceSymbolProvider})}registerLanguageProvider(t){const n={provideWorkspaceSymbols:(i,r)=>{const o=this._client,s=(c,d)=>o.sendRequest(Fn.WorkspaceSymbolRequest.type,{query:c},d).then(p=>d.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformations(p,d),p=>o.handleFailedRequest(Fn.WorkspaceSymbolRequest.type,d,p,null)),a=o.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(i,r,s):s(i,r)},resolveWorkspaceSymbol:t.resolveProvider===!0?(i,r)=>{const o=this._client,s=(c,d)=>o.sendRequest(Fn.WorkspaceSymbolResolveRequest.type,o.code2ProtocolConverter.asWorkspaceSymbol(c),d).then(p=>d.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformation(p),p=>o.handleFailedRequest(Fn.WorkspaceSymbolResolveRequest.type,d,p,null)),a=o.middleware;return a.resolveWorkspaceSymbol?a.resolveWorkspaceSymbol(i,r,s):s(i,r)}:void 0};return[nd.languages.registerWorkspaceSymbolProvider(n),n]}}Si.WorkspaceSymbolFeature=rd;var Ti={};Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.ReferencesFeature=void 0;const od=ie.default,Ro=oe,Po=ye,sd=pe;class ad extends Po.TextDocumentLanguageFeature{constructor(t){super(t,Ro.ReferencesRequest.type)}fillClientCapabilities(t){(0,Po.ensure)((0,Po.ensure)(t,"textDocument"),"references").dynamicRegistration=!0}initialize(t,n){const i=this.getRegistrationOptions(n,t.referencesProvider);!i||this.register({id:sd.generateUuid(),registerOptions:i})}registerLanguageProvider(t){const n=t.documentSelector,i={provideReferences:(r,o,s,a)=>{const c=this._client,d=(m,f,h,y)=>c.sendRequest(Ro.ReferencesRequest.type,c.code2ProtocolConverter.asReferenceParams(m,f,h),y).then(E=>y.isCancellationRequested?null:c.protocol2CodeConverter.asReferences(E,y),E=>c.handleFailedRequest(Ro.ReferencesRequest.type,y,E,null)),p=c.middleware;return p.provideReferences?p.provideReferences(r,o,s,a,d):d(r,o,s,a)}};return[this.registerProvider(n,i),i]}registerProvider(t,n){return od.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n)}}Ti.ReferencesFeature=ad;var Ri={};Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.CodeActionFeature=void 0;const cd=ie.default,rt=oe,ud=pe,ko=ye;class dd extends ko.TextDocumentLanguageFeature{constructor(t){super(t,rt.CodeActionRequest.type)}fillClientCapabilities(t){const n=(0,ko.ensure)((0,ko.ensure)(t,"textDocument"),"codeAction");n.dynamicRegistration=!0,n.isPreferredSupport=!0,n.disabledSupport=!0,n.dataSupport=!0,n.resolveSupport={properties:["edit"]},n.codeActionLiteralSupport={codeActionKind:{valueSet:[rt.CodeActionKind.Empty,rt.CodeActionKind.QuickFix,rt.CodeActionKind.Refactor,rt.CodeActionKind.RefactorExtract,rt.CodeActionKind.RefactorInline,rt.CodeActionKind.RefactorRewrite,rt.CodeActionKind.Source,rt.CodeActionKind.SourceOrganizeImports]}},n.honorsChangeAnnotations=!1}initialize(t,n){const i=this.getRegistrationOptions(n,t.codeActionProvider);!i||this.register({id:ud.generateUuid(),registerOptions:i})}registerLanguageProvider(t){const n=t.documentSelector,i={provideCodeActions:(r,o,s,a)=>{const c=this._client,d=async(m,f,h,y)=>{const E={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(m),range:c.code2ProtocolConverter.asRange(f),context:await c.code2ProtocolConverter.asCodeActionContext(h,y)};return c.sendRequest(rt.CodeActionRequest.type,E,y).then(I=>y.isCancellationRequested||I===null||I===void 0?null:c.protocol2CodeConverter.asCodeActionResult(I,y),I=>c.handleFailedRequest(rt.CodeActionRequest.type,y,I,null))},p=c.middleware;return p.provideCodeActions?p.provideCodeActions(r,o,s,a,d):d(r,o,s,a)},resolveCodeAction:t.resolveProvider?(r,o)=>{const s=this._client,a=this._client.middleware,c=async(d,p)=>s.sendRequest(rt.CodeActionResolveRequest.type,await s.code2ProtocolConverter.asCodeAction(d,p),p).then(m=>p.isCancellationRequested?d:s.protocol2CodeConverter.asCodeAction(m,p),m=>s.handleFailedRequest(rt.CodeActionResolveRequest.type,p,m,d));return a.resolveCodeAction?a.resolveCodeAction(r,o,c):c(r,o)}:void 0};return[cd.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),i,t.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(t.codeActionKinds)}:void 0),i]}}Ri.CodeActionFeature=dd;var Pi={};Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.CodeLensFeature=void 0;const ha=ie.default,on=oe,ld=pe,En=ye;class fd extends En.TextDocumentLanguageFeature{constructor(t){super(t,on.CodeLensRequest.type)}fillClientCapabilities(t){(0,En.ensure)((0,En.ensure)(t,"textDocument"),"codeLens").dynamicRegistration=!0,(0,En.ensure)((0,En.ensure)(t,"workspace"),"codeLens").refreshSupport=!0}initialize(t,n){this._client.onRequest(on.CodeLensRefreshRequest.type,async()=>{for(const o of this.getAllProviders())o.onDidChangeCodeLensEmitter.fire()});const r=this.getRegistrationOptions(n,t.codeLensProvider);!r||this.register({id:ld.generateUuid(),registerOptions:r})}registerLanguageProvider(t){const n=t.documentSelector,i=new ha.EventEmitter,r={onDidChangeCodeLenses:i.event,provideCodeLenses:(o,s)=>{const a=this._client,c=(p,m)=>a.sendRequest(on.CodeLensRequest.type,a.code2ProtocolConverter.asCodeLensParams(p),m).then(f=>m.isCancellationRequested?null:a.protocol2CodeConverter.asCodeLenses(f,m),f=>a.handleFailedRequest(on.CodeLensRequest.type,m,f,null)),d=a.middleware;return d.provideCodeLenses?d.provideCodeLenses(o,s,c):c(o,s)},resolveCodeLens:t.resolveProvider?(o,s)=>{const a=this._client,c=(p,m)=>a.sendRequest(on.CodeLensResolveRequest.type,a.code2ProtocolConverter.asCodeLens(p),m).then(f=>m.isCancellationRequested?p:a.protocol2CodeConverter.asCodeLens(f),f=>a.handleFailedRequest(on.CodeLensResolveRequest.type,m,f,p)),d=a.middleware;return d.resolveCodeLens?d.resolveCodeLens(o,s,c):c(o,s)}:void 0};return[ha.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),r),{provider:r,onDidChangeCodeLensEmitter:i}]}}Pi.CodeLensFeature=fd;var Pt={};Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.DocumentOnTypeFormattingFeature=Pt.DocumentRangeFormattingFeature=Pt.DocumentFormattingFeature=void 0;const ki=ie.default,Dt=oe,Fo=pe,bt=ye;var On;(function(e){function t(n){const i=ki.workspace.getConfiguration("files",n);return{trimTrailingWhitespace:i.get("trimTrailingWhitespace"),trimFinalNewlines:i.get("trimFinalNewlines"),insertFinalNewline:i.get("insertFinalNewline")}}e.fromConfiguration=t})(On||(On={}));class gd extends bt.TextDocumentLanguageFeature{constructor(t){super(t,Dt.DocumentFormattingRequest.type)}fillClientCapabilities(t){(0,bt.ensure)((0,bt.ensure)(t,"textDocument"),"formatting").dynamicRegistration=!0}initialize(t,n){const i=this.getRegistrationOptions(n,t.documentFormattingProvider);!i||this.register({id:Fo.generateUuid(),registerOptions:i})}registerLanguageProvider(t){const n=t.documentSelector,i={provideDocumentFormattingEdits:(r,o,s)=>{const a=this._client,c=(p,m,f)=>{const h={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(p),options:a.code2ProtocolConverter.asFormattingOptions(m,On.fromConfiguration(p))};return a.sendRequest(Dt.DocumentFormattingRequest.type,h,f).then(y=>f.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(y,f),y=>a.handleFailedRequest(Dt.DocumentFormattingRequest.type,f,y,null))},d=a.middleware;return d.provideDocumentFormattingEdits?d.provideDocumentFormattingEdits(r,o,s,c):c(r,o,s)}};return[ki.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),i),i]}}Pt.DocumentFormattingFeature=gd;class hd extends bt.TextDocumentLanguageFeature{constructor(t){super(t,Dt.DocumentRangeFormattingRequest.type)}fillClientCapabilities(t){(0,bt.ensure)((0,bt.ensure)(t,"textDocument"),"rangeFormatting").dynamicRegistration=!0}initialize(t,n){const i=this.getRegistrationOptions(n,t.documentRangeFormattingProvider);!i||this.register({id:Fo.generateUuid(),registerOptions:i})}registerLanguageProvider(t){const n=t.documentSelector,i={provideDocumentRangeFormattingEdits:(r,o,s,a)=>{const c=this._client,d=(m,f,h,y)=>{const E={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(m),range:c.code2ProtocolConverter.asRange(f),options:c.code2ProtocolConverter.asFormattingOptions(h,On.fromConfiguration(m))};return c.sendRequest(Dt.DocumentRangeFormattingRequest.type,E,y).then(I=>y.isCancellationRequested?null:c.protocol2CodeConverter.asTextEdits(I,y),I=>c.handleFailedRequest(Dt.DocumentRangeFormattingRequest.type,y,I,null))},p=c.middleware;return p.provideDocumentRangeFormattingEdits?p.provideDocumentRangeFormattingEdits(r,o,s,a,d):d(r,o,s,a)}};return[ki.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),i),i]}}Pt.DocumentRangeFormattingFeature=hd;class md extends bt.TextDocumentLanguageFeature{constructor(t){super(t,Dt.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(t){(0,bt.ensure)((0,bt.ensure)(t,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(t,n){const i=this.getRegistrationOptions(n,t.documentOnTypeFormattingProvider);!i||this.register({id:Fo.generateUuid(),registerOptions:i})}registerLanguageProvider(t){const n=t.documentSelector,i={provideOnTypeFormattingEdits:(o,s,a,c,d)=>{const p=this._client,m=(h,y,E,I,J)=>{let B={textDocument:p.code2ProtocolConverter.asTextDocumentIdentifier(h),position:p.code2ProtocolConverter.asPosition(y),ch:E,options:p.code2ProtocolConverter.asFormattingOptions(I,On.fromConfiguration(h))};return p.sendRequest(Dt.DocumentOnTypeFormattingRequest.type,B,J).then(w=>J.isCancellationRequested?null:p.protocol2CodeConverter.asTextEdits(w,J),w=>p.handleFailedRequest(Dt.DocumentOnTypeFormattingRequest.type,J,w,null))},f=p.middleware;return f.provideOnTypeFormattingEdits?f.provideOnTypeFormattingEdits(o,s,a,c,d,m):m(o,s,a,c,d)}},r=t.moreTriggerCharacter||[];return[ki.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),i,t.firstTriggerCharacter,...r),i]}}Pt.DocumentOnTypeFormattingFeature=md;var Fi={};Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.RenameFeature=void 0;const pd=ie.default,Lt=oe,yd=pe,ma=ve,Eo=ye;class vd extends Eo.TextDocumentLanguageFeature{constructor(t){super(t,Lt.RenameRequest.type)}fillClientCapabilities(t){let n=(0,Eo.ensure)((0,Eo.ensure)(t,"textDocument"),"rename");n.dynamicRegistration=!0,n.prepareSupport=!0,n.prepareSupportDefaultBehavior=Lt.PrepareSupportDefaultBehavior.Identifier,n.honorsChangeAnnotations=!0}initialize(t,n){const i=this.getRegistrationOptions(n,t.renameProvider);!i||(ma.boolean(t.renameProvider)&&(i.prepareProvider=!1),this.register({id:yd.generateUuid(),registerOptions:i}))}registerLanguageProvider(t){const n=t.documentSelector,i={provideRenameEdits:(r,o,s,a)=>{const c=this._client,d=(m,f,h,y)=>{let E={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(m),position:c.code2ProtocolConverter.asPosition(f),newName:h};return c.sendRequest(Lt.RenameRequest.type,E,y).then(I=>y.isCancellationRequested?null:c.protocol2CodeConverter.asWorkspaceEdit(I,y),I=>c.handleFailedRequest(Lt.RenameRequest.type,y,I,null,!1))},p=c.middleware;return p.provideRenameEdits?p.provideRenameEdits(r,o,s,a,d):d(r,o,s,a)},prepareRename:t.prepareProvider?(r,o,s)=>{const a=this._client,c=(p,m,f)=>{let h={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(p),position:a.code2ProtocolConverter.asPosition(m)};return a.sendRequest(Lt.PrepareRenameRequest.type,h,f).then(y=>f.isCancellationRequested?null:Lt.Range.is(y)?a.protocol2CodeConverter.asRange(y):this.isDefaultBehavior(y)?y.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):y&&Lt.Range.is(y.range)?{range:a.protocol2CodeConverter.asRange(y.range),placeholder:y.placeholder}:Promise.reject(new Error("The element can't be renamed.")),y=>{throw typeof y.message=="string"?new Error(y.message):new Error("The element can't be renamed.")})},d=a.middleware;return d.prepareRename?d.prepareRename(r,o,s,c):c(r,o,s)}:void 0};return[this.registerProvider(n,i),i]}registerProvider(t,n){return pd.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n)}isDefaultBehavior(t){const n=t;return n&&ma.boolean(n.defaultBehavior)}}Fi.RenameFeature=vd;var Ei={};Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.DocumentLinkFeature=void 0;const Cd=ie.default,qn=oe,Oo=ye,_d=pe;class Dd extends Oo.TextDocumentLanguageFeature{constructor(t){super(t,qn.DocumentLinkRequest.type)}fillClientCapabilities(t){const n=(0,Oo.ensure)((0,Oo.ensure)(t,"textDocument"),"documentLink");n.dynamicRegistration=!0,n.tooltipSupport=!0}initialize(t,n){const i=this.getRegistrationOptions(n,t.documentLinkProvider);!i||this.register({id:_d.generateUuid(),registerOptions:i})}registerLanguageProvider(t){const n=t.documentSelector,i={provideDocumentLinks:(r,o)=>{const s=this._client,a=(d,p)=>s.sendRequest(qn.DocumentLinkRequest.type,s.code2ProtocolConverter.asDocumentLinkParams(d),p).then(m=>p.isCancellationRequested?null:s.protocol2CodeConverter.asDocumentLinks(m,p),m=>s.handleFailedRequest(qn.DocumentLinkRequest.type,p,m,null)),c=s.middleware;return c.provideDocumentLinks?c.provideDocumentLinks(r,o,a):a(r,o)},resolveDocumentLink:t.resolveProvider?(r,o)=>{const s=this._client;let a=(d,p)=>s.sendRequest(qn.DocumentLinkResolveRequest.type,s.code2ProtocolConverter.asDocumentLink(d),p).then(m=>p.isCancellationRequested?d:s.protocol2CodeConverter.asDocumentLink(m),m=>s.handleFailedRequest(qn.DocumentLinkResolveRequest.type,p,m,d));const c=s.middleware;return c.resolveDocumentLink?c.resolveDocumentLink(r,o,a):a(r,o)}:void 0};return[Cd.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),i),i]}}Ei.DocumentLinkFeature=Dd;var Oi={};Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.ExecuteCommandFeature=void 0;const bd=ie.default,qo=oe,wd=pe,pa=ye;class Sd{constructor(t){this._client=t,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return qo.ExecuteCommandRequest.type}fillClientCapabilities(t){(0,pa.ensure)((0,pa.ensure)(t,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(t){!t.executeCommandProvider||this.register({id:wd.generateUuid(),registerOptions:Object.assign({},t.executeCommandProvider)})}register(t){const n=this._client,i=n.middleware,r=(o,s)=>{let a={command:o,arguments:s};return n.sendRequest(qo.ExecuteCommandRequest.type,a).then(void 0,c=>n.handleFailedRequest(qo.ExecuteCommandRequest.type,void 0,c,void 0))};if(t.registerOptions.commands){const o=[];for(const s of t.registerOptions.commands)o.push(bd.commands.registerCommand(s,(...a)=>i.executeCommand?i.executeCommand(s,a,r):r(s,a)));this._commands.set(t.id,o)}}unregister(t){let n=this._commands.get(t);n&&n.forEach(i=>i.dispose())}dispose(){this._commands.forEach(t=>{t.forEach(n=>n.dispose())}),this._commands.clear()}}Oi.ExecuteCommandFeature=Sd;var qi={};Object.defineProperty(qi,"__esModule",{value:!0}),qi.FileSystemWatcherFeature=void 0;const Td=ie.default,jt=oe,Mi=ye;class Rd{constructor(t,n){this._client=t,this._notifyFileEvent=n,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return jt.DidChangeWatchedFilesNotification.type}fillClientCapabilities(t){(0,Mi.ensure)((0,Mi.ensure)(t,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,Mi.ensure)((0,Mi.ensure)(t,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(t,n){}register(t){if(!Array.isArray(t.registerOptions.watchers))return;const n=[];for(const i of t.registerOptions.watchers){const r=this._client.protocol2CodeConverter.asGlobPattern(i.globPattern);if(r===void 0)continue;let o=!0,s=!0,a=!0;i.kind!==void 0&&i.kind!==null&&(o=(i.kind&jt.WatchKind.Create)!==0,s=(i.kind&jt.WatchKind.Change)!==0,a=(i.kind&jt.WatchKind.Delete)!==0);const c=Td.workspace.createFileSystemWatcher(r,!o,!s,!a);this.hookListeners(c,o,s,a,n),n.push(c)}this._watchers.set(t.id,n)}registerRaw(t,n){let i=[];for(let r of n)this.hookListeners(r,!0,!0,!0,i);this._watchers.set(t,i)}hookListeners(t,n,i,r,o){n&&t.onDidCreate(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:jt.FileChangeType.Created}),null,o),i&&t.onDidChange(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:jt.FileChangeType.Changed}),null,o),r&&t.onDidDelete(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:jt.FileChangeType.Deleted}),null,o)}unregister(t){let n=this._watchers.get(t);if(n)for(let i of n)i.dispose()}dispose(){this._watchers.forEach(t=>{for(let n of t)n.dispose()}),this._watchers.clear()}}qi.FileSystemWatcherFeature=Rd;var Ii={};Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.ColorProviderFeature=void 0;const Pd=ie.default,Mn=oe,Mo=ye;class kd extends Mo.TextDocumentLanguageFeature{constructor(t){super(t,Mn.DocumentColorRequest.type)}fillClientCapabilities(t){(0,Mo.ensure)((0,Mo.ensure)(t,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(t,n){let[i,r]=this.getRegistration(n,t.colorProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(t){const n=t.documentSelector,i={provideColorPresentations:(r,o,s)=>{const a=this._client,c=(p,m,f)=>{const h={color:p,textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(m.document),range:a.code2ProtocolConverter.asRange(m.range)};return a.sendRequest(Mn.ColorPresentationRequest.type,h,f).then(y=>f.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(y,f),y=>a.handleFailedRequest(Mn.ColorPresentationRequest.type,f,y,null))},d=a.middleware;return d.provideColorPresentations?d.provideColorPresentations(r,o,s,c):c(r,o,s)},provideDocumentColors:(r,o)=>{const s=this._client,a=(d,p)=>{const m={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(d)};return s.sendRequest(Mn.DocumentColorRequest.type,m,p).then(f=>p.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(f,p),f=>s.handleFailedRequest(Mn.DocumentColorRequest.type,p,f,null))},c=s.middleware;return c.provideDocumentColors?c.provideDocumentColors(r,o,a):a(r,o)}};return[Pd.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),i),i]}}Ii.ColorProviderFeature=kd;var Ni={};Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.ImplementationFeature=void 0;const Fd=ie.default,Io=oe,No=ye;class Ed extends No.TextDocumentLanguageFeature{constructor(t){super(t,Io.ImplementationRequest.type)}fillClientCapabilities(t){let n=(0,No.ensure)((0,No.ensure)(t,"textDocument"),"implementation");n.dynamicRegistration=!0,n.linkSupport=!0}initialize(t,n){let[i,r]=this.getRegistration(n,t.implementationProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(t){const n=t.documentSelector,i={provideImplementation:(r,o,s)=>{const a=this._client,c=(p,m,f)=>a.sendRequest(Io.ImplementationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,m),f).then(h=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(h,f),h=>a.handleFailedRequest(Io.ImplementationRequest.type,f,h,null)),d=a.middleware;return d.provideImplementation?d.provideImplementation(r,o,s,c):c(r,o,s)}};return[this.registerProvider(n,i),i]}registerProvider(t,n){return Fd.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n)}}Ni.ImplementationFeature=Ed;var Li={};Object.defineProperty(Li,"__esModule",{value:!0}),Li.TypeDefinitionFeature=void 0;const Od=ie.default,Lo=oe,In=ye;class qd extends In.TextDocumentLanguageFeature{constructor(t){super(t,Lo.TypeDefinitionRequest.type)}fillClientCapabilities(t){(0,In.ensure)((0,In.ensure)(t,"textDocument"),"typeDefinition").dynamicRegistration=!0;let n=(0,In.ensure)((0,In.ensure)(t,"textDocument"),"typeDefinition");n.dynamicRegistration=!0,n.linkSupport=!0}initialize(t,n){let[i,r]=this.getRegistration(n,t.typeDefinitionProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(t){const n=t.documentSelector,i={provideTypeDefinition:(r,o,s)=>{const a=this._client,c=(p,m,f)=>a.sendRequest(Lo.TypeDefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,m),f).then(h=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(h,f),h=>a.handleFailedRequest(Lo.TypeDefinitionRequest.type,f,h,null)),d=a.middleware;return d.provideTypeDefinition?d.provideTypeDefinition(r,o,s,c):c(r,o,s)}};return[this.registerProvider(n,i),i]}registerProvider(t,n){return Od.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n)}}Li.TypeDefinitionFeature=qd;var sn={};Object.defineProperty(sn,"__esModule",{value:!0}),sn.WorkspaceFoldersFeature=sn.arrayDiff=void 0;const Md=pe,ji=ie.default,Nn=oe;function jo(e,t){if(e!=null)return e[t]}function Ao(e,t){return e.filter(n=>t.indexOf(n)<0)}sn.arrayDiff=Ao;class Id{constructor(t){this._client=t,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return Nn.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(t){const n=ji.workspace.workspaceFolders;this.initializeWithFolders(n),n===void 0?t.workspaceFolders=null:t.workspaceFolders=n.map(i=>this.asProtocol(i))}initializeWithFolders(t){this._initialFolders=t}fillClientCapabilities(t){t.workspace=t.workspace||{},t.workspace.workspaceFolders=!0}initialize(t){const n=this._client;n.onRequest(Nn.WorkspaceFoldersRequest.type,o=>{const s=()=>{const c=ji.workspace.workspaceFolders;return c===void 0?null:c.map(p=>this.asProtocol(p))},a=n.middleware.workspace;return a&&a.workspaceFolders?a.workspaceFolders(o,s):s()});const i=jo(jo(jo(t,"workspace"),"workspaceFolders"),"changeNotifications");let r;typeof i=="string"?r=i:i===!0&&(r=Md.generateUuid()),r&&this.register({id:r,registerOptions:void 0})}sendInitialEvent(t){let n;if(this._initialFolders&&t){const i=Ao(this._initialFolders,t),r=Ao(t,this._initialFolders);(r.length>0||i.length>0)&&(n=this.doSendEvent(r,i))}else this._initialFolders?n=this.doSendEvent([],this._initialFolders):t&&(n=this.doSendEvent(t,[]));n!==void 0&&n.catch(i=>{this._client.error(`Sending notification ${Nn.DidChangeWorkspaceFoldersNotification.type.method} failed`,i)})}doSendEvent(t,n){let i={event:{added:t.map(r=>this.asProtocol(r)),removed:n.map(r=>this.asProtocol(r))}};return this._client.sendNotification(Nn.DidChangeWorkspaceFoldersNotification.type,i)}register(t){let n=t.id,i=this._client,r=ji.workspace.onDidChangeWorkspaceFolders(o=>{let s=d=>this.doSendEvent(d.added,d.removed),a=i.middleware.workspace;(a&&a.didChangeWorkspaceFolders?a.didChangeWorkspaceFolders(o,s):s(o)).catch(d=>{this._client.error(`Sending notification ${Nn.DidChangeWorkspaceFoldersNotification.type.method} failed`,d)})});this._listeners.set(n,r),this.sendInitialEvent(ji.workspace.workspaceFolders)}unregister(t){let n=this._listeners.get(t);n!==void 0&&(this._listeners.delete(t),n.dispose())}dispose(){for(let t of this._listeners.values())t.dispose();this._listeners.clear()}asProtocol(t){return t===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(t.uri),name:t.name}}}sn.WorkspaceFoldersFeature=Id;var Ai={};Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.FoldingRangeFeature=void 0;const Nd=ie.default,an=oe,Ho=ye;class Ld extends Ho.TextDocumentLanguageFeature{constructor(t){super(t,an.FoldingRangeRequest.type)}fillClientCapabilities(t){let n=(0,Ho.ensure)((0,Ho.ensure)(t,"textDocument"),"foldingRange");n.dynamicRegistration=!0,n.rangeLimit=5e3,n.lineFoldingOnly=!0,n.foldingRangeKind={valueSet:[an.FoldingRangeKind.Comment,an.FoldingRangeKind.Imports,an.FoldingRangeKind.Region]},n.foldingRange={collapsedText:!1}}initialize(t,n){let[i,r]=this.getRegistration(n,t.foldingRangeProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(t){const n=t.documentSelector,i={provideFoldingRanges:(r,o,s)=>{const a=this._client,c=(p,m,f)=>{const h={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(p)};return a.sendRequest(an.FoldingRangeRequest.type,h,f).then(y=>f.isCancellationRequested?null:a.protocol2CodeConverter.asFoldingRanges(y,f),y=>a.handleFailedRequest(an.FoldingRangeRequest.type,f,y,null))},d=a.middleware;return d.provideFoldingRanges?d.provideFoldingRanges(r,o,s,c):c(r,o,s)}};return[Nd.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),i),i]}}Ai.FoldingRangeFeature=Ld;var Hi={};Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.DeclarationFeature=void 0;const jd=ie.default,$o=oe,Wo=ye;class Ad extends Wo.TextDocumentLanguageFeature{constructor(t){super(t,$o.DeclarationRequest.type)}fillClientCapabilities(t){const n=(0,Wo.ensure)((0,Wo.ensure)(t,"textDocument"),"declaration");n.dynamicRegistration=!0,n.linkSupport=!0}initialize(t,n){const[i,r]=this.getRegistration(n,t.declarationProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(t){const n=t.documentSelector,i={provideDeclaration:(r,o,s)=>{const a=this._client,c=(p,m,f)=>a.sendRequest($o.DeclarationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,m),f).then(h=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDeclarationResult(h,f),h=>a.handleFailedRequest($o.DeclarationRequest.type,f,h,null)),d=a.middleware;return d.provideDeclaration?d.provideDeclaration(r,o,s,c):c(r,o,s)}};return[this.registerProvider(n,i),i]}registerProvider(t,n){return jd.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n)}}Hi.DeclarationFeature=Ad;var $i={};Object.defineProperty($i,"__esModule",{value:!0}),$i.SelectionRangeFeature=void 0;const Hd=ie.default,Ko=oe,Uo=ye;class $d extends Uo.TextDocumentLanguageFeature{constructor(t){super(t,Ko.SelectionRangeRequest.type)}fillClientCapabilities(t){const n=(0,Uo.ensure)((0,Uo.ensure)(t,"textDocument"),"selectionRange");n.dynamicRegistration=!0}initialize(t,n){const[i,r]=this.getRegistration(n,t.selectionRangeProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(t){const n=t.documentSelector,i={provideSelectionRanges:(r,o,s)=>{const a=this._client,c=async(p,m,f)=>{const h={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(p),positions:await a.code2ProtocolConverter.asPositions(m,f)};return a.sendRequest(Ko.SelectionRangeRequest.type,h,f).then(y=>f.isCancellationRequested?null:a.protocol2CodeConverter.asSelectionRanges(y,f),y=>a.handleFailedRequest(Ko.SelectionRangeRequest.type,f,y,null))},d=a.middleware;return d.provideSelectionRanges?d.provideSelectionRanges(r,o,s,c):c(r,o,s)}};return[this.registerProvider(n,i),i]}registerProvider(t,n){return Hd.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n)}}$i.SelectionRangeFeature=$d;var Wi={};Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.ProgressFeature=void 0;const ya=oe,Wd=Sn;function Kd(e,t){return e[t]===void 0&&(e[t]=Object.create(null)),e[t]}class Ud{constructor(t){this._client=t,this.activeParts=new Set}getState(){return{kind:"window",id:ya.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(t){Kd(t,"window").workDoneProgress=!0}initialize(){const t=this._client,n=r=>{this.activeParts.delete(r)},i=r=>{this.activeParts.add(new Wd.ProgressPart(this._client,r.token,n))};t.onRequest(ya.WorkDoneProgressCreateRequest.type,i)}dispose(){for(const t of this.activeParts)t.done();this.activeParts.clear()}}Wi.ProgressFeature=Ud;var Ki={};Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.CallHierarchyFeature=void 0;const zd=ie.default,At=oe,zo=ye;class xd{constructor(t){this.client=t,this.middleware=t.middleware}prepareCallHierarchy(t,n,i){const r=this.client,o=this.middleware,s=(a,c,d)=>{const p=r.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return r.sendRequest(At.CallHierarchyPrepareRequest.type,p,d).then(m=>d.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyItems(m,d),m=>r.handleFailedRequest(At.CallHierarchyPrepareRequest.type,d,m,null))};return o.prepareCallHierarchy?o.prepareCallHierarchy(t,n,i,s):s(t,n,i)}provideCallHierarchyIncomingCalls(t,n){const i=this.client,r=this.middleware,o=(s,a)=>{const c={item:i.code2ProtocolConverter.asCallHierarchyItem(s)};return i.sendRequest(At.CallHierarchyIncomingCallsRequest.type,c,a).then(d=>a.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyIncomingCalls(d,a),d=>i.handleFailedRequest(At.CallHierarchyIncomingCallsRequest.type,a,d,null))};return r.provideCallHierarchyIncomingCalls?r.provideCallHierarchyIncomingCalls(t,n,o):o(t,n)}provideCallHierarchyOutgoingCalls(t,n){const i=this.client,r=this.middleware,o=(s,a)=>{const c={item:i.code2ProtocolConverter.asCallHierarchyItem(s)};return i.sendRequest(At.CallHierarchyOutgoingCallsRequest.type,c,a).then(d=>a.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyOutgoingCalls(d,a),d=>i.handleFailedRequest(At.CallHierarchyOutgoingCallsRequest.type,a,d,null))};return r.provideCallHierarchyOutgoingCalls?r.provideCallHierarchyOutgoingCalls(t,n,o):o(t,n)}}class Bd extends zo.TextDocumentLanguageFeature{constructor(t){super(t,At.CallHierarchyPrepareRequest.type)}fillClientCapabilities(t){const n=t,i=(0,zo.ensure)((0,zo.ensure)(n,"textDocument"),"callHierarchy");i.dynamicRegistration=!0}initialize(t,n){const[i,r]=this.getRegistration(n,t.callHierarchyProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(t){const n=this._client,i=new xd(n);return[zd.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(t.documentSelector),i),i]}}Ki.CallHierarchyFeature=Bd;var Ui={};Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.SemanticTokensFeature=void 0;const zi=ie.default,se=oe,Ln=ye,Vd=ve;class Jd extends Ln.TextDocumentLanguageFeature{constructor(t){super(t,se.SemanticTokensRegistrationType.type)}fillClientCapabilities(t){const n=(0,Ln.ensure)((0,Ln.ensure)(t,"textDocument"),"semanticTokens");n.dynamicRegistration=!0,n.tokenTypes=[se.SemanticTokenTypes.namespace,se.SemanticTokenTypes.type,se.SemanticTokenTypes.class,se.SemanticTokenTypes.enum,se.SemanticTokenTypes.interface,se.SemanticTokenTypes.struct,se.SemanticTokenTypes.typeParameter,se.SemanticTokenTypes.parameter,se.SemanticTokenTypes.variable,se.SemanticTokenTypes.property,se.SemanticTokenTypes.enumMember,se.SemanticTokenTypes.event,se.SemanticTokenTypes.function,se.SemanticTokenTypes.method,se.SemanticTokenTypes.macro,se.SemanticTokenTypes.keyword,se.SemanticTokenTypes.modifier,se.SemanticTokenTypes.comment,se.SemanticTokenTypes.string,se.SemanticTokenTypes.number,se.SemanticTokenTypes.regexp,se.SemanticTokenTypes.operator,se.SemanticTokenTypes.decorator],n.tokenModifiers=[se.SemanticTokenModifiers.declaration,se.SemanticTokenModifiers.definition,se.SemanticTokenModifiers.readonly,se.SemanticTokenModifiers.static,se.SemanticTokenModifiers.deprecated,se.SemanticTokenModifiers.abstract,se.SemanticTokenModifiers.async,se.SemanticTokenModifiers.modification,se.SemanticTokenModifiers.documentation,se.SemanticTokenModifiers.defaultLibrary],n.formats=[se.TokenFormat.Relative],n.requests={range:!0,full:{delta:!0}},n.multilineTokenSupport=!1,n.overlappingTokenSupport=!1,n.serverCancelSupport=!0,n.augmentsSyntaxTokens=!0,(0,Ln.ensure)((0,Ln.ensure)(t,"workspace"),"semanticTokens").refreshSupport=!0}initialize(t,n){this._client.onRequest(se.SemanticTokensRefreshRequest.type,async()=>{for(const s of this.getAllProviders())s.onDidChangeSemanticTokensEmitter.fire()});const[r,o]=this.getRegistration(n,t.semanticTokensProvider);!r||!o||this.register({id:r,registerOptions:o})}registerLanguageProvider(t){const n=t.documentSelector,i=Vd.boolean(t.full)?t.full:t.full!==void 0,r=t.full!==void 0&&typeof t.full!="boolean"&&t.full.delta===!0,o=new zi.EventEmitter,s=i?{onDidChangeSemanticTokens:o.event,provideDocumentSemanticTokens:(h,y)=>{const E=this._client,I=E.middleware,J=(B,w)=>{const k={textDocument:E.code2ProtocolConverter.asTextDocumentIdentifier(B)};return E.sendRequest(se.SemanticTokensRequest.type,k,w).then(L=>w.isCancellationRequested?null:E.protocol2CodeConverter.asSemanticTokens(L,w),L=>E.handleFailedRequest(se.SemanticTokensRequest.type,w,L,null))};return I.provideDocumentSemanticTokens?I.provideDocumentSemanticTokens(h,y,J):J(h,y)},provideDocumentSemanticTokensEdits:r?(h,y,E)=>{const I=this._client,J=I.middleware,B=(w,k,L)=>{const z={textDocument:I.code2ProtocolConverter.asTextDocumentIdentifier(w),previousResultId:k};return I.sendRequest(se.SemanticTokensDeltaRequest.type,z,L).then(async A=>L.isCancellationRequested?null:se.SemanticTokens.is(A)?await I.protocol2CodeConverter.asSemanticTokens(A,L):await I.protocol2CodeConverter.asSemanticTokensEdits(A,L),A=>I.handleFailedRequest(se.SemanticTokensDeltaRequest.type,L,A,null))};return J.provideDocumentSemanticTokensEdits?J.provideDocumentSemanticTokensEdits(h,y,E,B):B(h,y,E)}:void 0}:void 0,c=t.range===!0?{provideDocumentRangeSemanticTokens:(h,y,E)=>{const I=this._client,J=I.middleware,B=(w,k,L)=>{const z={textDocument:I.code2ProtocolConverter.asTextDocumentIdentifier(w),range:I.code2ProtocolConverter.asRange(k)};return I.sendRequest(se.SemanticTokensRangeRequest.type,z,L).then(A=>L.isCancellationRequested?null:I.protocol2CodeConverter.asSemanticTokens(A,L),A=>I.handleFailedRequest(se.SemanticTokensRangeRequest.type,L,A,null))};return J.provideDocumentRangeSemanticTokens?J.provideDocumentRangeSemanticTokens(h,y,E,B):B(h,y,E)}}:void 0,d=[],p=this._client,m=p.protocol2CodeConverter.asSemanticTokensLegend(t.legend),f=p.protocol2CodeConverter.asDocumentSelector(n);return s!==void 0&&d.push(zi.languages.registerDocumentSemanticTokensProvider(f,s,m)),c!==void 0&&d.push(zi.languages.registerDocumentRangeSemanticTokensProvider(f,c,m)),[new zi.Disposable(()=>d.forEach(h=>h.dispose())),{range:c,full:s,onDidChangeSemanticTokensEmitter:o}]}}Ui.SemanticTokensFeature=Jd;var tt={};Object.defineProperty(tt,"__esModule",{value:!0}),tt.WillDeleteFilesFeature=tt.WillRenameFilesFeature=tt.WillCreateFilesFeature=tt.DidDeleteFilesFeature=tt.DidRenameFilesFeature=tt.DidCreateFilesFeature=void 0;const ct=ie.default,Qd=fi,wt=oe,Gd=pe;function va(e,t){return e[t]===void 0&&(e[t]={}),e[t]}function Xd(e,t){return e[t]}function Ca(e,t,n){e[t]=n}class Wt{constructor(t,n,i,r,o){this._client=t,this._event=n,this._registrationType=i,this._clientCapability=r,this._serverCapability=o,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(t){const n=va(va(t,"workspace"),"fileOperations");Ca(n,"dynamicRegistration",!0),Ca(n,this._clientCapability,!0)}initialize(t){const n=t.workspace?.fileOperations,i=n!==void 0?Xd(n,this._serverCapability):void 0;if(i?.filters!==void 0)try{this.register({id:Gd.generateUuid(),registerOptions:{filters:i.filters}})}catch(r){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${r}`)}}register(t){this._listener||(this._listener=this._event(this.send,this));const n=t.registerOptions.filters.map(i=>{const r=new Qd.Minimatch(i.pattern.glob,Wt.asMinimatchOptions(i.pattern.options));if(!r.makeRe())throw new Error(`Invalid pattern ${i.pattern.glob}!`);return{scheme:i.scheme,matcher:r,kind:i.pattern.matches}});this._filters.set(t.id,n)}unregister(t){this._filters.delete(t),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(t){return Wt.getFileType(t)}async filter(t,n){const i=await Promise.all(t.files.map(async o=>{const s=n(o),a=s.fsPath.replace(/\\/g,"/");for(const c of this._filters.values())for(const d of c)if(!(d.scheme!==void 0&&d.scheme!==s.scheme)){if(d.matcher.match(a)){if(d.kind===void 0)return!0;const p=await this.getFileType(s);if(p===void 0)return this._client.error(`Failed to determine file type for ${s.toString()}.`),!0;if(p===ct.FileType.File&&d.kind===wt.FileOperationPatternKind.file||p===ct.FileType.Directory&&d.kind===wt.FileOperationPatternKind.folder)return!0}else if(d.kind===wt.FileOperationPatternKind.folder&&await Wt.getFileType(s)===ct.FileType.Directory&&d.matcher.match(`${a}/`))return!0}return!1})),r=t.files.filter((o,s)=>i[s]);return{...t,files:r}}static async getFileType(t){try{return(await ct.workspace.fs.stat(t)).type}catch{return}}static asMinimatchOptions(t){if(t!==void 0&&t.ignoreCase===!0)return{nocase:!0}}}class _a extends Wt{constructor(t,n,i,r,o,s,a){super(t,n,i,r,o),this._notificationType=i,this._accessUri=s,this._createParams=a}async send(t){const n=await this.filter(t,this._accessUri);if(n.files.length){const i=async r=>this._client.sendNotification(this._notificationType,this._createParams(r));return this.doSend(n,i)}}}class Da extends _a{constructor(){super(...arguments),this._fsPathFileTypes=new Map}async getFileType(t){const n=t.fsPath;if(this._fsPathFileTypes.has(n))return this._fsPathFileTypes.get(n);const i=await Wt.getFileType(t);return i&&this._fsPathFileTypes.set(n,i),i}async cacheFileTypes(t,n){await this.filter(t,n)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(t){super.unregister(t),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}dispose(){super.dispose(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}}class Yd extends _a{constructor(t){super(t,ct.workspace.onDidCreateFiles,wt.DidCreateFilesNotification.type,"didCreate","didCreate",n=>n,t.code2ProtocolConverter.asDidCreateFilesParams)}doSend(t,n){const i=this._client.middleware.workspace;return i?.didCreateFiles?i.didCreateFiles(t,n):n(t)}}tt.DidCreateFilesFeature=Yd;class Zd extends Da{constructor(t){super(t,ct.workspace.onDidRenameFiles,wt.DidRenameFilesNotification.type,"didRename","didRename",n=>n.oldUri,t.code2ProtocolConverter.asDidRenameFilesParams)}register(t){this._willListener||(this._willListener=ct.workspace.onWillRenameFiles(this.willRename,this)),super.register(t)}willRename(t){t.waitUntil(this.cacheFileTypes(t,n=>n.oldUri))}doSend(t,n){this.clearFileTypeCache();const i=this._client.middleware.workspace;return i?.didRenameFiles?i.didRenameFiles(t,n):n(t)}}tt.DidRenameFilesFeature=Zd;class el extends Da{constructor(t){super(t,ct.workspace.onDidDeleteFiles,wt.DidDeleteFilesNotification.type,"didDelete","didDelete",n=>n,t.code2ProtocolConverter.asDidDeleteFilesParams)}register(t){this._willListener||(this._willListener=ct.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(t)}willDelete(t){t.waitUntil(this.cacheFileTypes(t,n=>n))}doSend(t,n){this.clearFileTypeCache();const i=this._client.middleware.workspace;return i?.didDeleteFiles?i.didDeleteFiles(t,n):n(t)}}tt.DidDeleteFilesFeature=el;class xo extends Wt{constructor(t,n,i,r,o,s,a){super(t,n,i,r,o),this._requestType=i,this._accessUri=s,this._createParams=a}async send(t){const n=this.waitUntil(t);t.waitUntil(n)}async waitUntil(t){const n=await this.filter(t,this._accessUri);if(n.files.length){const i=r=>this._client.sendRequest(this._requestType,this._createParams(r),r.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(n,i)}else return}}class tl extends xo{constructor(t){super(t,ct.workspace.onWillCreateFiles,wt.WillCreateFilesRequest.type,"willCreate","willCreate",n=>n,t.code2ProtocolConverter.asWillCreateFilesParams)}doSend(t,n){const i=this._client.middleware.workspace;return i?.willCreateFiles?i.willCreateFiles(t,n):n(t)}}tt.WillCreateFilesFeature=tl;class nl extends xo{constructor(t){super(t,ct.workspace.onWillRenameFiles,wt.WillRenameFilesRequest.type,"willRename","willRename",n=>n.oldUri,t.code2ProtocolConverter.asWillRenameFilesParams)}doSend(t,n){const i=this._client.middleware.workspace;return i?.willRenameFiles?i.willRenameFiles(t,n):n(t)}}tt.WillRenameFilesFeature=nl;class il extends xo{constructor(t){super(t,ct.workspace.onWillDeleteFiles,wt.WillDeleteFilesRequest.type,"willDelete","willDelete",n=>n,t.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(t,n){const i=this._client.middleware.workspace;return i?.willDeleteFiles?i.willDeleteFiles(t,n):n(t)}}tt.WillDeleteFilesFeature=il;var xi={};Object.defineProperty(xi,"__esModule",{value:!0}),xi.LinkedEditingFeature=void 0;const rl=ie.default,Bo=oe,Vo=ye;class ol extends Vo.TextDocumentLanguageFeature{constructor(t){super(t,Bo.LinkedEditingRangeRequest.type)}fillClientCapabilities(t){const n=(0,Vo.ensure)((0,Vo.ensure)(t,"textDocument"),"linkedEditingRange");n.dynamicRegistration=!0}initialize(t,n){let[i,r]=this.getRegistration(n,t.linkedEditingRangeProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(t){const n=t.documentSelector,i={provideLinkedEditingRanges:(r,o,s)=>{const a=this._client,c=(p,m,f)=>a.sendRequest(Bo.LinkedEditingRangeRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,m),f).then(h=>f.isCancellationRequested?null:a.protocol2CodeConverter.asLinkedEditingRanges(h,f),h=>a.handleFailedRequest(Bo.LinkedEditingRangeRequest.type,f,h,null)),d=a.middleware;return d.provideLinkedEditingRange?d.provideLinkedEditingRange(r,o,s,c):c(r,o,s)}};return[this.registerProvider(n,i),i]}registerProvider(t,n){return rl.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n)}}xi.LinkedEditingFeature=ol;var Bi={};Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.TypeHierarchyFeature=void 0;const sl=ie.default,Ht=oe,Jo=ye;class al{constructor(t){this.client=t,this.middleware=t.middleware}prepareTypeHierarchy(t,n,i){const r=this.client,o=this.middleware,s=(a,c,d)=>{const p=r.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return r.sendRequest(Ht.TypeHierarchyPrepareRequest.type,p,d).then(m=>d.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(m,d),m=>r.handleFailedRequest(Ht.TypeHierarchyPrepareRequest.type,d,m,null))};return o.prepareTypeHierarchy?o.prepareTypeHierarchy(t,n,i,s):s(t,n,i)}provideTypeHierarchySupertypes(t,n){const i=this.client,r=this.middleware,o=(s,a)=>{const c={item:i.code2ProtocolConverter.asTypeHierarchyItem(s)};return i.sendRequest(Ht.TypeHierarchySupertypesRequest.type,c,a).then(d=>a.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(d,a),d=>i.handleFailedRequest(Ht.TypeHierarchySupertypesRequest.type,a,d,null))};return r.provideTypeHierarchySupertypes?r.provideTypeHierarchySupertypes(t,n,o):o(t,n)}provideTypeHierarchySubtypes(t,n){const i=this.client,r=this.middleware,o=(s,a)=>{const c={item:i.code2ProtocolConverter.asTypeHierarchyItem(s)};return i.sendRequest(Ht.TypeHierarchySubtypesRequest.type,c,a).then(d=>a.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(d,a),d=>i.handleFailedRequest(Ht.TypeHierarchySubtypesRequest.type,a,d,null))};return r.provideTypeHierarchySubtypes?r.provideTypeHierarchySubtypes(t,n,o):o(t,n)}}class cl extends Jo.TextDocumentLanguageFeature{constructor(t){super(t,Ht.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(t){const n=(0,Jo.ensure)((0,Jo.ensure)(t,"textDocument"),"typeHierarchy");n.dynamicRegistration=!0}initialize(t,n){const[i,r]=this.getRegistration(n,t.typeHierarchyProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(t){const n=this._client,i=new al(n);return[sl.languages.registerTypeHierarchyProvider(n.protocol2CodeConverter.asDocumentSelector(t.documentSelector),i),i]}}Bi.TypeHierarchyFeature=cl;var Vi={};Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.InlineValueFeature=void 0;const ba=ie.default,Ji=oe,jn=ye;class ul extends jn.TextDocumentLanguageFeature{constructor(t){super(t,Ji.InlineValueRequest.type)}fillClientCapabilities(t){(0,jn.ensure)((0,jn.ensure)(t,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,jn.ensure)((0,jn.ensure)(t,"workspace"),"inlineValue").refreshSupport=!0}initialize(t,n){this._client.onRequest(Ji.InlineValueRefreshRequest.type,async()=>{for(const o of this.getAllProviders())o.onDidChangeInlineValues.fire()});const[i,r]=this.getRegistration(n,t.inlineValueProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(t){const n=t.documentSelector,i=new ba.EventEmitter,r={onDidChangeInlineValues:i.event,provideInlineValues:(o,s,a,c)=>{const d=this._client,p=(f,h,y,E)=>{const I={textDocument:d.code2ProtocolConverter.asTextDocumentIdentifier(f),range:d.code2ProtocolConverter.asRange(h),context:d.code2ProtocolConverter.asInlineValueContext(y)};return d.sendRequest(Ji.InlineValueRequest.type,I,E).then(J=>E.isCancellationRequested?null:d.protocol2CodeConverter.asInlineValues(J,E),J=>d.handleFailedRequest(Ji.InlineValueRequest.type,E,J,null))},m=d.middleware;return m.provideInlineValues?m.provideInlineValues(o,s,a,c,p):p(o,s,a,c)}};return[this.registerProvider(n,r),{provider:r,onDidChangeInlineValues:i}]}registerProvider(t,n){return ba.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n)}}Vi.InlineValueFeature=ul;var Qi={};Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.InlayHintsFeature=void 0;const wa=ie.default,cn=oe,An=ye;class dl extends An.TextDocumentLanguageFeature{constructor(t){super(t,cn.InlayHintRequest.type)}fillClientCapabilities(t){const n=(0,An.ensure)((0,An.ensure)(t,"textDocument"),"inlayHint");n.dynamicRegistration=!0,n.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,An.ensure)((0,An.ensure)(t,"workspace"),"inlayHint").refreshSupport=!0}initialize(t,n){this._client.onRequest(cn.InlayHintRefreshRequest.type,async()=>{for(const o of this.getAllProviders())o.onDidChangeInlayHints.fire()});const[i,r]=this.getRegistration(n,t.inlayHintProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(t){const n=t.documentSelector,i=new wa.EventEmitter,r={onDidChangeInlayHints:i.event,provideInlayHints:(o,s,a)=>{const c=this._client,d=async(m,f,h)=>{const y={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(m),range:c.code2ProtocolConverter.asRange(f)};try{const E=await c.sendRequest(cn.InlayHintRequest.type,y,h);return h.isCancellationRequested?null:c.protocol2CodeConverter.asInlayHints(E,h)}catch(E){return c.handleFailedRequest(cn.InlayHintRequest.type,h,E,null)}},p=c.middleware;return p.provideInlayHints?p.provideInlayHints(o,s,a,d):d(o,s,a)}};return r.resolveInlayHint=t.resolveProvider===!0?(o,s)=>{const a=this._client,c=async(p,m)=>{try{const f=await a.sendRequest(cn.InlayHintResolveRequest.type,a.code2ProtocolConverter.asInlayHint(p),m);if(m.isCancellationRequested)return null;const h=a.protocol2CodeConverter.asInlayHint(f,m);return m.isCancellationRequested?null:h}catch(f){return a.handleFailedRequest(cn.InlayHintResolveRequest.type,m,f,null)}},d=a.middleware;return d.resolveInlayHint?d.resolveInlayHint(o,s,c):c(o,s)}:void 0,[this.registerProvider(n,r),{provider:r,onDidChangeInlayHints:i}]}registerProvider(t,n){return wa.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n)}}Qi.InlayHintsFeature=dl,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProposedFeatures=e.BaseLanguageClient=e.MessageTransports=e.SuspendMode=e.State=e.CloseAction=e.ErrorAction=e.RevealOutputChannelOn=void 0;const t=ie.default,n=oe,i=ei,r=di,o=ve,s=We,a=pe,c=Sn,d=ye,p=ao,m=mi,f=Rt,h=et,y=Ci,E=_i,I=Di,J=bi,B=wi,w=So,k=Si,L=Ti,z=Ri,A=Pi,U=Pt,W=Fi,ee=Ei,R=Oi,l=qi,T=Ii,j=Ni,K=Li,H=sn,X=Ai,re=Hi,Te=$i,xe=Wi,ut=Ki,Ke=Ui,Je=tt,lt=xi,ft=Bi,Qe=Vi,Ge=Qi;var Ze;(function(Z){Z[Z.Info=1]="Info",Z[Z.Warn=2]="Warn",Z[Z.Error=3]="Error",Z[Z.Never=4]="Never"})(Ze=e.RevealOutputChannelOn||(e.RevealOutputChannelOn={}));var je;(function(Z){Z[Z.Continue=1]="Continue",Z[Z.Shutdown=2]="Shutdown"})(je=e.ErrorAction||(e.ErrorAction={}));var ue;(function(Z){Z[Z.DoNotRestart=1]="DoNotRestart",Z[Z.Restart=2]="Restart"})(ue=e.CloseAction||(e.CloseAction={}));var Be;(function(Z){Z[Z.Stopped=1]="Stopped",Z[Z.Starting=3]="Starting",Z[Z.Running=2]="Running"})(Be=e.State||(e.State={})),function(Z){Z.off="off",Z.on="on"}(e.SuspendMode||(e.SuspendMode={}));class _e{constructor(_,b){this.client=_,this.maxRestartCount=b,this.restarts=[]}error(_,b,D){return D&&D<=3?{action:je.Continue}:{action:je.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:ue.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?{action:ue.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:ue.Restart})}}var Y;(function(Z){Z.Initial="initial",Z.Starting="starting",Z.StartFailed="startFailed",Z.Running="running",Z.Stopping="stopping",Z.Stopped="stopped"})(Y||(Y={})),function(Z){function _(b){return b&&n.MessageReader.is(b.reader)&&n.MessageWriter.is(b.writer)}Z.is=_}(e.MessageTransports||(e.MessageTransports={}));class $e{constructor(_,b,D){this._traceFormat=n.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new s.Semaphore(1),this._id=_,this._name=b,D=D||{};const M={isTrusted:!1,supportHtml:!1};D.markdown!==void 0&&(M.isTrusted=D.markdown.isTrusted===!0,M.supportHtml=D.markdown.supportHtml===!0),this._clientOptions={documentSelector:D.documentSelector??[],synchronize:D.synchronize??{},diagnosticCollectionName:D.diagnosticCollectionName,outputChannelName:D.outputChannelName??this._name,revealOutputChannelOn:D.revealOutputChannelOn??Ze.Error,stdioEncoding:D.stdioEncoding??"utf8",initializationOptions:D.initializationOptions,initializationFailedHandler:D.initializationFailedHandler,progressOnInitialization:!!D.progressOnInitialization,errorHandler:D.errorHandler??this.createDefaultErrorHandler(D.connectionOptions?.maxRestartCount),middleware:D.middleware??{},uriConverters:D.uriConverters,workspaceFolder:D.workspaceFolder,connectionOptions:D.connectionOptions,markdown:M,diagnosticPullOptions:D.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:D.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=Y.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,D.outputChannel?(this._outputChannel=D.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=D.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new s.Semaphore(1),this._pendingChangeDelayer=new s.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new s.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new n.Emitter,this._stateChangeEmitter=new n.Emitter,this._trace=n.Trace.Off,this._tracer={log:(q,N)=>{o.string(q)?this.logTrace(q,N):this.logObjectTrace(q)}},this._c2p=i.createConverter(D.uriConverters?D.uriConverters.code2Protocol:void 0),this._p2c=r.createConverter(D.uriConverters?D.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=t.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(_){let b=this.getPublicState();this._state=_;let D=this.getPublicState();D!==b&&this._stateChangeEmitter.fire({oldState:b,newState:D})}getPublicState(){switch(this.$state){case Y.Starting:return Be.Starting;case Y.Running:return Be.Running;default:return Be.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(_,...b){if(this.$state===Y.StartFailed||this.$state===Y.Stopping||this.$state===Y.Stopped)return Promise.reject(new n.ResponseError(n.ErrorCodes.ConnectionInactive,"Client is not running"));const D=await this.$start();return this._didChangeTextDocumentFeature.syncKind===n.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(D),D.sendRequest(_,...b)}onRequest(_,b){const D=typeof _=="string"?_:_.method;this._requestHandlers.set(D,b);const M=this.activeConnection();let q;return M!==void 0?(this._requestDisposables.set(D,M.onRequest(_,b)),q={dispose:()=>{const N=this._requestDisposables.get(D);N!==void 0&&(N.dispose(),this._requestDisposables.delete(D))}}):(this._pendingRequestHandlers.set(D,b),q={dispose:()=>{this._pendingRequestHandlers.delete(D);const N=this._requestDisposables.get(D);N!==void 0&&(N.dispose(),this._requestDisposables.delete(D))}}),{dispose:()=>{this._requestHandlers.delete(D),q.dispose()}}}async sendNotification(_,b){if(this.$state===Y.StartFailed||this.$state===Y.Stopping||this.$state===Y.Stopped)return Promise.reject(new n.ResponseError(n.ErrorCodes.ConnectionInactive,"Client is not running"));const D=this._didChangeTextDocumentFeature.syncKind===n.TextDocumentSyncKind.Full;let M;D&&typeof _!="string"&&_.method===n.DidOpenTextDocumentNotification.method&&(M=b?.textDocument.uri,this._pendingOpenNotifications.add(M));const q=await this.$start();return D&&await this.sendPendingFullTextDocumentChanges(q),M!==void 0&&this._pendingOpenNotifications.delete(M),q.sendNotification(_,b)}onNotification(_,b){const D=typeof _=="string"?_:_.method;this._notificationHandlers.set(D,b);const M=this.activeConnection();let q;return M!==void 0?(this._notificationDisposables.set(D,M.onNotification(_,b)),q={dispose:()=>{const N=this._notificationDisposables.get(D);N!==void 0&&(N.dispose(),this._notificationDisposables.delete(D))}}):(this._pendingNotificationHandlers.set(D,b),q={dispose:()=>{this._pendingNotificationHandlers.delete(D);const N=this._notificationDisposables.get(D);N!==void 0&&(N.dispose(),this._notificationDisposables.delete(D))}}),{dispose:()=>{this._notificationHandlers.delete(D),q.dispose()}}}async sendProgress(_,b,D){if(this.$state===Y.StartFailed||this.$state===Y.Stopping||this.$state===Y.Stopped)return Promise.reject(new n.ResponseError(n.ErrorCodes.ConnectionInactive,"Client is not running"));try{return(await this.$start()).sendProgress(_,b,D)}catch(M){throw this.error(`Sending progress for token ${b} failed.`,M),M}}onProgress(_,b,D){this._progressHandlers.set(b,{type:_,handler:D});const M=this.activeConnection();let q;const N=this._clientOptions.middleware?.handleWorkDoneProgress,De=n.WorkDoneProgress.is(_)&&N!==void 0?te=>{N(b,te,()=>D(te))}:D;return M!==void 0?(this._progressDisposables.set(b,M.onProgress(_,b,De)),q={dispose:()=>{const te=this._progressDisposables.get(b);te!==void 0&&(te.dispose(),this._progressDisposables.delete(b))}}):(this._pendingProgressHandlers.set(b,{type:_,handler:D}),q={dispose:()=>{this._pendingProgressHandlers.delete(b);const te=this._progressDisposables.get(b);te!==void 0&&(te.dispose(),this._progressDisposables.delete(b))}}),{dispose:()=>{this._progressHandlers.delete(b),q.dispose()}}}createDefaultErrorHandler(_){if(_!==void 0&&_<0)throw new Error(`Invalid maxRestartCount: ${_}`);return new _e(this,_??4)}async setTrace(_){this._trace=_;const b=this.activeConnection();b!==void 0&&await b.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(_){if(_ instanceof n.ResponseError){const b=_;return`  Message: ${b.message}
  Code: ${b.code} ${b.data?`
`+b.data.toString():""}`}return _ instanceof Error?o.string(_.stack)?_.stack:_.message:o.string(_)?_:_.toString()}info(_,b,D=!0){this.outputChannel.appendLine(`[Info  - ${new Date().toLocaleTimeString()}] ${_}`),b!=null&&this.outputChannel.appendLine(this.data2String(b)),D&&this._clientOptions.revealOutputChannelOn<=Ze.Info&&this.showNotificationMessage(n.MessageType.Info,_)}warn(_,b,D=!0){this.outputChannel.appendLine(`[Warn  - ${new Date().toLocaleTimeString()}] ${_}`),b!=null&&this.outputChannel.appendLine(this.data2String(b)),D&&this._clientOptions.revealOutputChannelOn<=Ze.Warn&&this.showNotificationMessage(n.MessageType.Warning,_)}error(_,b,D=!0){this.outputChannel.appendLine(`[Error - ${new Date().toLocaleTimeString()}] ${_}`),b!=null&&this.outputChannel.appendLine(this.data2String(b)),(D==="force"||D&&this._clientOptions.revealOutputChannelOn<=Ze.Error)&&this.showNotificationMessage(n.MessageType.Error,_)}showNotificationMessage(_,b){b=b??"A request has failed. See the output for more information.",(_===n.MessageType.Error?t.window.showErrorMessage:_===n.MessageType.Warning?t.window.showWarningMessage:t.window.showInformationMessage)(b,"Go to output").then(M=>{M!==void 0&&this.outputChannel.show(!0)})}logTrace(_,b){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${_}`),b&&this.traceOutputChannel.appendLine(this.data2String(b))}logObjectTrace(_){_.isLSPMessage&&_.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),_&&this.traceOutputChannel.appendLine(`${JSON.stringify(_)}`)}needsStart(){return this.$state===Y.Initial||this.$state===Y.Stopping||this.$state===Y.Stopped}needsStop(){return this.$state===Y.Starting||this.$state===Y.Running}activeConnection(){return this.$state===Y.Running&&this._connection!==void 0?this._connection:void 0}isRunning(){return this.$state===Y.Running}async start(){if(this._disposed==="disposing"||this._disposed==="disposed")throw new Error("Client got disposed and can't be restarted.");if(this.$state===Y.Stopping)throw new Error("Client is currently stopping. Can only restart a full stopped client");if(this._onStart!==void 0)return this._onStart;const[_,b,D]=this.createOnStartPromise();this._onStart=_,this._diagnostics===void 0&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?t.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):t.languages.createDiagnosticCollection());for(const[M,q]of this._notificationHandlers)this._pendingNotificationHandlers.has(M)||this._pendingNotificationHandlers.set(M,q);for(const[M,q]of this._requestHandlers)this._pendingRequestHandlers.has(M)||this._pendingRequestHandlers.set(M,q);for(const[M,q]of this._progressHandlers)this._pendingProgressHandlers.has(M)||this._pendingProgressHandlers.set(M,q);this.$state=Y.Starting;try{const M=await this.createConnection();M.onNotification(n.LogMessageNotification.type,q=>{switch(q.type){case n.MessageType.Error:this.error(q.message,void 0,!1);break;case n.MessageType.Warning:this.warn(q.message,void 0,!1);break;case n.MessageType.Info:this.info(q.message,void 0,!1);break;default:this.outputChannel.appendLine(q.message)}}),M.onNotification(n.ShowMessageNotification.type,q=>{switch(q.type){case n.MessageType.Error:t.window.showErrorMessage(q.message);break;case n.MessageType.Warning:t.window.showWarningMessage(q.message);break;case n.MessageType.Info:t.window.showInformationMessage(q.message);break;default:t.window.showInformationMessage(q.message)}}),M.onRequest(n.ShowMessageRequest.type,q=>{let N;switch(q.type){case n.MessageType.Error:N=t.window.showErrorMessage;break;case n.MessageType.Warning:N=t.window.showWarningMessage;break;case n.MessageType.Info:N=t.window.showInformationMessage;break;default:N=t.window.showInformationMessage}let De=q.actions||[];return N(q.message,...De)}),M.onNotification(n.TelemetryEventNotification.type,q=>{this._telemetryEmitter.fire(q)}),M.onRequest(n.ShowDocumentRequest.type,async q=>{const N=async te=>{const Ae=this.protocol2CodeConverter.asUri(te.uri);try{if(te.external===!0)return{success:await t.env.openExternal(Ae)};{const He={};return te.selection!==void 0&&(He.selection=this.protocol2CodeConverter.asRange(te.selection)),te.takeFocus===void 0||te.takeFocus===!1?He.preserveFocus=!0:te.takeFocus===!0&&(He.preserveFocus=!1),await t.window.showTextDocument(Ae,He),{success:!0}}}catch{return{success:!1}}},De=this._clientOptions.middleware.window?.showDocument;return De!==void 0?De(q,N):N(q)}),M.listen(),await this.initialize(M),b()}catch(M){this.$state=Y.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,M,"force"),D(M)}return this._onStart}createOnStartPromise(){let _,b;return[new Promise((M,q)=>{_=M,b=q}),_,b]}async initialize(_){this.refreshTrace(_,!1);const b=this._clientOptions.initializationOptions,[D,M]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],q={processId:null,clientInfo:{name:t.env.appName,version:t.version},locale:this.getLocale(),rootPath:D||null,rootUri:D?this._c2p.asUri(t.Uri.file(D)):null,capabilities:this.computeClientCapabilities(),initializationOptions:o.func(b)?b():b,trace:n.Trace.toString(this._trace),workspaceFolders:M};if(this.fillInitializeParams(q),this._clientOptions.progressOnInitialization){const N=a.generateUuid(),De=new c.ProgressPart(_,N);q.workDoneToken=N;try{const te=await this.doInitialize(_,q);return De.done(),te}catch(te){throw De.cancel(),te}}else return this.doInitialize(_,q)}async doInitialize(_,b){try{const D=await _.initialize(b);if(D.capabilities.positionEncoding!==void 0&&D.capabilities.positionEncoding!==n.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${D.capabilities.positionEncoding}) received from server ${this.name}`);this._initializeResult=D,this.$state=Y.Running;let M;o.number(D.capabilities.textDocumentSync)?D.capabilities.textDocumentSync===n.TextDocumentSyncKind.None?M={openClose:!1,change:n.TextDocumentSyncKind.None,save:void 0}:M={openClose:!0,change:D.capabilities.textDocumentSync,save:{includeText:!1}}:D.capabilities.textDocumentSync!==void 0&&D.capabilities.textDocumentSync!==null&&(M=D.capabilities.textDocumentSync),this._capabilities=Object.assign({},D.capabilities,{resolvedTextDocumentSync:M}),_.onNotification(n.PublishDiagnosticsNotification.type,q=>this.handleDiagnostics(q)),_.onRequest(n.RegistrationRequest.type,q=>this.handleRegistrationRequest(q)),_.onRequest("client/registerFeature",q=>this.handleRegistrationRequest(q)),_.onRequest(n.UnregistrationRequest.type,q=>this.handleUnregistrationRequest(q)),_.onRequest("client/unregisterFeature",q=>this.handleUnregistrationRequest(q)),_.onRequest(n.ApplyWorkspaceEditRequest.type,q=>this.handleApplyWorkspaceEdit(q));for(const[q,N]of this._pendingNotificationHandlers)this._notificationDisposables.set(q,_.onNotification(q,N));this._pendingNotificationHandlers.clear();for(const[q,N]of this._pendingRequestHandlers)this._requestDisposables.set(q,_.onRequest(q,N));this._pendingRequestHandlers.clear();for(const[q,N]of this._pendingProgressHandlers)this._progressDisposables.set(q,_.onProgress(N.type,q,N.handler));return this._pendingProgressHandlers.clear(),await _.sendNotification(n.InitializedNotification.type,{}),this.hookFileEvents(_),this.hookConfigurationChanged(_),this.initializeFeatures(_),D}catch(D){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(D)?this.initialize(_):this.stop():D instanceof n.ResponseError&&D.data&&D.data.retry?t.window.showErrorMessage(D.message,{title:"Retry",id:"retry"}).then(M=>{M&&M.id==="retry"?this.initialize(_):this.stop()}):(D&&D.message&&t.window.showErrorMessage(D.message),this.error("Server initialization failed.",D),this.stop()),D}}_clientGetRootPath(){let _=t.workspace.workspaceFolders;if(!_||_.length===0)return;let b=_[0];if(b.uri.scheme==="file")return b.uri.fsPath}stop(_=2e3){return this.shutdown("stop",_)}dispose(_=2e3){try{return this._disposed="disposing",this.stop(_)}finally{this._disposed="disposed"}}async shutdown(_,b){if(this.$state===Y.Stopped||this.$state===Y.Initial)return;if(this.$state===Y.Stopping){if(this._onStop!==void 0)return this._onStop;throw new Error("Client is stopping but no stop promise available.")}const D=this.activeConnection();if(D===void 0||this.$state!==Y.Running)throw new Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=Y.Stopping,this.cleanUp(_);const M=new Promise(N=>{(0,n.RAL)().timer.setTimeout(N,b)}),q=(async N=>(await N.shutdown(),await N.exit(),N))(D);return this._onStop=Promise.race([M,q]).then(N=>{if(N!==void 0)N.end(),N.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},N=>{throw this.error("Stopping server failed",N,!1),N}).finally(()=>{this.$state=Y.Stopped,_==="stop"&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()})}cleanUp(_){this._fileEvents=[],this._fileEventDelayer.cancel();const b=this._listeners.splice(0,this._listeners.length);for(const D of b)D.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(const D of Array.from(this._features.entries()).map(M=>M[1]).reverse())D.dispose();_==="stop"&&this._diagnostics!==void 0&&(this._diagnostics.dispose(),this._diagnostics=void 0),this._idleInterval!==void 0&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){this._outputChannel!==void 0&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(_){const b=this;async function D(q){return b._fileEvents.push(q),b._fileEventDelayer.trigger(async()=>{await b.sendNotification(n.DidChangeWatchedFilesNotification.type,{changes:b._fileEvents}),b._fileEvents=[]})}const M=this.clientOptions.middleware?.workspace;(M?.didChangeWatchedFile?M.didChangeWatchedFile(_,D):D(_)).catch(q=>{b.error("Notify file events failed.",q)})}async sendPendingFullTextDocumentChanges(_){return this._pendingChangeSemaphore.lock(async()=>{try{const b=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(b.length===0)return;for(const D of b){const M=this.code2ProtocolConverter.asChangeTextDocumentParams(D);await _.sendNotification(n.DidChangeTextDocumentNotification.type,M),this._didChangeTextDocumentFeature.notificationSent(D,n.DidChangeTextDocumentNotification.type,M)}}catch(b){throw this.error("Sending pending changes failed",b,!1),b}})}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger(async()=>{const _=this.activeConnection();if(_===void 0){this.triggerPendingChangeDelivery();return}await this.sendPendingFullTextDocumentChanges(_)}).catch(_=>this.error("Delivering pending changes failed",_,!1))}handleDiagnostics(_){if(!this._diagnostics)return;const b=_.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===b&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(_.uri,_.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,n.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;const _=this._diagnosticQueue.entries().next();if(_.done===!0)return;const[b,D]=_.value;this._diagnosticQueue.delete(b);const M=new t.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:b,tokenSource:M},this._p2c.asDiagnostics(D,M.token).then(q=>{if(!M.token.isCancellationRequested){const N=this._p2c.asUri(b),De=this.clientOptions.middleware;De.handleDiagnostics?De.handleDiagnostics(N,q,(te,Ae)=>this.setDiagnostics(te,Ae)):this.setDiagnostics(N,q)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(_,b){!this._diagnostics||this._diagnostics.set(_,b)}getLocale(){return t.env.language}async $start(){if(this.$state===Y.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();const _=this.activeConnection();if(_===void 0)throw new Error("Starting server failed");return _}async createConnection(){let _=(M,q,N)=>{this.handleConnectionError(M,q,N).catch(De=>this.error("Handling connection error failed",De))},b=()=>{this.handleConnectionClosed().catch(M=>this.error("Handling connection close failed",M))};const D=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=pt(D.reader,D.writer,_,b,this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===Y.Stopped)return;try{this._connection!==void 0&&this._connection.dispose()}catch{}let _={action:ue.DoNotRestart};if(this.$state!==Y.Stopping)try{_=await this._clientOptions.errorHandler.closed()}catch{}this._connection=void 0,_.action===ue.DoNotRestart?(this.error(_.message??"Connection to server got closed. Server will not be restarted.",void 0,_.handled===!0?!1:"force"),this.cleanUp("stop"),this.$state===Y.Starting?this.$state=Y.StartFailed:this.$state=Y.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):_.action===ue.Restart&&(this.info(_.message??"Connection to server got closed. Server will restart.",!_.handled),this.cleanUp("restart"),this.$state=Y.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch(b=>this.error("Restarting server failed",b,"force")))}async handleConnectionError(_,b,D){const M=await this._clientOptions.errorHandler.error(_,b,D);M.action===je.Shutdown&&(this.error(M.message??`Client ${this._name}: connection to server is erroring. Shutting down server.`,void 0,M.handled===!0?!1:"force"),this.stop().catch(q=>{this.error("Stopping server failed",q,!1)}))}hookConfigurationChanged(_){this._listeners.push(t.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(_,!0)}))}refreshTrace(_,b=!1){const D=t.workspace.getConfiguration(this._id);let M=n.Trace.Off,q=n.TraceFormat.Text;if(D){const N=D.get("trace.server","off");typeof N=="string"?M=n.Trace.fromString(N):(M=n.Trace.fromString(D.get("trace.server.verbosity","off")),q=n.TraceFormat.fromString(D.get("trace.server.format","text")))}this._trace=M,this._traceFormat=q,_.trace(this._trace,this._tracer,{sendNotification:b,traceFormat:this._traceFormat}).catch(N=>{this.error("Updating trace failed with error",N,!1)})}hookFileEvents(_){let b=this._clientOptions.synchronize.fileEvents;if(!b)return;let D;o.array(b)?D=b:D=[b],D&&this._dynamicFeatures.get(n.DidChangeWatchedFilesNotification.type.method).registerRaw(a.generateUuid(),D)}registerFeatures(_){for(let b of _)this.registerFeature(b)}registerFeature(_){if(this._features.push(_),d.DynamicFeature.is(_)){const b=_.registrationType;this._dynamicFeatures.set(b.method,_)}}getFeature(_){return this._dynamicFeatures.get(_)}hasDedicatedTextSynchronizationFeature(_){const b=this.getFeature(n.NotebookDocumentSyncRegistrationType.method);return b===void 0||!(b instanceof m.NotebookDocumentSyncFeature)?!1:b.handles(_)}registerBuiltinFeatures(){const _=new Map;this.registerFeature(new f.ConfigurationFeature(this)),this.registerFeature(new h.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new h.DidChangeTextDocumentFeature(this,_),this._didChangeTextDocumentFeature.onPendingChangeAdded(()=>{this.triggerPendingChangeDelivery()}),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new h.WillSaveFeature(this)),this.registerFeature(new h.WillSaveWaitUntilFeature(this)),this.registerFeature(new h.DidSaveTextDocumentFeature(this)),this.registerFeature(new h.DidCloseTextDocumentFeature(this,this._syncedDocuments,_)),this.registerFeature(new l.FileSystemWatcherFeature(this,b=>this.notifyFileEvent(b))),this.registerFeature(new y.CompletionItemFeature(this)),this.registerFeature(new E.HoverFeature(this)),this.registerFeature(new J.SignatureHelpFeature(this)),this.registerFeature(new I.DefinitionFeature(this)),this.registerFeature(new L.ReferencesFeature(this)),this.registerFeature(new B.DocumentHighlightFeature(this)),this.registerFeature(new w.DocumentSymbolFeature(this)),this.registerFeature(new k.WorkspaceSymbolFeature(this)),this.registerFeature(new z.CodeActionFeature(this)),this.registerFeature(new A.CodeLensFeature(this)),this.registerFeature(new U.DocumentFormattingFeature(this)),this.registerFeature(new U.DocumentRangeFormattingFeature(this)),this.registerFeature(new U.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new W.RenameFeature(this)),this.registerFeature(new ee.DocumentLinkFeature(this)),this.registerFeature(new R.ExecuteCommandFeature(this)),this.registerFeature(new f.SyncConfigurationFeature(this)),this.registerFeature(new K.TypeDefinitionFeature(this)),this.registerFeature(new j.ImplementationFeature(this)),this.registerFeature(new T.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new H.WorkspaceFoldersFeature(this)),this.registerFeature(new X.FoldingRangeFeature(this)),this.registerFeature(new re.DeclarationFeature(this)),this.registerFeature(new Te.SelectionRangeFeature(this)),this.registerFeature(new xe.ProgressFeature(this)),this.registerFeature(new ut.CallHierarchyFeature(this)),this.registerFeature(new Ke.SemanticTokensFeature(this)),this.registerFeature(new lt.LinkedEditingFeature(this)),this.registerFeature(new Je.DidCreateFilesFeature(this)),this.registerFeature(new Je.DidRenameFilesFeature(this)),this.registerFeature(new Je.DidDeleteFilesFeature(this)),this.registerFeature(new Je.WillCreateFilesFeature(this)),this.registerFeature(new Je.WillRenameFilesFeature(this)),this.registerFeature(new Je.WillDeleteFilesFeature(this)),this.registerFeature(new ft.TypeHierarchyFeature(this)),this.registerFeature(new Qe.InlineValueFeature(this)),this.registerFeature(new Ge.InlayHintsFeature(this)),this.registerFeature(new p.DiagnosticFeature(this)),this.registerFeature(new m.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(Xe.createAll(this))}fillInitializeParams(_){for(let b of this._features)o.func(b.fillInitializeParams)&&b.fillInitializeParams(_)}computeClientCapabilities(){const _={};(0,d.ensure)(_,"workspace").applyEdit=!0;const b=(0,d.ensure)((0,d.ensure)(_,"workspace"),"workspaceEdit");b.documentChanges=!0,b.resourceOperations=[n.ResourceOperationKind.Create,n.ResourceOperationKind.Rename,n.ResourceOperationKind.Delete],b.failureHandling=n.FailureHandlingKind.TextOnlyTransactional,b.normalizesLineEndings=!0,b.changeAnnotationSupport={groupsOnLabel:!0};const D=(0,d.ensure)((0,d.ensure)(_,"textDocument"),"publishDiagnostics");D.relatedInformation=!0,D.versionSupport=!1,D.tagSupport={valueSet:[n.DiagnosticTag.Unnecessary,n.DiagnosticTag.Deprecated]},D.codeDescriptionSupport=!0,D.dataSupport=!0;const M=(0,d.ensure)(_,"window"),q=(0,d.ensure)(M,"showMessage");q.messageActionItem={additionalPropertiesSupport:!0};const N=(0,d.ensure)(M,"showDocument");N.support=!0;const De=(0,d.ensure)(_,"general");De.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from($e.RequestsToCancelOnContentModified)},De.regularExpressions={engine:"ECMAScript",version:"ES2020"},De.markdown={parser:"marked",version:"1.1.0"},De.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(De.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let te of this._features)te.fillClientCapabilities(_);return _}initializeFeatures(_){const b=this._clientOptions.documentSelector;for(const D of this._features)o.func(D.preInitialize)&&D.preInitialize(this._capabilities,b);for(const D of this._features)D.initialize(this._capabilities,b)}async handleRegistrationRequest(_){if(!this.isRunning()){for(const b of _.registrations)this._ignoredRegistrations.add(b.id);return}for(const b of _.registrations){const D=this._dynamicFeatures.get(b.method);if(D===void 0)return Promise.reject(new Error(`No feature implementation for ${b.method} found. Registration failed.`));const M=b.registerOptions??{};M.documentSelector=M.documentSelector??this._clientOptions.documentSelector;const q={id:b.id,registerOptions:M};try{D.register(q)}catch(N){return Promise.reject(N)}}}async handleUnregistrationRequest(_){for(let b of _.unregisterations){if(this._ignoredRegistrations.has(b.id))continue;const D=this._dynamicFeatures.get(b.method);if(!D)return Promise.reject(new Error(`No feature implementation for ${b.method} found. Unregistration failed.`));D.unregister(b.id)}}async handleApplyWorkspaceEdit(_){const b=_.edit,D=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(b)),M=new Map;t.workspace.textDocuments.forEach(N=>M.set(N.uri.toString(),N));let q=!1;if(b.documentChanges){for(const N of b.documentChanges)if(n.TextDocumentEdit.is(N)&&N.textDocument.version&&N.textDocument.version>=0){const De=this._p2c.asUri(N.textDocument.uri).toString(),te=M.get(De);if(te&&te.version!==N.textDocument.version){q=!0;break}}}return q?Promise.resolve({applied:!1}):o.asPromise(t.workspace.applyEdit(D).then(N=>({applied:N})))}handleFailedRequest(_,b,D,M,q=!0){if(D instanceof n.ResponseError){if(D.code===n.ErrorCodes.PendingResponseRejected||D.code===n.ErrorCodes.ConnectionInactive)return M;if(D.code===n.LSPErrorCodes.RequestCancelled||D.code===n.LSPErrorCodes.ServerCancelled){if(b!==void 0&&b.isCancellationRequested)return M;throw D.data!==void 0?new d.LSPCancellationError(D.data):new t.CancellationError}else if(D.code===n.LSPErrorCodes.ContentModified){if($e.RequestsToCancelOnContentModified.has(_.method)||$e.CancellableResolveCalls.has(_.method))throw new t.CancellationError;return M}}throw this.error(`Request ${_.method} failed.`,D,q),D}}e.BaseLanguageClient=$e,$e.RequestsToCancelOnContentModified=new Set([n.SemanticTokensRequest.method,n.SemanticTokensRangeRequest.method,n.SemanticTokensDeltaRequest.method]),$e.CancellableResolveCalls=new Set([n.CompletionResolveRequest.method,n.CodeLensResolveRequest.method,n.CodeActionResolveRequest.method,n.InlayHintResolveRequest.method,n.DocumentLinkResolveRequest.method,n.WorkspaceSymbolResolveRequest.method]);class gt{error(_){(0,n.RAL)().console.error(_)}warn(_){(0,n.RAL)().console.warn(_)}info(_){(0,n.RAL)().console.info(_)}log(_){(0,n.RAL)().console.log(_)}}function pt(Z,_,b,D,M){const q=new gt,N=(0,n.createProtocolConnection)(Z,_,q,M);return N.onError(te=>{b(te[0],te[1],te[2])}),N.onClose(D),{listen:()=>N.listen(),sendRequest:N.sendRequest,onRequest:N.onRequest,hasPendingResponse:N.hasPendingResponse,sendNotification:N.sendNotification,onNotification:N.onNotification,onProgress:N.onProgress,sendProgress:N.sendProgress,trace:(te,Ae,He)=>{const kt={sendNotification:!1,traceFormat:n.TraceFormat.Text};return He===void 0?N.trace(te,Ae,kt):(o.boolean(He),N.trace(te,Ae,He))},initialize:te=>N.sendRequest(n.InitializeRequest.type,te),shutdown:()=>N.sendRequest(n.ShutdownRequest.type,void 0),exit:()=>N.sendNotification(n.ExitNotification.type),end:()=>N.end(),dispose:()=>N.dispose()}}var Xe;(function(Z){function _(b){return[]}Z.createAll=_})(Xe=e.ProposedFeatures||(e.ProposedFeatures={}))}(os);var Qo={};(function(e){var t=Ie&&Ie.__createBinding||(Object.create?function(r,o,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(o,s);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(r,a,c)}:function(r,o,s,a){a===void 0&&(a=s),r[a]=o[s]}),n=Ie&&Ie.__exportStar||function(r,o){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&t(o,r,s)};Object.defineProperty(e,"__esModule",{value:!0}),e.DiagnosticPullMode=e.vsdiag=void 0,n(oe,e),n(ye,e);var i=ao;Object.defineProperty(e,"vsdiag",{enumerable:!0,get:function(){return i.vsdiag}}),Object.defineProperty(e,"DiagnosticPullMode",{enumerable:!0,get:function(){return i.DiagnosticPullMode}}),n(os,e)})(Qo);var Sa={exports:{}},Ta={},Go={exports:{}};(function(e){e.exports=oe})(Go),function(e){var t=Ie&&Ie.__createBinding||(Object.create?function(s,a,c,d){d===void 0&&(d=c);var p=Object.getOwnPropertyDescriptor(a,c);(!p||("get"in p?!a.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return a[c]}}),Object.defineProperty(s,d,p)}:function(s,a,c,d){d===void 0&&(d=c),s[d]=a[c]}),n=Ie&&Ie.__exportStar||function(s,a){for(var c in s)c!=="default"&&!Object.prototype.hasOwnProperty.call(a,c)&&t(a,s,c)};Object.defineProperty(e,"__esModule",{value:!0}),e.LanguageClient=void 0;const i=Qo,r=Go.exports;n(Go.exports,e),n(Qo,e);class o extends i.BaseLanguageClient{constructor(a,c,d,p){super(a,c,d),this.worker=p}createMessageTransports(a){const c=new r.BrowserMessageReader(this.worker),d=new r.BrowserMessageWriter(this.worker);return Promise.resolve({reader:c,writer:d})}}e.LanguageClient=o}(Ta),function(e){e.exports=Ta}(Sa);async function ll(e){return console.log(!0),await fl(e)}async function fl(e){const t=ge.Uri.joinPath(e.extensionUri,"dist/server-worker.js"),n=new Worker(t.toString(!0));return new Sa.exports.LanguageClient("taplo-lsp","Taplo LSP",await gl(e),n)}async function gl(e){return await ge.workspace.fs.createDirectory(e.globalStorageUri),{documentSelector:[{scheme:"file",language:"toml"},{scheme:"file",language:"cargoLock"}],initializationOptions:{configurationSection:"evenBetterToml",cachePath:e.globalStorageUri.fsPath}}}function hl(e,t){var n,i;for(const r of ge.extensions.all){const o=(i=(n=r.packageJSON)==null?void 0:n.contributes)==null?void 0:i.tomlValidation;if(Array.isArray(o))for(const s of o){if(typeof s!="object")continue;const a=s.url;if(typeof a!="string")continue;let c=s.fileMatch,d=s.regexMatch;Array.isArray(c)||(c=[c]);for(let p of c)typeof p=="string"&&(p.startsWith("/")||(p=`/${p}`),t.sendNotification("taplo/associateSchema",{schemaUri:a,priority:10,rule:{glob:`**${p}`},meta:{source:"extension",extensionId:r.id}}));Array.isArray(d)||(d=[d]);for(const p of d)typeof p=="string"&&t.sendNotification("taplo/associateSchema",{schemaUri:a,priority:10,rule:{regex:p},meta:{source:"extension",extensionId:r.id}})}}}async function ml(e){var t;const n=ge.window.createStatusBarItem(ge.StatusBarAlignment.Right,0);n.text="no schema selected",n.tooltip="TOML Schema",n.command="evenBetterToml.selectSchema";const i=await ll(e);await i.start(),((t=ge.window.activeTextEditor)==null?void 0:t.document.languageId)==="toml"&&n.show(),Ia(e,i),hl(e,i),e.subscriptions.push(gn(),n,i.onNotification("taplo/messageWithOutput",async r=>Fa(r,i)),ge.window.onDidChangeActiveTextEditor(r=>{r?.document.languageId==="toml"?n.show():n.hide()}),i.onNotification("taplo/didChangeSchemaAssociation",async r=>{var o,s,a,c;const d=(o=ge.window.activeTextEditor)==null?void 0:o.document.uri.toString();!d||r.documentUri===d&&(n.text=(c=(a=(s=r.meta)==null?void 0:s.name)!=null?a:r.schemaUri)!=null?c:"no schema selected")}))}exports.activate=ml;
